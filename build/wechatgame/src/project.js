window.__require=function e(t,i,o){function n(r,s){if(!i[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}}var h=i[r]={exports:{}};t[r][0].call(h.exports,function(e){return n(t[r][1][e]||e)},h,h.exports,e,t,i,o)}return i[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)n(o[r]);return n}({addHeartSys:[function(e,t,i){"use strict";cc._RF.push(t,"2686dyAMR5O7KsHT40LZx/w","addHeartSys"),cc.Class({extends:cc.Component,properties:{uiPrefab:cc.Prefab,ui:null,enterButtonNode:cc.Node,addNum:5},onLoad:function(){this.ui=cc.instantiate(this.uiPrefab);var e=this.ui.getChildByName("bg"),t=cc.director.getWinSizeInPixels();e.width=t.width,e.height=t.height;var i=this.ui.getChildByName("others");e.on("touchstart",this.close,this),i.getChildByName("button").on("click",this.onClickVideoButton,this),i.getChildByName("closeButton").on("click",this.close,this),null!=this.enterButtonNode&&this.enterButtonNode.on("click",this.show,this)},start:function(){},show:function(){var e=this.ui.getChildByName("others");e.getChildByName("infoLabel").getComponent(cc.Label).string="\u89c2\u770b\u89c6\u9891\u5e7f\u544a\uff0c\u7acb\u523b\u589e\u52a0\u91d1\u5e01 * "+this.addNum.toString(),e.scale=0,this.ui.active=!0,null==this.ui.parent&&this.node.addChild(this.ui),cc.tween(e).to(.3,{scale:1}).start()},close:function(){var e=this.ui.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.ui.active=!1}).start()},onClickVideoButton:function(){this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!1;var t=e("advertisMgr");t.delegate=this,t.showVideoAd()},onVideoAdEnd:function(){var t=this,i=e("dataMgr").playerData.heart+this.addNum,o={heart:i};e("dataMgr").commitPlayerDataToServer(o,function(){e("dataMgr").playerData.heart=i,t.node.getComponent("mainSceneMgr").heart=i,this.node.getComponent("notificationMgr").showNoti("\u6210\u529f\u589e\u52a0\u4f53\u529b"),t.close()})},onVideoAdNotEnd:function(){this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!0,this.node.getComponent("notificationMgr").showNoti("\u5b8c\u6574\u770b\u5b8c\u5e7f\u544a\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")},onVideoAdLoadError:function(e){this.node.getComponent("notificationMgr").showNoti("\u597d\u50cf\u51fa\u4e86\u4e00\u70b9\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u54e6"),this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{advertisMgr:"advertisMgr",dataMgr:"dataMgr"}],addPhysicalPowerSys:[function(e,t,i){"use strict";cc._RF.push(t,"0f1aaVtZzdLF65JTpKPKY/Y","addPhysicalPowerSys"),cc.Class({extends:cc.Component,properties:{uiPrefab:cc.Prefab,ui:null,enterButtonNode:cc.Node,addNum:5},onLoad:function(){this.ui=cc.instantiate(this.uiPrefab);var e=this.ui.getChildByName("bg"),t=cc.director.getWinSizeInPixels();e.width=t.width,e.height=t.height;var i=this.ui.getChildByName("others");e.on("touchstart",this.close,this),i.getChildByName("button").on("click",this.onClickVideoButton,this),i.getChildByName("closeButton").on("click",this.close,this),null!=this.enterButtonNode&&this.enterButtonNode.on("click",this.show,this)},start:function(){},show:function(){var e=this.ui.getChildByName("others");e.getChildByName("infoLabel").getComponent(cc.Label).string="\u89c2\u770b\u89c6\u9891\u5e7f\u544a\uff0c\u7acb\u523b\u589e\u52a0\u4f53\u529b * "+this.addNum.toString(),this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!0,e.scale=0,this.ui.active=!0,null==this.ui.parent&&this.node.addChild(this.ui),cc.tween(e).to(.3,{scale:1}).start()},close:function(){var e=this.ui.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.ui.active=!1}).start()},onClickVideoButton:function(){this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!1;var t=e("advertisMgr");t.delegate=this,t.showVideoAd()},onVideoAdEnd:function(){var t=this,i=e("dataMgr").playerData.physicalPower+this.addNum,o={physicalPower:i};e("dataMgr").commitPlayerDataToServer(o,function(){e("dataMgr").playerData.physicalPower=i,t.node.getComponent("mainSceneMgr").physicalPower=i,this.node.getComponent("notificationMgr").showNoti("\u6210\u529f\u589e\u52a0\u4f53\u529b"),t.close()})},onVideoAdNotEnd:function(){this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!0,this.node.getComponent("notificationMgr").showNoti("\u5b8c\u6574\u770b\u5b8c\u5e7f\u544a\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")},onVideoAdLoadError:function(e){this.node.getComponent("notificationMgr").showNoti("\u597d\u50cf\u51fa\u4e86\u4e00\u70b9\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u54e6"),this.ui.getChildByName("others").getChildByName("button").getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{advertisMgr:"advertisMgr",dataMgr:"dataMgr"}],advertisMgr:[function(e,t,i){"use strict";cc._RF.push(t,"43761UKhfZIrYYBmiJQLvXn","advertisMgr");var o=new(cc.Class({extends:cc.Component,properties:{videoAd:null,delegate:null,wechatAdId:"xxxxx"},onVideoAdEnd:function(){null!=this.delegate&&"function"==typeof this.delegate.onVideoAdEnd&&this.delegate.onVideoAdEnd()},onVideoAdNotEnd:function(){null!=this.delegate&&"function"==typeof this.delegate.onVideoAdNotEnd&&this.delegate.onVideoAdNotEnd()},onVideoAdLoadError:function(e){console.log("\u62c9\u53d6\u5e7f\u544a\u5931\u8d25"),null!=this.delegate&&"function"==typeof this.delegate.onVideoAdLoadError&&this.delegate.onVideoAdLoadError(e)},onVideoAdShowError:function(e){null!=this.delegate&&"function"==typeof this.delegate.onVideoAdShowError&&this.delegate.onVideoAdShowError(e)},initAds:function(){if(null==this.videoAd&&cc.sys.platform==cc.sys.WECHAT_GAME){var e=this;this.videoAd=wx.createRewardedVideoAd({adUnitId:this.wechatAdId}),this.videoAd.onLoad(function(){console.log("\u62c9\u53d6\u5e7f\u544a\u6210\u529f")}),this.videoAd.onError(function(t){e.onVideoAdLoadError(t)}),this.videoAd.onClose(function(t){t&&t.isEnded?e.onVideoAdEnd():e.onVideoAdNotEnd()})}},showVideoAd:function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var e=this;this.videoAd.load().then(function(){e.videoAd.show()}).catch(function(t){e.onVideoAdShowError(t)})}}}));t.exports=o,cc._RF.pop()},{}],bulletMgr:[function(e,t,i){"use strict";cc._RF.push(t,"2e7ebmG0o9A+INmyGAQ4snA","bulletMgr"),cc.Class({extends:cc.Component,properties:{bulletType:1,status:0,disFromBorder:5,moveSpeed:500,movingDirection:null,targetPosition:null,movingTime:.3,vx:null,vy:null,levelMgr:null,helper:null,_rayTestLength:3e3,pathWaysNode:cc.Node,pathWaysHeight:10,sliderFrame:cc.SpriteFrame,faltalTorence:.01},onLoad:function(){this.levelMgr=cc.find("Canvas").getComponent("levelMgr");var t=e("helper");this.helper=new t},start:function(){2==this.bulletType&&(this.node.getComponent(cc.Sprite).spriteFrame=this.sliderFrame)},move:function(e){},checkWhetherCanMove:function(e){},update:function(e){this.moveUpdate(e)},moveUpdate:function(e){if(1==this.status){var t=this.node.x+this.vx*e,i=this.node.y+this.vy*e;if(cc.v2(t-this.node.x,i-this.node.y).mag()>=cc.v2(this.targetPosition.x-this.node.x,this.targetPosition.y-this.node.y).mag())return t=this.targetPosition.x,i=this.targetPosition.y,this.node.x=t,this.node.y=i,void(this.status=0);this.node.x=t,this.node.y=i}},getNearestWallInfo:function(e){if(1==this.bulletType){var t=null,i=this.levelMgr.walls,o=this.helper.getDisToSelfBorder(this.node,e);for(var n in i){var a=i[n],r=this.helper.getLinesOfOneNode(a);for(var s in r){var c=r[s];if(0!=(f=this.helper.isOneNodeWillCollidWithOneLineInDirection(this.node,c,e))){var l=this.disFromBorder+o;if(null==t||f<t.dis+l){var h=this.helper.getSuitablePoint(cc.v2(this.node.x,this.node.y),f,l,e);t={dis:cc.v2(h.x-this.node.x,h.y-this.node.y).mag(),suitablePosition:h}}}}}return t}if(2==this.bulletType){if(null==this.pathWaysNode||0==this.pathWaysNode.children.length)return{dis:0,suitablePosition:this.node.position};var u=null;for(var n in this.pathWaysNode.children){var d=this.pathWaysNode.children[n];0!=this.helper.isTwoNodeCross(this.node,d)&&(null!=u&&1!=this._isPathNodeMoveDirection(d,e)||(u=d))}if(0==this._isPathNodeMoveDirection(u,e))return{dis:0,suitablePosition:this.node.position};var g=this.helper.makeRay(this.node.position,3e3,e),y=null,p=this.helper.getLinesOfOneNode(u);for(var s in p){var f;c=p[s];"false"!=(f=this.helper.rayTest(g,c)).toString()&&(null==y||f>y)&&(y=f)}return null==y&&(y=5),{suitablePosition:h=this.helper.getSuitablePoint(this.node.position,y,0,e),dis:f=cc.v2(h.x-this.node.x,h.y-this.node.y).mag()}}},getMaxDisFromPathNode:function(e,t){var i=this.helper.makeRay(this.node.position,3e3,t),o=this.helper.makeRay(this.node.position,3e3,cc.v2(-t.x,-t.y)),n=this.helper.getLinesOfOneNode(e),a=this,r=function(e){var t=null;for(var i in n){var o=n[i],r=a.helper.rayTest(e,o);if(0!=r)return r}return null==t&&(t=5),t},s=r(i),c=r(o);return s>=c?s:c},isPathNodeMoveDirection:function(e,t){var i=this.getMaxDisFromPathNode(e,t),o=t.rotate(Math.PI/2);return i>this.getMaxDisFromPathNode(e,o)},_isPathNodeMoveDirection:function(e,t){t.normalizeSelf();var i=-e.angle*Math.PI/180,o=cc.v2(1,0).rotate(i);return 1==t.fuzzyEquals(o,.001)||1==t.fuzzyEquals(cc.v2(-o.x,-o.y),.001)}}),cc._RF.pop()},{helper:"helper"}],dataMgr:[function(e,t,i){"use strict";cc._RF.push(t,"10be6vQoxhE9rkbWiJhY2u/","dataMgr");var o=new(cc.Class({extends:cc.Component,properties:{playerData:{get:function(){return this._playerData},set:function(e){this._playerData=e,this.refreshTimer=this.playerData.refreshDelta,this.schedule(this.update,1),this.onPlayerDataUpdated(),null!=this.delegate&&this.delegate.onPlayerDataUpdated()}},refreshTimer:{get:function(){return this._refreshTimer},set:function(e){this._refreshTimer=e,e<=0&&(this.playerData.physicalPower=this.playerData.maxPhysicalPower,this.playerData.heart=this.playerData.maxHeart,null!=this.delegate&&this.delegate.onRefresh())}},delegate:null},update:function(){this.refreshTimer>0&&(this.refreshTimer-=1)},updatePlayerDataFromServer:function(t){var i=e("networkMgr"),o=i.makeMessageObj("dataModule","queryMessageType");o.message.playerId=t;var n=this;o.successCallBack=function(e){var t=e.responseText;"success"==(t=JSON.parse(t)).type&&(n.playerData=t.playerData)},i.sendMessageByMsgObj(o)},onPlayerDataUpdated:function(){cc.log("now player data is "+JSON.stringify(this.playerData))},commitPlayerDataToServer:function(t,i){var o=e("networkMgr"),n=o.makeMessageObj("dataModule","commitMessageTyp");if(n.message.playerId=this.playerData.id,null!=n.message.playerId){n.message.commitBody=t;var a=this;n.successCallBack=function(e){var t=e.responseText;if("commitSuccess"==(t=JSON.parse(t)).type){var o=t.refreshDelta;a.refreshTimer<=0&&(a.refreshTimer=o),i()}},o.sendMessageByMsgObj(n)}else cc.log("no player data")}}));t.exports=o,cc._RF.pop()},{networkMgr:"networkMgr"}],ensureSystemNodeMgr:[function(e,t,i){"use strict";cc._RF.push(t,"96611KWWBZMSI+yqEf4pl0U","ensureSystemNodeMgr"),cc.Class({extends:cc.Component,properties:{desText:{get:function(){return null==this._desText&&(this.desText="default value"),this._desText},set:function(e){this._desText=e,this.node.getChildByName("others").getChildByName("desLabel").getComponent(cc.Label).string=e}},onEnsureButtonClick:null,onCancleButtonClick:null,canClose:{get:function(){return this._canClose},set:function(e){this._canClose=e,this.node.getChildByName("others").getChildByName("closeButton").active=e}},cancelButtonText:{get:function(){return this._cancelButtonText},set:function(e){this._cancelButtonText=e,this.node.getChildByName("others").getChildByName("cancelButton").getChildByName("textLabel").getComponent(cc.Label).string=e}},ensureButtonText:{get:function(){return this._ensureButtonText},set:function(e){this._ensureButtonText=e,this.node.getChildByName("others").getChildByName("ensureButton").getChildByName("textLabel").getComponent(cc.Label).string=e}},ensureButtonWillAutoCloseUi:!0,cancelButtonWillAutoCloseUi:!0,isExsistCancelButton:{get:function(){return null==this._isExsistCancelButton&&(this._isExsistCancelButton=!0),this._isExsistCancelButton},set:function(e){this._isExsistCancelButton=e,0==e&&(this.node.getChildByName("others").getChildByName("cancelButton").active=!1,this.node.getChildByName("others").getChildByName("ensureButton").x=0)}}},onLoad:function(){var e=this.node.getChildByName("bg");e.on("touchstart",function(){},this);var t=cc.director.getWinSize();e.width=t.width,e.height=t.height;var i=this.node.getChildByName("others");i.getChildByName("closeButton").on("click",this.close,this),i.getChildByName("ensureButton").on("click",this.onEnsure,this),i.getChildByName("cancelButton").on("click",this.onCancel,this)},start:function(){},onEnsure:function(){1==this.ensureButtonWillAutoCloseUi&&this.close(),null!=this.onEnsureButtonClick&&this.onEnsureButtonClick()},onCancel:function(){1==this.cancelButtonWillAutoCloseUi&&this.close(),null!=this.onCancleButtonClick&&this.onCancleButtonClick()},close:function(){var e=this.node.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.node.destroy()}).start()},show:function(e){var t=this.node.getChildByName("others");t.scale=0,e.addChild(this.node),cc.tween(t).to(.3,{scale:1}).start()}}),cc._RF.pop()},{}],ensureSystem:[function(e,t,i){"use strict";cc._RF.push(t,"2cfa2q87j1AbaAokGOxDLrP","ensureSystem"),cc.Class({extends:cc.Component,properties:{uiPrefab:cc.Prefab},onLoad:function(){},start:function(){},create:function(){return cc.instantiate(this.uiPrefab)}}),cc._RF.pop()},{}],gameMgr:[function(e,t,i){"use strict";cc._RF.push(t,"e39aagc7ClLc6v5TtMdVlRB","gameMgr");var o=new(cc.Class({extends:cc.Component,properties:{},start:function(){},enterLevelScene:function(e){var t=e;switch(t.toString().length){case 1:t="00"+t.toString();break;case 2:t="0"+t.toString()}var i="level"+t,o=this;cc.director.preloadScene(i,null,function(t,n){n.scene.getChildByName("Canvas").getComponent("levelMgr").level=e,o.animatedToScene(i)})},animatedToScene:function(e){var t=cc.director.getScene();cc.tween(t.children[0]).to(.5,{opacity:0}).delay(1).call(function(){cc.director.preloadScene(e,null,function(t,i){var o=i.scene;o.children[0].opacity=0,cc.director.loadScene(e,function(){cc.tween(o.children[0]).to(.5,{opacity:255}).start()})})}).start()}}));t.exports=o,cc._RF.pop()},{}],gestureMgr:[function(e,t,i){"use strict";cc._RF.push(t,"b7b72lA9PpIAbkf8XjoS5lH","gestureMgr"),cc.Class({extends:cc.Component,properties:{isDragEnable:!0,isZoomEnable:!0,zoomSpeed:.00333,maxZoomRatio:1.2,minZoomRatio:.3,dragSpeed:1,camaraNode:cc.Node,minBoundX:-960,maxBoundX:960,minBoundY:-640,maxBoundY:640,touches:{default:[],visible:!1}},onLoad:function(){this.node.on("touchstart",function(e){this.onTouchStart(e)},this),this.node.on("touchmove",function(e){this.onTouchMove(e)},this),this.node.on("touchend",function(e){this.onTouchEnd(e)},this),this.node.on("touchcancel",function(e){this.onTouchCancel(e)},this)},onTouchStart:function(e){var t=e;this.touches.push(t)},onTouchMove:function(e){if(1==this.isDragEnable&&1==this.touches.length){var t=e.getDelta(),i=-1*t.x,o=-1*t.y;i*=this.dragSpeed,o*=this.dragSpeed;var n=this.camaraNode.getComponent(cc.Camera),a=cc.find("Canvas"),r=this.camaraNode.x+i,s=this.camaraNode.y+o,c=r+a.width/2*(1/n.zoomRatio),l=r-a.width/2*(1/n.zoomRatio),h=s+a.height/2*(1/n.zoomRatio),u=s-a.height/2*(1/n.zoomRatio);c<=this.maxBoundX&&l>=this.minBoundX&&(this.camaraNode.x=r),h<=this.maxBoundY&&u>=this.minBoundY&&(this.camaraNode.y=s)}if(1==this.isZoomEnable&&2==this.touches.length){var d=this.touches[0],g=this.touches[1],y=d.getLocation(),p=g.getLocation(),f=this.distanceOfTwoVector(y,p),v=d.getPreviousLocation(),m=g.getPreviousLocation(),C=f-this.distanceOfTwoVector(v,m),x=(n=this.camaraNode.getComponent(cc.Camera)).zoomRatio+this.zoomRatio*C;x>=minZoomRatio&&x<=maxZoomRatio&&(n.zoomRatio=x)}},onTouchEnd:function(e){this.deleteTouchEventFromTouchesArry(e)},onTouchCancel:function(e){this.deleteTouchEventFromTouchesArry(e)},deleteTouchEventFromTouchesArry:function(e){var t=null;for(var i in this.touches){if(this.touches[i].getID()==e.getID()){t=i;break}}null!=t&&this.touches.splice(i,1)},distanceOfTwoVector:function(e,t){var i=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return i=Math.sqrt(i)}}),cc._RF.pop()},{}],gloableConfig:[function(e,t,i){"use strict";cc._RF.push(t,"94d39yYUJRKLIlaG9r7L5ON","gloableConfig");var o=new(cc.Class({properties:{basicIp:"192.168.0.101",basicPort:8888,netWorkMessageConfigs:{get:function(){return{loginModule:{suffix:"login",loginMessageType:{code:"asfdsfds",codeType:3}},dataModule:{suffix:"data",queryMessageType:{playerId:100000001,requestType:"query"},commitMessageTyp:{playerId:100000001,requestType:"commit",commitBody:{}}}}}}}}));t.exports=o,cc._RF.pop()},{}],helper:[function(e,t,i){"use strict";cc._RF.push(t,"fee26lOQ3NFBb7FR2MoK8sC","helper");var o=cc.Class({properties:{},segmentsIntr:function(e,t,i,o){var n=(t.y-e.y)*(o.x-i.x)-(e.x-t.x)*(i.y-o.y);if(0==n)return!1;var a=((t.x-e.x)*(o.x-i.x)*(i.y-e.y)+(t.y-e.y)*(o.x-i.x)*e.x-(o.y-i.y)*(t.x-e.x)*i.x)/n,r=-((t.y-e.y)*(o.y-i.y)*(i.x-e.x)+(t.x-e.x)*(o.y-i.y)*e.y-(o.x-i.x)*(t.y-e.y)*i.y)/n;return this.similarMinus(a,e.x)*this.similarMinus(a,t.x)<=0&&this.similarMinus(r,e.y)*this.similarMinus(r,t.y)<=0&&this.similarMinus(a,i.x)*this.similarMinus(a,o.x)<=0&&this.similarMinus(r,i.y)*this.similarMinus(r,o.y)<=0&&{x:a,y:r}},rotateSegment:function(e,t,i,o){return{p1:this.rotateOnePoint(e,i,o),p2:this.rotateOnePoint(t,i,o)}},rotateOnePoint:function(e,t,i){var o=i*Math.PI/180,n=cc.v2(e.x-t.x,e.y-t.y).rotate(o);return cc.v2(n.x+t.x,n.y+t.y)},rayTest:function(e,t){var i=this.segmentsIntr(e.p1,e.p2,t.p1,t.p2);return 0!=i&&cc.v2(i.x-e.p1.x,i.y-e.p1.y).mag()},getSuitablePoint:function(e,t,i,o){if(i>=t)return e;o.normalizeSelf();var n=t*o.x,a=t*o.y,r=(t-i)/t,s=e.x+r*n,c=e.y+r*a;return cc.v2(s,c)},makeRay:function(e,t,i){var o={p1:e,p2:null};1!=i.mag()&&i.normalizeSelf();var n=i.x*t,a=i.y*t,r=e.x+n,s=e.y+a;return o.p2=cc.v2(r,s),o},getLinesOfOneNode:function(e){var t=e.height/2,i=cc.v2(e.x-e.width/2,e.y-t),o=cc.v2(e.x+e.width/2,e.y-t),n=cc.v2(i.x,i.y+e.height),a=cc.v2(o.x,o.y+e.height),r=cc.v2(e.x-e.width/2,e.y+e.height/2),s=cc.v2(r.x,r.y-e.height),c=cc.v2(e.x+e.width/2,e.y+e.height/2),l=cc.v2(c.x,c.y-e.height),h={p1:i,p2:o},u={p1:n,p2:a},d={p1:r,p2:s},g={p1:c,p2:l};null!=e.angle&&void 0!=e.angle&&(h=this.rotateSegment(i,o,cc.v2(e.x,e.y),-e.angle),u=this.rotateSegment(n,a,cc.v2(e.x,e.y),-e.angle),d=this.rotateSegment(r,s,cc.v2(e.x,e.y),-e.angle),g=this.rotateSegment(c,l,cc.v2(e.x,e.y),-e.angle));var y={lowerLine:h,upperLine:u,leftLine:d,rightLine:g};return null!=h&&null!=u&&null!=d&&null!=g||cc.error("NOT INVALID LINES"),y},isTwoNodeCross:function(e,t){var i=this.getInfoOfOneNode(e),o=this.getInfoOfOneNode(t);return!(i.minY>o.maxY||o.minY>i.maxY||i.minX>o.maxX||o.minX>i.maxX)},getInfoOfOneNode:function(e){var t=cc.v2(e.x-e.width/2,e.y+e.height/2),i=cc.v2(e.x+e.width/2,t.y),o=cc.v2(t.x,e.y-e.height/2),n=cc.v2(i.x,o.y);null!=e.angle&&void 0!=e.angle&&(t=this.rotateOnePoint(t,cc.v2(e.x,e.y),-e.angle),i=this.rotateOnePoint(i,cc.v2(e.x,e.y),-e.angle),o=this.rotateOnePoint(o,cc.v2(e.x,e.y),-e.angle),n=this.rotateOnePoint(n,cc.v2(e.x,e.y),-e.angle));var a=t.x,r=n.x,s=o.y,c=i.y,l=[t,o,i,n];for(var h in l){var u=l[h];a>u.x&&(a=u.x),r<u.x&&(r=u.x),s>u.y&&(s=u.y),c<u.y&&(c=u.y)}return{minX:a,minY:s,maxX:r,maxY:c}},getDisToSelfBorder:function(e,t){var i=this.makeRay(cc.v2(e.x,e.y),1e3,t),o=this.getLinesOfOneNode(e);for(var n in o){var a=o[n],r=this.rayTest(i,a);if(0!=r)return r}},getPointsOfOneNode:function(e){var t=cc.v2(e.x-e.width/2,e.y+e.height/2),i=cc.v2(e.x+e.width/2,t.y),o=cc.v2(t.x,e.y-e.height/2),n=cc.v2(i.x,o.y);return null!=e.angle&&void 0!=e.angle&&(t=this.rotateOnePoint(t,cc.v2(e.x,e.y),-e.angle),i=this.rotateOnePoint(i,cc.v2(e.x,e.y),-e.angle),o=this.rotateOnePoint(o,cc.v2(e.x,e.y),-e.angle),n=this.rotateOnePoint(n,cc.v2(e.x,e.y),-e.angle)),{leftUpPoint:t,leftDownPoint:o,rightUpPoint:i,rightDownPoint:n}},isOneNodeWillCollidWithOneLineInDirection:function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e3,n=this.getPointsOfOneNode(e),a=[];for(var r in n){var s=n[r],c=this.makeRay(s,o,i);a.push(c)}var l=null,h=null,u=null,d=null;for(var g in a){var y=a[g],p=y.p1.x,f=y.p2.x;p>y.p2.x&&(p=y.p2.x,f=y.p1.x);var v=y.p1.y,m=y.p2.y;v>y.p2.y&&(v=y.p2.y,m=y.p1.y),null==l?(l=p,u=f):(l>p&&(l=p),u<f&&(u=f)),null==h?(h=v,d=m):(h>v&&(h=v),d<m&&(d=m))}var C=t.p1.x,x=t.p2.x,w=t.p1.y,N=t.p2.y;if(C>t.p2.x&&(C=t.p2.x,x=t.p1.x),w>t.p2.y&&(w=t.p2.y,N=t.p1.y),h>=N||d<=w||l>=x||u<=C)return!1;var M=cc.v2(t.p2.x-t.p1.x,t.p2.y-t.p1.y);M.normalizeSelf();var P=this.makeRay(t.p2,3e3,M).p2,B={p1:this.makeRay(t.p1,3e3,cc.v2(-M.x,-M.y)).p2,p2:P},S=this.makeRay(cc.v2(e.x,e.y),3e3,i),b=this.rayTest(S,B);return 0!=b&&b},isTwoPositionSimilarEqual:function(e,t){var i=t.x-e.x,o=t.y-e.y;return!(-.01>i||.01<i)&&!(-.01>o||.01<o)},isTwoValueSimilarEqual:function(e,t){var i=t-e;return!(-.01>i||.01<i)},similarMinus:function(e,t){var i=e-t;return-.001<i&&i<.001&&(i=0),i}});t.exports=o,cc._RF.pop()},{}],levelAreaNodeMgr:[function(e,t,i){"use strict";cc._RF.push(t,"29e5a6+oelFOZV+81SUQg4A","levelAreaNodeMgr"),cc.Class({extends:cc.Component,properties:{delegate:null,level:null},onLoad:function(){this.node.on("touchstart",this.onTouchStart,this)},start:function(){},onTouchStart:function(e){this.delegate.selectedLevel!=this.level&&0!=this.delegate.checkLevelStatus(this.level)&&(this.delegate.selectedLevel=this.level)}}),cc._RF.pop()},{}],levelConfig:[function(e,t,i){"use strict";cc._RF.push(t,"cb3edynoalP+oqr1exCykM8","levelConfig");t.exports={1:{physicalPowerCost:2,heartForRetryCost:2},2:{physicalPowerCost:3,heartForRetryCost:2},3:{physicalPowerCost:3,heartForRetryCost:2},4:{physicalPowerCost:3,heartForRetryCost:2},5:{physicalPowerCost:3,heartForRetryCost:2},6:{physicalPowerCost:3,heartForRetryCost:2},7:{physicalPowerCost:3,heartForRetryCost:2},8:{physicalPowerCost:3,heartForRetryCost:2},9:{physicalPowerCost:3,heartForRetryCost:2},10:{physicalPowerCost:3,heartForRetryCost:2},11:{physicalPowerCost:3,heartForRetryCost:2},12:{physicalPowerCost:3,heartForRetryCost:2},13:{physicalPowerCost:3,heartForRetryCost:2},14:{physicalPowerCost:3,heartForRetryCost:2},15:{physicalPowerCost:3,heartForRetryCost:2},16:{physicalPowerCost:3,heartForRetryCost:2},17:{physicalPowerCost:3,heartForRetryCost:2},18:{physicalPowerCost:3,heartForRetryCost:2},19:{physicalPowerCost:3,heartForRetryCost:2},20:{physicalPowerCost:3,heartForRetryCost:2},21:{physicalPowerCost:3,heartForRetryCost:2},22:{physicalPowerCost:3,heartForRetryCost:2}},cc._RF.pop()},{}],levelMgr:[function(e,t,i){"use strict";cc._RF.push(t,"e7e748p6atLdo2Z1e9yNR+E","levelMgr"),cc.Class({extends:cc.Component,properties:{bullets:[],minDis:50,maxOffsetDegree:45,directionTryto:null,flag:!1,helper:null,walls:[],targetsNum:{get:function(){return this._targetsNum},set:function(e){this._targetsNum=e,0==e&&this.onSuccess()}},linePrefab:cc.Prefab,bulletPrefab:cc.Prefab,playerData:null,retryButton:cc.Node,heartForRetryCost:{get:function(){return this._heartForRetryCostwe},set:function(e){this._heartForRetryCostwe=e,this.retryButton.getChildByName("heartCostLabel").getComponent(cc.Label).string=e.toString()}},heart:{get:function(){return this._heart},set:function(e){if(this._heart=e,cc.find("Canvas/uiNode/heartLabel").getComponent(cc.Label).string=e.toString()+" / "+this.maxHeart.toString(),e<this.heartForRetryCost)this.retryButton.getComponent(cc.Button).interactable=!1;else{if(0==this.isMoved)return;this.retryButton.getComponent(cc.Button).interactable=!0}}},maxHeart:{get:function(){return this._maxHeart},set:function(e){this._maxHeart=e}},isMoved:{get:function(){return null==this._isMoved&&(this._isMoved=!1),this._isMoved},set:function(e){this._isMoved=e,1==e&&this.heartForRetryCost<=this.heart&&(this.retryButton.getComponent(cc.Button).interactable=!0)}},level:null},onLoad:function(){var t=e("helper");this.helper=new t},start:function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchmove",this.onTouchMove,this),this.node.on("touchend",this.onTouchEnd,this);var t=cc.find("Canvas/bullets");this.bullets=t.children,this.playerData=e("dataMgr").playerData,this.maxHeart=this.playerData.maxHeart,this.level==this.playerData.currentLevel?this.heartForRetryCost=e("levelConfig")[this.playerData.currentLevel.toString()].heartForRetryCost:this.heartForRetryCost=0,this.heart=this.playerData.heart,e("networkMgr").delegate=this,e("dataMgr").delegate=this;var i=cc.find("Canvas/walls");this.walls=i.children,this.targetsNum=cc.find("Canvas/targets").children.length;var o=cc.find("Canvas/fillNodes").getComponent(cc.Graphics),n=null,a=cc.find("Canvas/fillNodes").children;if(0!=a.length){for(var r in a){var s=a[r];null==n&&(o.moveTo(s.x,s.y),n=s),o.lineTo(s.x,s.y)}o.close(),o.stroke(),o.fill()}},onTouchStart:function(e){this.directionTryto=null,this.flag=!0},onTouchMove:function(e){if(0!=this.flag){var t=e.getStartLocation(),i=cc.v2(e.getLocationX()-t.x,e.getLocationY()-t.y);if(!(i.mag()<this.minDis)){var o=this.getPossiableDirection(i);-1!=o?(null==this.directionTryto&&(this.directionTryto=o),this.flag=!1,this.moveBullets(this.directionTryto)):this.flag=!1}}},onTouchEnd:function(e){},onDestroy:function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchmove",this.onTouchMove,this),this.node.off("touchend",this.onTouchEnd,this)},getPossiableDirection:function(e){return 1==this.isPossiableWithGivenDirection(e,cc.v2(1,0))?cc.v2(1,0):1==this.isPossiableWithGivenDirection(e,cc.v2(0,-1))?cc.v2(0,-1):1==this.isPossiableWithGivenDirection(e,cc.v2(-1,0))?cc.v2(-1,0):1==this.isPossiableWithGivenDirection(e,cc.v2(0,1))?cc.v2(0,1):-1},isPossiableWithGivenDirection:function(e,t){var i=e.signAngle(t)/Math.PI*180;return Math.abs(i)<=this.maxOffsetDegree},moveBullets:function(e){for(var t in this.bullets)if(0!=this.bullets[t].getComponent("bulletMgr").status)return;var i=[];for(var t in this.bullets){var o=this.bullets[t],n=(c=o.getComponent("bulletMgr")).getNearestWallInfo(e),a={x:n.suitablePosition.x,y:n.suitablePosition.y,width:o.width,height:o.height,dis:n.dis,originNode:o};i.push(a)}for(var r=100;0==this.resolveShadows(i,e)&&!(r<=0);)r-=1;for(var t in i){var s=(a=i[t]).originNode;if(1!=this.helper.isTwoPositionSimilarEqual(cc.v2(a.x,a.y),cc.v2(s.x,s.y))){var c;if((c=s.getComponent("bulletMgr")).targetPosition=cc.v2(a.x,a.y),c.movingDirection=e,c.movingDirection.normalizeSelf(),null!=c.movingTime){var l=cc.v2(c.targetPosition.x-s.x,c.targetPosition.y-s.y).mag()/c.movingTime;c.vx=l*c.movingDirection.x,c.vy=l*c.movingDirection.y}else c.vx=c.movingDirection.x*c.movingSpeed,c.vy=c.movingDirection.y*c.movingSpeed;c.status=1,1!=this.isMoved&&(this.isMoved=!0)}}},onSuccess:function(){if(this.retryButton.getComponent(cc.Button).interactable=!1,this.level==this.playerData.currentLevel){var t=e("sectionConfig")[this.playerData.currentSection].levels,i=t.indexOf(this.playerData.currentLevel),o=null,n=null,a=null;if(i<t.length-1)o=t[i+=1];else{n=this.playerData.currentSection+1;var r=e("sectionConfig")[n].levels;o=r[0]}a=null==n?{currentLevel:o,physicalPowerCostedFlag:0}:{currentSection:n,currentLevel:o,physicalPowerCostedFlag:0};var s=this;e("dataMgr").commitPlayerDataToServer(a,function(){null!=n&&(s.playerData.currentSection=n),s.playerData.currentLevel=o,s.playerData.physicalPowerCostedFlag=0,e("gameMgr").animatedToScene("mainScene")})}else e("gameMgr").animatedToScene("mainScene")},resolveShadows:function(e,t){for(var i in e){var o=e[i];for(var n in e){var a=e[n];if(o!=a){var r=this._selectStaticShadowAndShaodwForResolved(o,a,t);if(0!=r){var s=r.staticShadow,c=r.shadowForResolved,l=this.helper.getLinesOfOneNode(s),h=null,u=this.helper.makeRay(cc.v2(s.x,s.y),1e3,cc.v2(-t.x,-t.y));for(var d in l){var g=l[d];if(0!=this.helper.rayTest(u,g)){h=g;break}}var y=this.helper.makeRay(h.p2,1e3,cc.v2(h.p2.x-h.p1.x,h.p2.y-h.p1.y)).p2;h={p1:this.helper.makeRay(h.p1,1e3,cc.v2(h.p1.x-h.p2.x,h.p1.y-h.p2.y)).p2,p2:y};var p=this.helper.makeRay(c.originNode.position,3e3,t),f=this.helper.rayTest(p,h),v=this.helper.getDisToSelfBorder(c.originNode,t)+c.originNode.getComponent("bulletMgr").disFromBorder,m=this.helper.getSuitablePoint(c.originNode.position,f,v,t),C=cc.v2(m.x-c.originNode.x,m.y-c.originNode.y).mag();return c.x=m.x,c.y=m.y,c.dis=C,!1}}}}return!0},_selectStaticShadowAndShaodwForResolved:function(e,t,i){var o=this,n=function(e,t){var n=e.dis,a=!1,r=!1,s=o.helper.getLinesOfOneNode(t);for(var c in s){var l=s[c];if(0!=o.helper.isOneNodeWillCollidWithOneLineInDirection(e.originNode,l,i,n)){a=!0;break}}if(0==a)return!1;var h=o.helper.getLinesOfOneNode(t.originNode);for(var c in h){l=h[c];if(0!=o.helper.isOneNodeWillCollidWithOneLineInDirection(e.originNode,l,i,n)){r=!0;break}}return 0!=r};return 1==n(e,t)?{staticShadow:t,shadowForResolved:e}:1==n(t,e)&&{staticShadow:e,shadowForResolved:t}},generateWalls:function(){var t=e("levelConfig")[this.level],i=cc.find("Canvas/walls");for(var o in t.wallPathes){var n=t.wallPathes[o],a=n.points,r=[];for(var s in a){var c=null;if(0==s)c=cc.v2(a[s].x,a[s].y);else{var l=a[s];c=cc.v2(r[s-1].x+l.x,r[s-1].y+l.y)}r.push(c)}var h=n.lineWidth,u=n.offset,d=[];if(1==n.isClosed){var g=r[0];r.push(g)}for(var s in r)if(0!=s){var y=cc.instantiate(this.linePrefab);y.height=h;var p=cc.v2(r[s].x-r[s-1].x,r[s].y-r[s-1].y);y.width=p.mag();var f=p.signAngle(cc.v2(1,0))/Math.PI*180;y.angle=-f,y.x=r[s].x-p.x/2,y.y=r[s].y-p.y/2;var v=p.rotate(Math.PI/2);v.normalizeSelf(),y.x+=y.height/2*v.x,y.y+=y.height/2*v.y,y.x+=u.x,y.y+=u.y,d.push(y),i.addChild(y)}}var m=t.bullets,C=cc.find("Canvas/bullets");for(var o in m){var x=m[o],w=cc.instantiate(this.bulletPrefab);w.x=x.x,w.y=x.y,w.width=w.width*x.scale,w.height=w.height*x.scale,C.addChild(w)}},onClickRetryButton:function(){var t=e("gameMgr");if(0!=this.heartForRetryCost){var i=this.playerData.heart-this.heartForRetryCost;if(!(i<0)){var o={heart:i},n=this;this.retryButton.getComponent(cc.Button).interactable=!1,e("dataMgr").commitPlayerDataToServer(o,function(){n.playerData.heart=i,n.heart=i,t.enterLevelScene(n.level)})}}else t.enterLevelScene(this.level)},onAllRetryFailed:function(){this.retryButton.getComponent(cc.Button).interactable=!0},onClickBackButton:function(){e("gameMgr").animatedToScene("mainScene")},onRefresh:function(){this.heart=this.playerData.heart}}),cc._RF.pop()},{dataMgr:"dataMgr",gameMgr:"gameMgr",helper:"helper",levelConfig:"levelConfig",networkMgr:"networkMgr",sectionConfig:"sectionConfig"}],loginMgr:[function(e,t,i){"use strict";cc._RF.push(t,"1552bGIYiVCypKdQfaxDM3E","loginMgr");var o=new(cc.Class({properties:{playerId:{get:function(){return this._playerId},set:function(e){this._playerId=e,e&&this.onPlayerIdSet()}},LoginType:{get:function(){return{ACCOUNT:1,WE_CHAT_GAME:2,DEVICE_ID:3}}}},login:function(e){this._setPlayerIdFromServer(e)},onPlayerIdSet:function(){this.updatePlayerDataFromServer(this.playerId)},updatePlayerDataFromServer:function(t){e("dataMgr").updatePlayerDataFromServer(t)},_genarateUUID:function(){var e=cc.sys.now(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});return t+=e.toString()},_setPlayerIdFromServer:function(t){var i=e("networkMgr"),o=i.makeMessageObj("loginModule","loginMessageType");o.message.codeType=t;var n=!1;switch(t){case this.LoginType.ACCOUNT:break;case this.LoginType.WE_CHAT_GAME:n=!0;var a=this;wx.login({success:function(e){var t=e.code;null!=t&&(o.message.code=t,o.successCallBack=function(e){var t=e.responseText;if("login_success"==(t=JSON.parse(t)).type){var i=t.playerId;a.playerId=i}else t.type},i.sendMessageByMsgObj(o))}});break;case this.LoginType.DEVICE_ID:var r=cc.sys.localStorage.getItem("deviceId");if(null==r){var s=this._genarateUUID();cc.sys.localStorage.setItem("deviceId",s),r=s}o.message.code=r;break;default:cc.log("Login type erro: now it's "+t)}if(1!=n){a=this;o.successCallBack=function(e){var t=e.responseText;if("login_success"==(t=JSON.parse(t)).type){var i=t.playerId;a.playerId=i}else t.type},i.sendMessageByMsgObj(o)}}}));t.exports=o,cc._RF.pop()},{dataMgr:"dataMgr",networkMgr:"networkMgr"}],loginSceneMgr:[function(e,t,i){"use strict";cc._RF.push(t,"91e8bJa47JD6Zkg4D6rPwYB","loginSceneMgr"),cc.Class({extends:cc.Component,properties:{dataMgr:null,loginMgr:null,networkMgr:null,isLogining:!1,changeSceneAnimationTime:2},onLoad:function(){this.node.on("touchstart",this.onTouchStart,this)},start:function(){this.dataMgr=e("dataMgr"),this.dataMgr.delegate=this,this.loginMgr=e("loginMgr"),this.networkMgr=e("networkMgr"),this.networkMgr.delegate=this;var t=cc.find("Canvas/retry");cc.tween(t).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:.8})).start(),this.login()},onPlayerDataUpdated:function(){for(var t in e("advertisMgr").initAds(),cc.find("Canvas/loginInfo/textNode").getComponent(cc.Label).string="\u767b\u9646\u6210\u529f\uff01",this.node.children){var i=this;(function(e){var t=i.node.children[e];cc.tween(t).to(i.changeSceneAnimationTime,{opacity:0}).start()})(t)}cc.tween(this.node).delay(this.changeSceneAnimationTime).call(function(){cc.director.loadScene("mainScene")}).start()},login:function(){this.isLogining=!0,cc.find("Canvas/retry").active=!1,cc.find("Canvas/loginInfo/textNode").getComponent(cc.Label).string="\u767b\u9646\u4e2d\uff0c\u8bf7\u7a0d\u5019";var e=null;e=cc.sys.platform==cc.sys.WECHAT_GAME?this.loginMgr.LoginType.WE_CHAT_GAME:this.loginMgr.LoginType.DEVICE_ID,this.loginMgr.login(e)},onTouchStart:function(e){0==this.isLogining&&this.login()},_debugLogin:function(){this.dataMgr.playerData={id:100000001,name:"new Player",physicalPower:10,maxPhysicalPower:10,heart:10,maxHeart:10,currentSection:1,currentLevel:2,physicalPowerCostedFlag:0},this.onPlayerDataUpdated()},onDestroy:function(){this.node.off("touchstart",this.onTouchStart,this)},onAllRetryFailed:function(){var e=cc.find("Canvas/loginInfo");e.getChildByName("textNode").getComponent(cc.Label).string="\u8fde\u63a5\u670d\u52a1\u5668\u5931\u8d25\uff0c\u8bf7\u70b9\u51fb\u91cd\u8bd5",e.active=!0,cc.find("Canvas/retry").active=!0,this.isLogining=!1}}),cc._RF.pop()},{advertisMgr:"advertisMgr",dataMgr:"dataMgr",loginMgr:"loginMgr",networkMgr:"networkMgr"}],mainSceneMgr:[function(e,t,i){"use strict";cc._RF.push(t,"2d432oBdXNLWptaxqVK4HcQ","mainSceneMgr"),cc.Class({extends:cc.Component,properties:{playerData:null,levelsStartPosition:cc.v2(0,0),levelsHorDis:60,levelsVerDis:60,levelsHorNum:5,levelNodePrefab:cc.Prefab,lockedLevelColor:cc.color,unlockedLevelColor:cc.color,currentLevelColor:cc.color,physicalPower:{get:function(){return this._physicalPower},set:function(e){this._physicalPower=e,this.node.getChildByName("physicalPowerLabel").getComponent(cc.Label).string=this.playerData.physicalPower.toString()+" / "+this.playerData.maxPhysicalPower.toString()}},maxPhysicalPower:{get:function(){return this._maxPhysicalPower},set:function(e){this._maxPhysicalPower=e}},physicalPowerForChallengeCost:{get:function(){return this._physicalPowerForChallengeCost},set:function(e){this._physicalPowerForChallengeCost=e;var t=this.challengeButton.getChildByName("physicalPowerLabel"),i=cc.find("Canvas/commentLabel"),o=this.challengeButton.getChildByName("physicalPower");null==e?(o.active=!1,t.active=!1):(o.active=!0,t.active=!0,t.getComponent(cc.Label).string=e.toString(),e<=this.physicalPower?(this.challengeButton.getComponent(cc.Button).interactable=!0,i.getComponent(cc.Label).string=0==e?"\u5df2\u6311\u6218\u8fc7\u7684\u5173\u5361\u4e0d\u4f1a\u6d88\u8017\u4f53\u529b":"\u6bcf\u5929\u6311\u6218\u6bcf\u4e2a\u65b0\u7684\u5173\u5361\u65f6\u4f1a\u6d88\u8017\u4f53\u529b"):(this.challengeButton.getComponent(cc.Button).interactable=!1,i.getComponent(cc.Label).string="\u6bcf\u5929\u6311\u6218\u6bcf\u4e2a\u65b0\u7684\u5173\u5361\u65f6\u4f1a\u6d88\u8017\u4f53\u529b"))}},heartForChallengeCost:{get:function(){return this._heartForChallengeCost},set:function(e){this._heartForChallengeCost=e;var t=this.challengeButton.getChildByName("heartLabel"),i=this.challengeButton.getChildByName("heart");null==e?(t.active=!1,i.active=!1):(t.active=!0,i.active=!0,t.getComponent(cc.Label).string=e.toString(),e<=this.heart?this.challengeButton.getComponent(cc.Button).interactable=!0:this.challengeButton.getComponent(cc.Button).interactable=!1)}},selectedLevel:{get:function(){return this._selectedLevel},set:function(t){if(this._selectedLevel=t,null!=t){if(t==this.playerData.currentLevel&&0==this.playerData.physicalPowerCostedFlag){this.heartForChallengeCost=null;var i=e("levelConfig")[t].physicalPowerCost;1==this.playerData.initAdWatchedFlag&&(i=Math.round(i/2)),this.physicalPowerForChallengeCost=i}else t==this.playerData.currentLevel&&1==this.playerData.physicalPowerCostedFlag?(this.physicalPowerForChallengeCost=null,this.heartForChallengeCost=e("levelConfig")[t].heartForRetryCost):(this.heartForChallengeCost=null,this.physicalPowerForChallengeCost=0);null!=this.levelAresNodes[t]&&(this.selectedLevelAreaNode=this.levelAresNodes[t])}}},selectedLevelAreaNode:{get:function(){return this._selectedLevelAreaNode},set:function(e){this._selectedLevelAreaNode=e,null!=e?0==this.selectedEffect.active?(this.selectedEffect.x=this.selectedLevelAreaNode.x,this.selectedEffect.y=this.selectedLevelAreaNode.y,this.selectedEffect.active=!0):cc.tween(this.selectedEffect).to(.2,{x:this.selectedLevelAreaNode.x,y:this.selectedLevelAreaNode.y}).start():this.selectedEffect.active=!1}},selectedEffect:cc.Node,levelAresNodes:{default:{}},challengeButton:null,heartLabel:cc.Label,heart:{get:function(){return this._heart},set:function(e){this._heart=e,this.heartLabel.string=e.toString()+" / "+this.maxHeart.toString()}},maxHeart:null},onLoad:function(){this.playerData=e("dataMgr").playerData,this.lockedLevelColor=cc.color(191,191,191),this.unlockedLevelColor=cc.color(102,102,102),this.currentLevelColor=cc.color(188,36,36),this.challengeButton=this.node.getChildByName("challengeButton"),this.playerName=this.playerData.name,this.maxPhysicalPower=this.playerData.maxPhysicalPower,this.physicalPower=this.playerData.physicalPower,this.maxHeart=this.playerData.maxHeart,this.heart=this.playerData.heart,e("networkMgr").delegate=this,e("dataMgr").delegate=this,this.setupSection(this.playerData.currentSection)},start:function(){},setupSection:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.selectedLevel=null;var o=e("sectionConfig")[t];this.node.getChildByName("sectionTitleLabel").getComponent(cc.Label).string=o.sectionTitle,this.node.getChildByName("sectionDescripLabel").getComponent(cc.Label).string=o.sectionDescrip;var n=o.levels;for(var a in this.levelAresNodes={},n){var r=parseInt(a)+1;1==(r=r.toString()).length&&(r="0"+r);var s=cc.instantiate(this.levelNodePrefab);switch(s.getComponent(cc.Label).string=r,s.x=a%this.levelsHorNum*(this.levelsHorDis+s.width)+this.levelsStartPosition.x,s.y=-Math.floor(a/this.levelsHorNum)*(this.levelsVerDis+s.width)+this.levelsStartPosition.y,this.checkLevelStatus(n[a])){case 0:s.color=this.lockedLevelColor;break;case 1:s.color=this.unlockedLevelColor;break;case 2:s.color=this.currentLevelColor}s.getComponent("levelAreaNodeMgr").delegate=this,s.getComponent("levelAreaNodeMgr").level=n[a],this.levelAresNodes[n[a]]=s,cc.find("Canvas/levelsArea").addChild(s)}var c=o.backgroundPath,l=this;cc.loader.loadRes(c,cc.SpriteFrame,function(e,t){l.node.getChildByName("sectionBg").getComponent(cc.Sprite).spriteFrame=t,i()}),t==this.playerData.currentSection&&(this.selectedLevel=this.playerData.currentLevel)},checkSectionStatus:function(e){var t=this.playerData.currentSection;return e>t?0:e<t?1:e==t?2:void 0},checkLevelStatus:function(t){var i=e("sectionConfig"),o=function(){for(var e in i){var o=i[e].levels;for(var n in o)if(t==o[n])return e}return!1}();if(0==o)return!1;switch(o=parseInt(o),this.checkSectionStatus(o)){case 0:return 0;case 1:return 1;case 2:var n=this.playerData.currentLevel;if(n==t)return 2;for(var a in e("sectionConfig")[o].levels){var r=e("sectionConfig")[o].levels[a];if(r==t)return 1;if(r==n)return 0}}},onClickChallengeButton:function(){var t=e("gameMgr");if(this.challengeButton.getComponent(cc.Button).interactable=!1,0!=this.physicalPowerForChallengeCost){var i=null,o=null;if(null!=this.physicalPowerForChallengeCost){if((i=this.playerData.physicalPower-this.physicalPowerForChallengeCost)<0)return;var n=this.playerData.physicalPowerCostedFlag;this.selectedLevel==this.playerData.currentLevel&&0==this.playerData.physicalPowerCostedFlag&&(n=1),o={physicalPower:i,physicalPowerCostedFlag:n}}if(null!=this.heartForChallengeCost){if((i=this.playerData.heart-this.heartForChallengeCost)<0)return;o={heart:i}}var a=this;e("dataMgr").commitPlayerDataToServer(o,function(){null!=a.physicalPowerForChallengeCost&&(a.playerData.physicalPower=i,a.physicalPower=i,a.playerData.physicalPowerCostedFlag=n),null!=a.heartForChallengeCost&&(a.playerData.heart=i,a.heart=i),t.enterLevelScene(a.selectedLevel)})}else t.enterLevelScene(this.selectedLevel)},onAllRetryFailed:function(){this.challengeButton.getComponent(cc.Button).interactable=!0},onRefresh:function(){this.heart=this.playerData.heart,this.physicalPower=this.playerData.physicalPower}}),cc._RF.pop()},{dataMgr:"dataMgr",gameMgr:"gameMgr",levelConfig:"levelConfig",networkMgr:"networkMgr",sectionConfig:"sectionConfig"}],networkMgr:[function(e,t,i){"use strict";cc._RF.push(t,"26886qZG21CFKSkgIvhUSHl","networkMgr");var o=new(cc.Class({extends:cc.Component,properties:{delegate:null,retryDelta:.5,retryTime:3,retryingFlag:!1,currentRetryTime:3,retryResult:{get:function(){return this._retryResult},set:function(e){this._retryResult=e,1==e&&null!=this.retryWaitingNode&&this.retryWaitingNode.destroy()}},retryWaitingNode:null},start:function(){},sendMessage:function(e,t,i,o,n){var a=new XMLHttpRequest;a.onreadystatechange=function(){4==a.readyState&&a.status>=200&&a.status<400&&n(a)};var r="http://"+i+":"+t.toString()+"/"+o.toString();a.open("POST",r),a.send(e)},makeMessageObj:function(t,i){var o=e("gloableConfig"),n=o.netWorkMessageConfigs[t];if(null!=n){var a=o.basicIp,r=o.basicPort;null!=n.ip&&(a=n.ip),null!=n.port&&(r=n.port);return{ip:a,port:r,suffix:n.suffix,message:n[i],successCallBack:function(e){}}}return cc.error("no such module name of "+t),null},sendMessageByMsgObj:function(e){var t="http://"+e.ip+":"+e.port.toString()+"/"+e.suffix,i=new XMLHttpRequest,o=this;i.onreadystatechange=function(){4==i.readyState&&i.status>=200&&i.status<400&&(e.successCallBack(i),1==o.retryingFlag&&(o.retryResult=!0))};var n=JSON.stringify(e.message);i.onerror=function(){0==o.retryingFlag&&cc.loader.loadRes("prefabs/retryWaitingNode",function(e,t){if(null!=o.delegate){var a=cc.instantiate(t);a.name="retryWaitingNode";var r=a.getChildByName("bg"),s=cc.director.getWinSize();r.width=s.width,r.height=s.height,r.on("touchstart",function(){},this),o.retryWaitingNode=a,o.delegate.node.addChild(o.retryWaitingNode)}o.retryingFlag=!0,o.scheduleOnce(function(){o.currentRetryTime-=1,i.send(n)},o.retryDelta)}),1==o.retryingFlag&&(o.currentRetryTime-=1,i.send(n),0==o.currentRetryTime&&(i.onerror=function(){i=null,o.onAllRetryFailed()},o.retryingFlag=!1,o.currentRetryTime=o.retryTime,o.retryResult=null))},i.open("POST",t),i.send(n)},onAllRetryFailed:function(){null!=this.retryWaitingNode&&this.retryWaitingNode.destroy(),null!=this.delegate&&this.delegate.onAllRetryFailed()}}));t.exports=o,cc._RF.pop()},{gloableConfig:"gloableConfig"}],notificationMgr:[function(e,t,i){"use strict";cc._RF.push(t,"8533axOVI1OlJIOOFwT+Qzn","notificationMgr"),cc.Class({extends:cc.Component,properties:{notiNode:null,notiPrefab:cc.Prefab,lastTime:3},start:function(){},showNoti:function(e){null==this.notiNode&&(this.notiNode=cc.instantiate(this.notiPrefab));var t=cc.instantiate(this.notiPrefab);t.getChildByName("label").getComponent(cc.Label).string=e,this.node.addChild(t);cc.tween(this.notiNode).delay(this.lastTime).to(.3,{opacity:0}).call(function(){t.removeFromParent()}).start()}}),cc._RF.pop()},{}],rankingSystem:[function(e,t,i){"use strict";cc._RF.push(t,"f2d4dhkhWpLB6YTf+2pbgMu","rankingSystem"),cc.Class({extends:cc.Component,properties:{uiPrefab:cc.Prefab,ui:null,enterButtonNode:null,rankNodePrefab:cc.Prefab,rankNodeStartY:175.327,rankNodesVerDis:20},onLoad:function(){this.ui=cc.instantiate(this.uiPrefab),this.ui.getChildByName("bg").on("touchstart",this.close,this),this.ui.getChildByName("others").getChildByName("closeButton").on("click",this.close,this),null!=this.enterButtonNode&&this.enterButtonNode.on("click",this.show,this)},start:function(){},show:function(){var e=this.ui.getChildByName("others");e.scale=0,null==this.ui.parent&&this.node.addChild(this.ui),this.ui.active=!0,cc.tween(e).to(.3,{scale:1}).start()},close:function(){var e=this.ui.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.ui.active=!1}).start()},setupData:function(){},setupRankingPerformance:function(){}}),cc._RF.pop()},{}],sectionConfig:[function(e,t,i){"use strict";cc._RF.push(t,"658e1kOKA9II7ENe3y2+Jif","sectionConfig");t.exports={1:{sectionTitle:"\u7b2c\u4e00\u7ae0",sectionDescrip:"\u65b0\u7684\u65c5\u9014",backgroundPath:"images/bg_01",levels:[1,2,3,4,5,6,7,8,9,10]},2:{sectionTitle:"\u7b2c\u4e8c\u7ae0",sectionDescrip:"\u6311\u6218",backgroundPath:"images/bg_02",levels:[11,12,13,14,15,16,17,18,19,20]},3:{sectionTitle:"\u7b2c\u4e09\u7ae0",sectionDescrip:"\u65b0\u751f",backgroundPath:"images/bg_01",levels:[21,22,23]}},cc._RF.pop()},{}],selectedEffectMgr:[function(e,t,i){"use strict";cc._RF.push(t,"82afeCfvMNPl6gwUD+AdF/T","selectedEffectMgr"),cc.Class({extends:cc.Component,properties:{fadeOutTime:.5},start:function(){cc.tween(this.node).repeatForever(cc.tween().to(this.fadeOutTime,{opacity:0}).to(this.fadeOutTime,{opacity:255})).start()}}),cc._RF.pop()},{}],signInSystem:[function(e,t,i){"use strict";cc._RF.push(t,"3671aL3S0lCFL5r4m+FxG83","signInSystem"),cc.Class({extends:cc.Component,properties:{enterButtonNode:cc.Node,ui:null,physicalPowerAddNum:10,heartAddNum:20,addRateForAd:2},onLoad:function(){null!=this.enterButtonNode&&this.enterButtonNode.on("click",this.show,this),this.ui=this.node.getComponent("ensureSystem").create();var t=this.ui.getComponent("ensureSystemNodeMgr");t.desText="\u6bcf\u65e5\u7b7e\u5230\u53ef\u4ee5\u83b7\u53d6\u4f53\u529b * 10\uff0c\u91d1\u5e01 * 20\uff0c\u60a8\u662f\u5426\u613f\u610f\u89c2\u770b\u89c6\u9891\u5e7f\u544a\u83b7\u5f97\u53cc\u500d\u5956\u52b1\uff1f",t.canClose=!1,t.ensureButtonWillAutoCloseUi=!1,t.cancelButtonWillAutoCloseUi=!1;var i=this;t.onCancleButtonClick=function(){i.close();var t=e("dataMgr").playerData.physicalPower+i.physicalPowerAddNum,o=e("dataMgr").playerData.heart+i.heartAddNum,n={physicalPower:t,heart:o};e("dataMgr").commitPlayerDataToServer(n,function(){e("dataMgr").playerData.physicalPower=t,e("dataMgr").playerData.heartAddNum=o;var n=i.node.getComponent("notificationMgr"),a="\u589e\u52a0\u4f53\u529b * "+i.physicalPowerAddNum.toString()+" \uff0c\u589e\u52a0\u91d1\u5e01 * "+i.heartAddNum.toString();n.showNoti(a)})},t.onEnsureButtonClick=function(){var t=e("advertisMgr");t.delegate=i,t.showVideoAd()},this.show()},start:function(){},show:function(){var e=this.ui.getChildByName("others");e.scale=0,null==this.ui.parent?this.node.addChild(this.ui):this.ui.active=!0,cc.tween(e).to(.3,{scale:1}).start()},close:function(){var e=this.ui.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.ui.active=!1}).start()},onVideoAdEnd:function(){var t=e("dataMgr").playerData.physicalPower+this.addRateForAd*this.physicalPowerAddNum,i=e("dataMgr").playerData.heart+this.addRateForAd*this.heartAddNum,o={physicalPower:t,heart:i},n=this;e("dataMgr").commitPlayerDataToServer(o,function(){e("dataMgr").playerData.physicalPower=t,e("dataMgr").playerData.heartAddNum=i;var o=n.node.getComponent("notificationMgr"),a="\u589e\u52a0\u4f53\u529b * "+(n.addRateForAd*n.physicalPowerAddNum).toString()+" \uff0c\u589e\u52a0\u91d1\u5e01 * "+(n.addRateForAd*n.heartAddNum).toString();o.showNoti(a),n.close()})},onVideoAdNotEnd:function(){this.node.getComponent("notificationMgr").showNoti("\u770b\u5b8c\u5e7f\u544a\u89c6\u9891\u624d\u80fd\u83b7\u5f97\u5956\u52b1\u54e6")},onVideoAdShowError:function(e){console.log("wow, there are some problems for ad system"),console.log(e);this.node.getComponent("notificationMgr").showNoti("\u5e7f\u544a\u7cfb\u7edf\u8c8c\u4f3c\u6709\u70b9\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")}}),cc._RF.pop()},{advertisMgr:"advertisMgr",dataMgr:"dataMgr"}],targetMgr:[function(e,t,i){"use strict";cc._RF.push(t,"25f14lIIdZGX5Bxde5y1xJx","targetMgr"),cc.Class({extends:cc.Component,properties:{fatalTolerance:.01,bullets:null,flag:!1,helper:null},onLoad:function(){var t=e("helper");this.helper=new t},start:function(){this.bullets=cc.find("Canvas").getComponent("levelMgr").bullets},update:function(e){if(1!=this.flag)for(var t in this.bullets){var i=this.bullets[t],o=i.getComponent("bulletMgr");if(1==o.bulletType&&(0==o.status&&1==this.checkWhetherSatisfied(i))){this.onSatisfy(i);break}}},checkWhetherSatisfied:function(e){var t=this.helper.getPointsOfOneNode(this.node),i=this.helper.getPointsOfOneNode(e);for(var o in t){var n=t[o],a=i[o];if(cc.v2(a.x-n.x,a.y-n.y).mag()>this.fatalTolerance)return!1}return!0},onSatisfy:function(e){this.flag=!0,e.getComponent("bulletMgr").status=2;var t=this;cc.tween(e).to(.2,{opacity:0}).call(function(){e.destroy()}).start(),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.destroy(),cc.find("Canvas").getComponent("levelMgr").targetsNum-=1}).start()},onDestroy:function(){}}),cc._RF.pop()},{helper:"helper"}],welfarySys:[function(e,t,i){"use strict";cc._RF.push(t,"12994CS+PNBD6kKBL4TD7Zx","welfarySys"),cc.Class({extends:cc.Component,properties:{uiPrefab:cc.Prefab,ui:null,enterButtonNode:cc.Node},onLoad:function(){if(null==this.ui){this.ui=cc.instantiate(this.uiPrefab);var t=this.ui.getChildByName("others"),i=t.getChildByName("closeButton"),o=t.getChildByName("button");i.on("click",this.onClickCloseButton,this),o.on("click",this.onClickVideoButton,this);var n=this.ui.getChildByName("bg"),a=cc.director.getWinSizeInPixels();n.width=a.width,n.height=a.height;var r=this;n.on("touchstart",function(){r.close()},this)}0==e("dataMgr").playerData.initAdWatchedFlag&&null!=this.enterButtonNode?(cc.tween(this.enterButtonNode).repeatForever(cc.tween().to(.2,{angle:-30}).to(.2,{angle:0}).to(.2,{angle:30}).to(.2,{angle:0}).delay(2)).start(),this.enterButtonNode.active=!0,this.enterButtonNode.on("click",this.show,this)):this.enterButtonNode.active=!1},start:function(){},show:function(){var e=this.ui.getChildByName("others");e.scale=0,null==this.ui.parent?this.node.addChild(this.ui):this.ui.active=!0,cc.tween(e).to(.3,{scale:1}).start()},close:function(){var e=this.ui.getChildByName("others"),t=this;cc.tween(e).to(.3,{scale:0}).call(function(){t.ui.active=!1}).start()},onClickCloseButton:function(){this.close()},onClickVideoButton:function(){var t=e("advertisMgr");if(null!=t.videoAd&&cc.sys.platform==cc.sys.WECHAT_GAME){var i=this;t.videoAd.onClose(function(t){if(t&&t.isEnded){var o=e("dataMgr");o.commitPlayerDataToServer({initAdWatchedFlag:1},function(){o.playerData.initAdWatchedFlag=1,i.node.getComponent("mainSceneMgr").selectedLevel=i.node.getComponent("mainSceneMgr").selectedLevel,null!=i.enterButtonNode&&(i.enterButtonNode.active=!1)})}else console.log("not ended video ad")}),t.videoAd.show().catch(function(e){console.log(e)})}}}),cc._RF.pop()},{advertisMgr:"advertisMgr",dataMgr:"dataMgr"}]},{},["levelConfig","sectionConfig","advertisMgr","bulletMgr","gameMgr","helper","levelAreaNodeMgr","levelMgr","dataMgr","gestureMgr","gloableConfig","loginMgr","networkMgr","loginSceneMgr","mainSceneMgr","notificationMgr","selectedEffectMgr","addHeartSys","addPhysicalPowerSys","ensureSystem","ensureSystemNodeMgr","rankingSystem","signInSystem","welfarySys","targetMgr"]);