window.__require=function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var c=a.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}}var h=n[a]={exports:{}};t[a][0].call(h.exports,function(e){return o(t[a][1][e]||e)},h,h.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)o(i[a]);return o}({bulletMgr:[function(e,t,n){"use strict";cc._RF.push(t,"2e7ebmG0o9A+INmyGAQ4snA","bulletMgr"),cc.Class({extends:cc.Component,properties:{bulletType:1,status:0,disFromBorder:10,moveSpeed:500,movingDirection:null,targetPosition:null,levelMgr:null,helper:null,_rayTestLength:3e3,pathWaysNode:cc.Node,pathWaysHeight:10,sliderFrame:cc.SpriteFrame},onLoad:function(){this.levelMgr=cc.find("Canvas").getComponent("levelMgr");var t=e("helper");this.helper=new t},start:function(){2==this.bulletType&&(this.node.getComponent(cc.Sprite).spriteFrame=this.sliderFrame)},move:function(e){},checkWhetherCanMove:function(e){},update:function(e){this.moveUpdate(e)},moveUpdate:function(e){if(1==this.status){this.movingDirection.normalizeSelf();var t=this.moveSpeed*this.movingDirection.x,n=this.moveSpeed*this.movingDirection.y,i=this.node.x+t*e,o=this.node.y+n*e;if(cc.v2(i-this.node.x,o-this.node.y).mag()>=cc.v2(this.targetPosition.x-this.node.x,this.targetPosition.y-this.node.y).mag())return i=this.targetPosition.x,o=this.targetPosition.y,this.node.x=i,this.node.y=o,void(this.status=0);this.node.x=i,this.node.y=o}},getNearestWallInfo:function(e){if(1==this.bulletType){var t=null,n=this.helper.makeRay(cc.v2(this.node.x,this.node.y),this._rayTestLength,e),i=this.levelMgr.walls,o=null,r=this.helper.getLinesOfOneNode(this.node);for(var a in r){var s=r[a];if(0!=(y=this.helper.rayTest(n,s))){o=y;break}}for(var c in i){var l=i[c],h=this.helper.getLinesOfOneNode(l);for(var a in h){s=h[a];if(0!=(y=this.helper.rayTest(n,s))&&(null==t||y<t.dis)){var g=this.disFromBorder+o;t={dis:y,suitablePosition:p=this.helper.getSuitablePoint(cc.v2(this.node.x,this.node.y),y,g,e)}}}}return t}if(2==this.bulletType){if(null==this.pathWaysNode||0==this.pathWaysNode.children.length)return{dis:0,suitablePosition:this.node.position};var u=null;for(var c in this.pathWaysNode.children){var d=this.pathWaysNode.children[c];0!=this.helper.isTwoNodeCross(this.node,d)&&((null==u||this.getMaxDisFromPathNode(d,e)>this.getMaxDisFromPathNode(u,e))&&(u=d))}n=this.helper.makeRay(this.node.position,3e3,e);var p,f=null,v=this.helper.getLinesOfOneNode(u);for(var a in v){var y;s=v[a];if(0!=(y=this.helper.rayTest(n,s))){f=y;break}}return{suitablePosition:p=this.helper.getSuitablePoint(this.node.position,f,this.pathWaysHeight/2,e),dis:y=cc.v2(p.x-this.node.x,p.y-this.node.y).mag()}}},getMaxDisFromPathNode:function(e,t){var n=this.helper.makeRay(this.node.position,3e3,t),i=this.helper.makeRay(this.node.position,3e3,cc.v2(-t.x,-t.y)),o=this.helper.getLinesOfOneNode(e),r=this,a=function(e){for(var t in o){var n=o[t],i=r.helper.rayTest(e,n);if(0!=i)return i}},s=a(n),c=a(i);return s>=c?s:c}}),cc._RF.pop()},{helper:"helper"}],dataMgr:[function(e,t,n){"use strict";cc._RF.push(t,"10be6vQoxhE9rkbWiJhY2u/","dataMgr");var i=new(cc.Class({properties:{playerData:{get:function(){return this._playerData},set:function(e){this._playerData=e,this.onPlayerDataUpdated(),null!=this.delegate&&this.delegate.onPlayerDataUpdated()}},delegate:null},updatePlayerDataFromServer:function(t){var n=e("networkMgr"),i=n.makeMessageObj("dataModule","queryMessageType");i.message.playerId=t;var o=this;i.successCallBack=function(e){var t=e.responseText;"success"==(t=JSON.parse(t)).type&&(o.playerData=t.playerData)},n.sendMessageByMsgObj(i)},onPlayerDataUpdated:function(){cc.log("now player data is "+JSON.stringify(this.playerData))},commitPlayerDataToServer:function(t){var n=e("networkMgr"),i=n.makeMessageObj("dataModule","commitMessageTyp");i.message.playerId=this.playerData.id,null!=i.message.playerId?(i.message.commitBody=t,n.sendMessageByMsgObj(i)):cc.log("no player data")}}));t.exports=i,cc._RF.pop()},{networkMgr:"networkMgr"}],gestureMgr:[function(e,t,n){"use strict";cc._RF.push(t,"b7b72lA9PpIAbkf8XjoS5lH","gestureMgr"),cc.Class({extends:cc.Component,properties:{isDragEnable:!0,isZoomEnable:!0,zoomSpeed:.00333,maxZoomRatio:1.2,minZoomRatio:.3,dragSpeed:1,camaraNode:cc.Node,minBoundX:-960,maxBoundX:960,minBoundY:-640,maxBoundY:640,touches:{default:[],visible:!1}},onLoad:function(){this.node.on("touchstart",function(e){this.onTouchStart(e)},this),this.node.on("touchmove",function(e){this.onTouchMove(e)},this),this.node.on("touchend",function(e){this.onTouchEnd(e)},this),this.node.on("touchcancel",function(e){this.onTouchCancel(e)},this)},onTouchStart:function(e){var t=e;this.touches.push(t)},onTouchMove:function(e){if(1==this.isDragEnable&&1==this.touches.length){var t=e.getDelta(),n=-1*t.x,i=-1*t.y;n*=this.dragSpeed,i*=this.dragSpeed;var o=this.camaraNode.getComponent(cc.Camera),r=cc.find("Canvas"),a=this.camaraNode.x+n,s=this.camaraNode.y+i,c=a+r.width/2*(1/o.zoomRatio),l=a-r.width/2*(1/o.zoomRatio),h=s+r.height/2*(1/o.zoomRatio),g=s-r.height/2*(1/o.zoomRatio);c<=this.maxBoundX&&l>=this.minBoundX&&(this.camaraNode.x=a),h<=this.maxBoundY&&g>=this.minBoundY&&(this.camaraNode.y=s)}if(1==this.isZoomEnable&&2==this.touches.length){var u=this.touches[0],d=this.touches[1],p=u.getLocation(),f=d.getLocation(),v=this.distanceOfTwoVector(p,f),y=u.getPreviousLocation(),m=d.getPreviousLocation(),x=v-this.distanceOfTwoVector(y,m),C=(o=this.camaraNode.getComponent(cc.Camera)).zoomRatio+this.zoomRatio*x;C>=minZoomRatio&&C<=maxZoomRatio&&(o.zoomRatio=C)}},onTouchEnd:function(e){this.deleteTouchEventFromTouchesArry(e)},onTouchCancel:function(e){this.deleteTouchEventFromTouchesArry(e)},deleteTouchEventFromTouchesArry:function(e){var t=null;for(var n in this.touches){if(this.touches[n].getID()==e.getID()){t=n;break}}null!=t&&this.touches.splice(n,1)},distanceOfTwoVector:function(e,t){var n=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);return n=Math.sqrt(n)}}),cc._RF.pop()},{}],gloableConfig:[function(e,t,n){"use strict";cc._RF.push(t,"94d39yYUJRKLIlaG9r7L5ON","gloableConfig");var i=new(cc.Class({properties:{basicIp:"127.0.0.1",basicPort:8888,netWorkMessageConfigs:{get:function(){return{loginModule:{suffix:"login",loginMessageType:{code:"asfdsfds",codeType:3}},dataModule:{suffix:"data",queryMessageType:{playerId:100000001,requestType:"query"},commitMessageTyp:{playerId:100000001,requestType:"commit",commitBody:{}}}}}}}}));t.exports=i,cc._RF.pop()},{}],helper:[function(e,t,n){"use strict";cc._RF.push(t,"fee26lOQ3NFBb7FR2MoK8sC","helper");var i=cc.Class({properties:{},segmentsIntr:function(e,t,n,i){var o=(e.x-n.x)*(t.y-n.y)-(e.y-n.y)*(t.x-n.x),r=(e.x-i.x)*(t.y-i.y)-(e.y-i.y)*(t.x-i.x);if(o*r>=0)return!1;var a=(n.x-e.x)*(i.y-e.y)-(n.y-e.y)*(i.x-e.x);if(a*(a+o-r)>=0)return!1;var s=a/(r-o),c=s*(t.x-e.x),l=s*(t.y-e.y);return{x:e.x+c,y:e.y+l}},rotateSegment:function(e,t,n,i){return{p1:this.rotateOnePoint(e,n,i),p2:this.rotateOnePoint(t,n,i)}},rotateOnePoint:function(e,t,n){var i=n*Math.PI/180,o=cc.v2(e.x-t.x,e.y-t.y).rotate(i);return cc.v2(o.x+t.x,o.y+t.y)},rayTest:function(e,t){var n=this.segmentsIntr(e.p1,e.p2,t.p1,t.p2);return 0!=n&&cc.v2(n.x-e.p1.x,n.y-e.p1.y).mag()},getSuitablePoint:function(e,t,n,i){if(n>=t)return e;i.normalizeSelf();var o=t*i.x,r=t*i.y,a=(t-n)/t,s=e.x+a*o,c=e.y+a*r;return cc.v2(s,c)},makeRay:function(e,t,n){var i={p1:e,p2:null};1!=n.mag()&&n.normalizeSelf();var o=n.x*t,r=n.y*t,a=e.x+o,s=e.y+r;return i.p2=cc.v2(a,s),i},getLinesOfOneNode:function(e){var t=e.height/2,n=cc.v2(e.x-e.width/2,e.y-t),i=cc.v2(e.x+e.width/2,e.y-t),o=cc.v2(n.x,n.y+e.height),r=cc.v2(i.x,i.y+e.height),a=cc.v2(e.x-e.width/2,e.y+e.height/2),s=cc.v2(a.x,a.y-e.height),c=cc.v2(e.x+e.width/2,e.y+e.height/2),l=cc.v2(c.x,c.y-e.height),h={p1:n,p2:i},g={p1:o,p2:r},u={p1:a,p2:s},d={p1:c,p2:l};null!=e.angle&&void 0!=e.angle&&(h=this.rotateSegment(n,i,cc.v2(e.x,e.y),-e.angle),g=this.rotateSegment(o,r,cc.v2(e.x,e.y),-e.angle),u=this.rotateSegment(a,s,cc.v2(e.x,e.y),-e.angle),d=this.rotateSegment(c,l,cc.v2(e.x,e.y),-e.angle));var p={lowerLine:h,upperLine:g,leftLine:u,rightLine:d};return null!=h&&null!=g&&null!=u&&null!=d||cc.error("NOT INVALID LINES"),p},isTwoNodeCross:function(e,t){var n=this.getInfoOfOneNode(e),i=this.getInfoOfOneNode(t);return!(n.minY>i.maxY||i.minY>n.maxY||n.minX>i.maxX||i.minX>n.maxX)},getInfoOfOneNode:function(e){var t=cc.v2(e.x-e.width/2,e.y+e.height/2),n=cc.v2(e.x+e.width/2,t.y),i=cc.v2(t.x,e.y-e.height/2),o=cc.v2(n.x,i.y);null!=e.angle&&void 0!=e.angle&&(t=this.rotateOnePoint(t,cc.v2(e.x,e.y),-e.angle),n=this.rotateOnePoint(n,cc.v2(e.x,e.y),-e.angle),i=this.rotateOnePoint(i,cc.v2(e.x,e.y),-e.angle),o=this.rotateOnePoint(o,cc.v2(e.x,e.y),-e.angle));var r=t.x,a=o.x,s=i.y,c=n.y,l=[t,i,n,o];for(var h in l){var g=l[h];r>g.x&&(r=g.x),a<g.x&&(a=g.x),s>g.y&&(s=g.y),c<g.y&&(c=g.y)}return{minX:r,minY:s,maxX:a,maxY:c}},getDisToSelfBorder:function(e,t){var n=this.makeRay(cc.v2(e.x,e.y),1e3,t),i=this.getLinesOfOneNode(e);for(var o in i){var r=i[o],a=this.rayTest(n,r);if(0!=a)return a}},getPointsOfOneNode:function(e){var t=cc.v2(e.x-e.width/2,e.y+e.height/2),n=cc.v2(e.x+e.width/2,t.y),i=cc.v2(t.x,e.y-e.height/2),o=cc.v2(n.x,i.y);return null!=e.angle&&void 0!=e.angle&&(t=this.rotateOnePoint(t,cc.v2(e.x,e.y),-e.angle),n=this.rotateOnePoint(n,cc.v2(e.x,e.y),-e.angle),i=this.rotateOnePoint(i,cc.v2(e.x,e.y),-e.angle),o=this.rotateOnePoint(o,cc.v2(e.x,e.y),-e.angle)),{leftUpPoint:t,leftDownPoint:i,rightUpPoint:n,rightDownPoint:o}}});t.exports=i,cc._RF.pop()},{}],levelAreaNodeMgr:[function(e,t,n){"use strict";cc._RF.push(t,"29e5a6+oelFOZV+81SUQg4A","levelAreaNodeMgr"),cc.Class({extends:cc.Component,properties:{delegate:null,level:null},onLoad:function(){this.node.on("touchstart",this.onTouchStart,this)},start:function(){},onTouchStart:function(e){this.delegate.selectedLevel!=this.level&&0!=this.delegate.checkLevelStatus(this.level)&&(this.delegate.selectedLevel=this.level)}}),cc._RF.pop()},{}],levelConfig:[function(e,t,n){"use strict";cc._RF.push(t,"cb3edynoalP+oqr1exCykM8","levelConfig");t.exports={1:{physicalPowerCost:2,heartForRetryCost:2},2:{physicalPowerCost:3,heartForRetryCost:2}},cc._RF.pop()},{}],levelMgr:[function(e,t,n){"use strict";cc._RF.push(t,"e7e748p6atLdo2Z1e9yNR+E","levelMgr"),cc.Class({extends:cc.Component,properties:{bullets:[],minDis:100,maxOffsetDegree:30,directionTryto:null,flag:!1,helper:null,walls:[],targetsNum:{get:function(){return this._targetsNum},set:function(e){this._targetsNum=e,0==e&&this.onSuccess()}},linePrefab:cc.Prefab,bulletPrefab:cc.Prefab,playerData:null,retryButton:cc.Node,heartForRetryCost:{get:function(){return this._heartForRetryCostwe},set:function(e){this._heartForRetryCostwe=e,this.retryButton.getChildByName("heartCostLabel").getComponent(cc.Label).string=e.toString()}},heart:{get:function(){return this._heart},set:function(e){this._heart=e,cc.find("Canvas/uiNode/heartLabel").getComponent(cc.Label).string=e.toString()+" / "+this.maxHeart.toString(),e<this.heartForRetryCost?this.retryButton.getComponent(cc.Button).interactable=!1:this.retryButton.getComponent(cc.Button).interactable=!0}},maxHeart:{get:function(){return this._maxHeart},set:function(e){this._maxHeart=e}}},onLoad:function(){var t=e("helper");this.helper=new t},start:function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchmove",this.onTouchMove,this),this.node.on("touchend",this.onTouchEnd,this);var t=cc.find("Canvas/bullets");this.bullets=t.children,this.playerData=e("dataMgr").playerData,this.maxHeart=this.playerData.maxHeart,this.heart=this.playerData.heart,this.heartForRetryCost=e("levelConfig")[this.playerData.currentLevel.toString()].heartForRetryCost,e("networkMgr").delegate=this;var n=cc.find("Canvas/walls");this.walls=n.children,this.targetsNum=cc.find("Canvas/targets").children.length;var i=cc.find("Canvas/fillNodes").getComponent(cc.Graphics),o=null,r=cc.find("Canvas/fillNodes").children;if(0!=r.length){for(var a in r){var s=r[a];null==o&&(i.moveTo(s.x,s.y),o=s),i.lineTo(s.x,s.y)}i.close(),i.stroke(),i.fill()}},onTouchStart:function(e){this.directionTryto=null,this.flag=!0},onTouchMove:function(e){if(0!=this.flag){var t=e.getDelta(),n=this.getPossiableDirection(t);if(-1!=n)if(null==this.directionTryto&&(this.directionTryto=n),0!=n.equals(this.directionTryto)){var i=e.getStartLocation();cc.v2(e.getLocationX()-i.x,e.getLocationY()-i.y).mag()>=this.minDis&&(this.flag=!1,this.moveBullets(this.directionTryto))}else this.flag=!1;else this.flag=!1}},onTouchEnd:function(e){},onDestroy:function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchmove",this.onTouchMove,this),this.node.off("touchend",this.onTouchEnd,this)},getPossiableDirection:function(e){return 1==this.isPossiableWithGivenDirection(e,cc.v2(1,0))?cc.v2(1,0):1==this.isPossiableWithGivenDirection(e,cc.v2(0,-1))?cc.v2(0,-1):1==this.isPossiableWithGivenDirection(e,cc.v2(-1,0))?cc.v2(-1,0):1==this.isPossiableWithGivenDirection(e,cc.v2(0,1))?cc.v2(0,1):-1},isPossiableWithGivenDirection:function(e,t){var n=e.signAngle(t)/Math.PI*180;return Math.abs(n)<=this.maxOffsetDegree},moveBullets:function(e){for(var t in this.bullets)if(0!=this.bullets[t].getComponent("bulletMgr").status)return;var n=[];for(var t in this.bullets){var i=this.bullets[t],o=i.getComponent("bulletMgr").getNearestWallInfo(e),r={x:o.suitablePosition.x,y:o.suitablePosition.y,width:i.width,height:i.height,dis:o.dis,originNode:i};n.push(r)}for(;0==this.resolveShadows(n,e););for(var t in n){var a=(r=n[t]).originNode;a.getComponent("bulletMgr").targetPosition=cc.v2(r.x,r.y),a.getComponent("bulletMgr").movingDirection=e,a.getComponent("bulletMgr").status=1}},onSuccess:function(){cc.log("YOU WIN")},resolveShadows:function(e,t){for(var n in e){var i=e[n];for(var o in e){var r=e[o];if(i!=r){var a=this._selectStaticShadowAndShaodwForResolved(i,r,t);if(0!=a){var s=a.staticShadow,c=a.shadowForResolved,l=this.helper.getLinesOfOneNode(s),h=null,g=this.helper.makeRay(cc.v2(s.x,s.y),1e3,cc.v2(-t.x,-t.y));for(var u in l){var d=l[u];if(0!=this.helper.rayTest(g,d)){h=d;break}}var p=this.helper.makeRay(h.p2,1e3,cc.v2(h.p2.x-h.p1.x,h.p2.y-h.p1.y)).p2;h={p1:this.helper.makeRay(h.p1,1e3,cc.v2(h.p1.x-h.p2.x,h.p1.y-h.p2.y)).p2,p2:p};var f=this.helper.makeRay(c.originNode.position,3e3,t),v=this.helper.rayTest(f,h),y=this.helper.getDisToSelfBorder(c.originNode,t)+c.originNode.getComponent("bulletMgr").disFromBorder,m=this.helper.getSuitablePoint(c.originNode.position,v,y,t),x=cc.v2(m.x-c.originNode.x,m.y-c.originNode.y).mag();return c.x=m.x,c.y=m.y,c.dis=x,!1}}}}return!0},_selectStaticShadowAndShaodwForResolved:function(e,t,n){var i=function(e,t,n,i,o){var r=i.helper.getPointsOfOneNode(e.originNode);for(var a in r.origin=cc.v2(e.originNode.x,e.originNode.y),r){var s=i.helper.makeRay(r[a],e.dis,n),c=null;for(var l in 1==o&&(c=i.helper.getLinesOfOneNode(t.originNode)),2==o&&(c=i.helper.getLinesOfOneNode(t)),c){var h=c[l];if(0!=i.helper.rayTest(s,h))return!0}}return!1};return 1==i(e,t,n,this,1)&&1==i(e,t,n,this,2)?{staticShadow:t,shadowForResolved:e}:1==i(t,e,n,this,1)&&1==i(t,e,n,this,2)&&{staticShadow:e,shadowForResolved:t}},generateWalls:function(){var t=e("levelConfig")[1],n=cc.find("Canvas/walls");for(var i in t.wallPathes){var o=t.wallPathes[i],r=o.points,a=[];for(var s in r){var c=null;if(0==s)c=cc.v2(r[s].x,r[s].y);else{var l=r[s];c=cc.v2(a[s-1].x+l.x,a[s-1].y+l.y)}a.push(c)}var h=o.lineWidth,g=o.offset,u=[];if(1==o.isClosed){var d=a[0];a.push(d)}for(var s in a)if(0!=s){var p=cc.instantiate(this.linePrefab);p.height=h;var f=cc.v2(a[s].x-a[s-1].x,a[s].y-a[s-1].y);p.width=f.mag();var v=f.signAngle(cc.v2(1,0))/Math.PI*180;p.angle=-v,p.x=a[s].x-f.x/2,p.y=a[s].y-f.y/2;var y=f.rotate(Math.PI/2);y.normalizeSelf(),p.x+=p.height/2*y.x,p.y+=p.height/2*y.y,p.x+=g.x,p.y+=g.y,u.push(p),n.addChild(p)}}var m=t.bullets,x=cc.find("Canvas/bullets");for(var i in m){var C=m[i],M=cc.instantiate(this.bulletPrefab);M.x=C.x,M.y=C.y,M.width=M.width*C.scale,M.height=M.height*C.scale,x.addChild(M)}},onClickRetryButton:function(){var t=this.heart-this.heartForRetryCost;if(!(t<0)){var n=e("networkMgr").makeMessageObj("dataModule","commitMessageTyp");n.message.id=this.playerData.playerId=this.playerData.id,n.message.commitBody={heart:t};var i=this;n.successCallBack=function(e){var n=e.responseText;"commitSuccess"==(n=JSON.parse(n)).type&&(i.heart=t,i.playerData.heart=t,cc.director.loadScene("level001"))},this.retryButton.getComponent(cc.Button).interactable=!1,e("networkMgr").sendMessageByMsgObj(n)}},onAllRetryFailed:function(){this.retryButton.getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{dataMgr:"dataMgr",helper:"helper",levelConfig:"levelConfig",networkMgr:"networkMgr"}],loginMgr:[function(e,t,n){"use strict";cc._RF.push(t,"1552bGIYiVCypKdQfaxDM3E","loginMgr");var i=new(cc.Class({properties:{playerId:{get:function(){return this._playerId},set:function(e){this._playerId=e,e&&this.onPlayerIdSet()}},LoginType:{get:function(){return{ACCOUNT:1,WE_CHAT_GAME:2,DEVICE_ID:3}}}},login:function(e){this._setPlayerIdFromServer(e)},onPlayerIdSet:function(){this.updatePlayerDataFromServer(this.playerId)},updatePlayerDataFromServer:function(t){e("dataMgr").updatePlayerDataFromServer(t)},_genarateUUID:function(){var e=cc.sys.now(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});return t+=e.toString()},_setPlayerIdFromServer:function(t){var n=e("networkMgr"),i=n.makeMessageObj("loginModule","loginMessageType");i.message.codeType=t;var o=!1;switch(t){case this.LoginType.ACCOUNT:break;case this.LoginType.WE_CHAT_GAME:o=!0;var r=this;wx.login({success:function(e){var t=e.code;null!=t&&(i.message.code=t,i.successCallBack=function(e){var t=e.responseText;if("login_success"==(t=JSON.parse(t)).type){var n=t.playerId;r.playerId=n}else t.type},n.sendMessageByMsgObj(i))}});break;case this.LoginType.DEVICE_ID:var a=cc.sys.localStorage.getItem("deviceId");if(null==a){var s=this._genarateUUID();cc.sys.localStorage.setItem("deviceId",s),a=s}i.message.code=a;break;default:cc.log("Login type erro: now it's "+t)}if(1!=o){r=this;i.successCallBack=function(e){var t=e.responseText;if("login_success"==(t=JSON.parse(t)).type){var n=t.playerId;r.playerId=n}else t.type},n.sendMessageByMsgObj(i)}}}));t.exports=i,cc._RF.pop()},{dataMgr:"dataMgr",networkMgr:"networkMgr"}],loginSceneMgr:[function(e,t,n){"use strict";cc._RF.push(t,"91e8bJa47JD6Zkg4D6rPwYB","loginSceneMgr"),cc.Class({extends:cc.Component,properties:{dataMgr:null,loginMgr:null,networkMgr:null,isLogining:!1,changeSceneAnimationTime:2},onLoad:function(){this.node.on("touchstart",this.onTouchStart,this)},start:function(){this.dataMgr=e("dataMgr"),this.dataMgr.delegate=this,this.loginMgr=e("loginMgr"),this.networkMgr=e("networkMgr"),this.networkMgr.delegate=this;var t=cc.find("Canvas/retry");cc.tween(t).repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:.8})).start(),this.login()},onPlayerDataUpdated:function(){for(var e in cc.find("Canvas/loginInfo/textNode").getComponent(cc.Label).string="\u767b\u9646\u6210\u529f\uff01",this.node.children){var t=this;(function(e){var n=t.node.children[e];cc.tween(n).to(t.changeSceneAnimationTime,{opacity:0}).start()})(e)}cc.tween(this.node).delay(this.changeSceneAnimationTime).call(function(){cc.director.loadScene("mainScene")}).start()},login:function(){this.isLogining=!0,cc.find("Canvas/retry").active=!1,cc.find("Canvas/loginInfo/textNode").getComponent(cc.Label).string="\u767b\u9646\u4e2d\uff0c\u8bf7\u7a0d\u5019";var e=null;e=cc.sys.platform==cc.sys.WECHAT_GAME?this.loginMgr.LoginType.WE_CHAT_GAME:this.loginMgr.LoginType.DEVICE_ID,this.loginMgr.login(e)},onTouchStart:function(e){0==this.isLogining&&this.login()},_debugLogin:function(){this.dataMgr.playerData={id:100000001,name:"new Player",physicalPower:10,maxPhysicalPower:10,heart:10,maxHeart:10,currentSection:1,currentLevel:2,physicalPowerCostedFlag:0},this.onPlayerDataUpdated()},onDestroy:function(){this.node.off("touchstart",this.onTouchStart,this)},onAllRetryFailed:function(){var e=cc.find("Canvas/loginInfo");e.getChildByName("textNode").getComponent(cc.Label).string="\u8fde\u63a5\u670d\u52a1\u5668\u5931\u8d25\uff0c\u8bf7\u70b9\u51fb\u91cd\u8bd5",e.active=!0,cc.find("Canvas/retry").active=!0,this.isLogining=!1}}),cc._RF.pop()},{dataMgr:"dataMgr",loginMgr:"loginMgr",networkMgr:"networkMgr"}],mainSceneMgr:[function(e,t,n){"use strict";cc._RF.push(t,"2d432oBdXNLWptaxqVK4HcQ","mainSceneMgr"),cc.Class({extends:cc.Component,properties:{playerData:null,levelsStartPosition:cc.v2(0,0),levelsHorDis:60,levelsVerDis:60,levelsHorNum:5,levelNodePrefab:cc.Prefab,lockedLevelColor:cc.color,unlockedLevelColor:cc.color,currentLevelColor:cc.color,physicalPower:{get:function(){return this._physicalPower},set:function(e){this._physicalPower=e,this.node.getChildByName("physicalPowerLabel").getComponent(cc.Label).string=this.playerData.physicalPower.toString()+" / "+this.playerData.maxPhysicalPower.toString()}},maxPhysicalPower:{get:function(){return this._maxPhysicalPower},set:function(e){this._maxPhysicalPower=e}},physicalPowerForChallengeCost:{get:function(){return this._physicalPowerForChallengeCost},set:function(e){this._physicalPowerForChallengeCost=e,cc.find("Canvas/challengeButton/physicalPowerLabel").getComponent(cc.Label).string=e.toString(),0==e?cc.find("Canvas/commentLabel").getComponent(cc.Label).string="\u5df2\u6311\u6218\u8fc7\u7684\u5173\u5361\u4e0d\u4f1a\u6d88\u8017\u4f53\u529b":e>0&&(cc.find("Canvas/commentLabel").getComponent(cc.Label).string="\u6bcf\u5929\u6311\u6218\u6bcf\u4e2a\u65b0\u7684\u5173\u5361\u65f6\u4f1a\u6d88\u8017\u4f53\u529b"),e>this.physicalPower?cc.find("Canvas/challengeButton").getComponent(cc.Button).interactable=!1:cc.find("Canvas/challengeButton").getComponent(cc.Button).interactable=!0}},selectedLevel:{get:function(){return this._selectedLevel},set:function(t){this._selectedLevel=t,null!=t&&(t==this.playerData.currentLevel&&0==this.playerData.physicalPowerCostedFlag?this.physicalPowerForChallengeCost=e("levelConfig")[t].physicalPowerCost:this.physicalPowerForChallengeCost=0,null!=this.levelAresNodes[t]&&(this.selectedLevelAreaNode=this.levelAresNodes[t]))}},selectedLevelAreaNode:{get:function(){return this._selectedLevelAreaNode},set:function(e){this._selectedLevelAreaNode=e,null!=e?0==this.selectedEffect.active?(this.selectedEffect.x=this.selectedLevelAreaNode.x,this.selectedEffect.y=this.selectedLevelAreaNode.y,this.selectedEffect.active=!0):cc.tween(this.selectedEffect).to(.2,{x:this.selectedLevelAreaNode.x,y:this.selectedLevelAreaNode.y}).start():this.selectedEffect.active=!1}},selectedEffect:cc.Node,levelAresNodes:{default:{}},challengeButton:null},onLoad:function(){this.playerData=e("dataMgr").playerData,this.lockedLevelColor=cc.color(191,191,191),this.unlockedLevelColor=cc.color(102,102,102),this.currentLevelColor=cc.color(188,36,36),this.playerName=this.playerData.name,this.maxPhysicalPower=this.playerData.maxPhysicalPower,this.physicalPower=this.playerData.physicalPower,this.setupSection(this.playerData.currentSection),e("networkMgr").delegate=this,this.challengeButton=this.node.getChildByName("challengeButton")},start:function(){},setupSection:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.selectedLevel=null;var i=e("sectionConfig")[t];this.node.getChildByName("sectionTitleLabel").getComponent(cc.Label).string=i.sectionTitle,this.node.getChildByName("sectionDescripLabel").getComponent(cc.Label).string=i.sectionDescrip;var o=i.levels;for(var r in this.levelAresNodes={},o){var a=parseInt(r)+1;1==(a=a.toString()).length&&(a="0"+a);var s=cc.instantiate(this.levelNodePrefab);switch(s.getComponent(cc.Label).string=a,s.x=r%this.levelsHorNum*(this.levelsHorDis+s.width)+this.levelsStartPosition.x,s.y=-Math.floor(r/this.levelsHorNum)*(this.levelsVerDis+s.width)+this.levelsStartPosition.y,this.checkLevelStatus(o[r])){case 0:s.color=this.lockedLevelColor;break;case 1:s.color=this.unlockedLevelColor;break;case 2:s.color=this.currentLevelColor}s.getComponent("levelAreaNodeMgr").delegate=this,s.getComponent("levelAreaNodeMgr").level=o[r],this.levelAresNodes[o[r]]=s,cc.find("Canvas/levelsArea").addChild(s)}var c=i.backgroundPath,l=this;cc.loader.loadRes(c,cc.SpriteFrame,function(e,t){l.node.getChildByName("sectionBg").getComponent(cc.Sprite).spriteFrame=t,n()}),t==this.playerData.currentSection&&(this.selectedLevel=this.playerData.currentLevel)},checkSectionStatus:function(e){var t=this.playerData.currentSection;return e>t?0:e<t?1:e==t?2:void 0},checkLevelStatus:function(t){var n=e("sectionConfig"),i=function(){for(var e in n){var i=n[e].levels;for(var o in i)if(t==i[o])return e}return!1}();if(0==i)return!1;switch(i=parseInt(i),this.checkSectionStatus(i)){case 0:return 0;case 1:return 1;case 2:var o=this.playerData.currentLevel;if(o==t)return 2;for(var r in e("sectionConfig")[i].levels){var a=e("sectionConfig")[i].levels[r];if(a==t)return 1;if(a==o)return 0}}},onClickChallengeButton:function(){if(this.challengeButton.getComponent(cc.Button).interactable=!1,0!=this.physicalPowerForChallengeCost){var t=this.physicalPower-this.physicalPowerForChallengeCost;if(!(t<0)){var n=e("networkMgr").makeMessageObj("dataModule","commitMessageTyp");n.message.playerId=this.playerData.id,n.message.commitBody={physicalPower:t};var i=this;n.successCallBack=function(e){var n=e.responseText;"commitSuccess"==(n=JSON.parse(n)).type&&(i.playerData.physicalPower=t,i.physicalPower=t,i.enterLevelScene(i.selectedLevel))},e("networkMgr").sendMessageByMsgObj(n)}}else this.enterLevelScene(this.selectedLevel)},enterLevelScene:function(e){cc.director.loadScene("level001")},onAllRetryFailed:function(){this.challengeButton.getComponent(cc.Button).interactable=!0}}),cc._RF.pop()},{dataMgr:"dataMgr",levelConfig:"levelConfig",networkMgr:"networkMgr",sectionConfig:"sectionConfig"}],networkMgr:[function(e,t,n){"use strict";cc._RF.push(t,"26886qZG21CFKSkgIvhUSHl","networkMgr");var i=new(cc.Class({extends:cc.Component,properties:{delegate:null,retryDelta:.5,retryTime:3,retryingFlag:!1,currentRetryTime:3,retryResult:{get:function(){return this._retryResult},set:function(e){this._retryResult=e,1==e&&null!=this.retryWaitingNode&&this.retryWaitingNode.destroy()}},retryWaitingNode:null},start:function(){},sendMessage:function(e,t,n,i,o){var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&r.status>=200&&r.status<400&&o(r)};var a="http://"+n+":"+t.toString()+"/"+i.toString();r.open("POST",a),r.send(e)},makeMessageObj:function(t,n){var i=e("gloableConfig"),o=i.netWorkMessageConfigs[t];if(null!=o){var r=i.basicIp,a=i.basicPort;null!=o.ip&&(r=o.ip),null!=o.port&&(a=o.port);return{ip:r,port:a,suffix:o.suffix,message:o[n],successCallBack:function(e){}}}return cc.error("no such module name of "+t),null},sendMessageByMsgObj:function(e){var t="http://"+e.ip+":"+e.port.toString()+"/"+e.suffix,n=new XMLHttpRequest,i=this;n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<400&&(e.successCallBack(n),1==i.retryingFlag&&(i.retryResult=!0))};var o=JSON.stringify(e.message);n.onerror=function(){0==i.retryingFlag&&cc.loader.loadRes("prefabs/retryWaitingNode",function(e,t){if(null!=i.delegate){var r=cc.instantiate(t);r.name="retryWaitingNode",i.retryWaitingNode=r,i.delegate.node.addChild(i.retryWaitingNode)}i.retryingFlag=!0,i.scheduleOnce(function(){i.currentRetryTime-=1,n.send(o)},i.retryDelta)}),1==i.retryingFlag&&(i.currentRetryTime-=1,n.send(o),0==i.currentRetryTime&&(n.onerror=function(){n=null,i.onAllRetryFailed()},i.retryingFlag=!1,i.currentRetryTime=i.retryTime,i.retryResult=null))},n.open("POST",t),n.send(o)},onAllRetryFailed:function(){null!=this.retryWaitingNode&&this.retryWaitingNode.destroy(),null!=this.delegate&&this.delegate.onAllRetryFailed()}}));t.exports=i,cc._RF.pop()},{gloableConfig:"gloableConfig"}],sectionConfig:[function(e,t,n){"use strict";cc._RF.push(t,"658e1kOKA9II7ENe3y2+Jif","sectionConfig");t.exports={1:{sectionTitle:"\u7b2c\u4e00\u7ae0",sectionDescrip:"\u65b0\u7684\u65c5\u9014",backgroundPath:"images/bg_01",levels:[1,2,3,4,5,6,7,8,9,10]},2:{sectionTitle:"\u7b2c\u4e8c\u7ae0",sectionDescrip:"\u6311\u6218",backgroundPath:"bgs/bg_02",levels:[11,12,13,14,15,16,17,18,19,20]}},cc._RF.pop()},{}],selectedEffectMgr:[function(e,t,n){"use strict";cc._RF.push(t,"82afeCfvMNPl6gwUD+AdF/T","selectedEffectMgr"),cc.Class({extends:cc.Component,properties:{fadeOutTime:.5},start:function(){cc.tween(this.node).repeatForever(cc.tween().to(this.fadeOutTime,{opacity:0}).to(this.fadeOutTime,{opacity:255})).start()}}),cc._RF.pop()},{}],targetMgr:[function(e,t,n){"use strict";cc._RF.push(t,"25f14lIIdZGX5Bxde5y1xJx","targetMgr"),cc.Class({extends:cc.Component,properties:{fatalTolerance:.01,bullets:null,flag:!1,helper:null},onLoad:function(){var t=e("helper");this.helper=new t},start:function(){this.bullets=cc.find("Canvas").getComponent("levelMgr").bullets},update:function(e){if(1!=this.flag)for(var t in this.bullets){var n=this.bullets[t],i=n.getComponent("bulletMgr");if(1==i.bulletType&&(0==i.status&&1==this.checkWhetherSatisfied(n))){this.onSatisfy(n);break}}},checkWhetherSatisfied:function(e){var t=this.helper.getPointsOfOneNode(this.node),n=this.helper.getPointsOfOneNode(e);for(var i in t){var o=t[i],r=n[i];if(cc.v2(r.x-o.x,r.y-o.y).mag()>this.fatalTolerance)return!1}return!0},onSatisfy:function(e){this.flag=!0,e.getComponent("bulletMgr").status=2;var t=this;cc.tween(e).to(.2,{opacity:0}).call(function(){e.destroy()}).start(),cc.tween(this.node).to(.2,{opacity:0}).call(function(){t.node.destroy(),cc.find("Canvas").getComponent("levelMgr").targetsNum-=1}).start()},onDestroy:function(){}}),cc._RF.pop()},{helper:"helper"}]},{},["levelConfig","sectionConfig","bulletMgr","helper","levelAreaNodeMgr","levelMgr","dataMgr","gestureMgr","gloableConfig","loginMgr","networkMgr","loginSceneMgr","mainSceneMgr","selectedEffectMgr","targetMgr"]);