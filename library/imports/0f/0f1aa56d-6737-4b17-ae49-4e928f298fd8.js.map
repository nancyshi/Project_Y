{"version":3,"sources":["../../../../../assets/scripts/systems/assets/scripts/systems/addPhysicalPowerSys.js"],"names":["AddPhysicalPowerSys","cc","Class","extends","Component","properties","ui","physicalPowerAddNum","show","setupUi","others","getChildByName","scale","parent","director","getScene","addChild","active","tween","to","start","close","self","call","require","create","ensureSystemNodeMgr","getComponent","ensureButtonWillAutoCloseUi","cancelButtonWillAutoCloseUi","canClose","desStr","toString","desText","onCancleButtonClick","onEnsureButtonClick","advertisMgr","delegate","showVideoAd","onVideoAdEnd","addedPhysicalPower","playerData","physicalPower","commitBody","successCallBack","name","commitPlayerDataToServer","onVideoAdShowError","notificationMgr","showNoti","sharedAddPhysicalPowerSys","module","exports"],"mappings":"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","file":"addPhysicalPowerSys.js","sourceRoot":"../../../../../assets/scripts/systems","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nvar AddPhysicalPowerSys = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        ui: null,\n        physicalPowerAddNum: 10\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // update (dt) {},\n    show() {\n        if (this.ui == null) {\n            this.setupUi()\n        }\n\n        var others = this.ui.getChildByName(\"others\")\n        others.scale = 0\n        if (this.ui.parent == null) {\n            cc.director.getScene().getChildByName(\"Canvas\").addChild(this.ui)\n        }\n        else {\n            this.ui.active = true\n        }\n\n        cc.tween(others)\n            .to(0.3,{scale: 1})\n            .start()\n    },\n\n    close() {\n        var others = this.ui.getChildByName(\"others\")\n        var self = this\n        cc.tween(others)\n            .to(0.3,{scale: 0})\n            .call(function(){\n                self.ui.active = false\n            })\n            .start()\n    },\n    setupUi() {\n        if (this.ui == null) {\n            this.ui = require(\"ensureSystem\").create()\n        }\n        var self = this\n        var ensureSystemNodeMgr = this.ui.getComponent(\"ensureSystemNodeMgr\")\n        ensureSystemNodeMgr.ensureButtonWillAutoCloseUi = false\n        ensureSystemNodeMgr.cancelButtonWillAutoCloseUi = false\n        ensureSystemNodeMgr.canClose = false\n        var desStr = \"您可以观看视频广告，获得体力 * \" + this.physicalPowerAddNum.toString()\n        desStr = desStr + \" ，您是否愿意观看？\"\n\n        ensureSystemNodeMgr.desText = desStr\n        ensureSystemNodeMgr.onCancleButtonClick = function() {\n            self.close()\n        }\n        ensureSystemNodeMgr.onEnsureButtonClick = function() {\n            var advertisMgr = require(\"advertisMgr\")\n            advertisMgr.delegate = self\n            advertisMgr.showVideoAd()\n        }\n    },\n\n    onVideoAdEnd() {\n        var addedPhysicalPower = require(\"dataMgr\").playerData.physicalPower + this.physicalPowerAddNum\n        var commitBody = {\n            physicalPower: addedPhysicalPower\n        }\n        var successCallBack = function() {\n            require(\"dataMgr\").playerData.physicalPower = addedPhysicalPower\n            if (cc.director.getScene().name == \"mainScene\") {\n                cc.director.getScene().getChildByName(\"Canvas\").getComponent(\"mainSceneMgr\").physicalPower = addedPhysicalPower\n            }\n        }\n\n        require(\"dataMgr\").commitPlayerDataToServer(commitBody,successCallBack)\n    },\n\n    onVideoAdShowError() {\n        var notificationMgr = require(\"notificationMgr\")\n        notificationMgr.showNoti(\"貌似有些问题\")\n    }\n});\n\n\nvar sharedAddPhysicalPowerSys = new AddPhysicalPowerSys()\nmodule.exports = sharedAddPhysicalPowerSys"]}