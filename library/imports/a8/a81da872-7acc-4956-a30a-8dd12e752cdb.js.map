{"version":3,"sources":["../../../../../assets/scripts/mainScene/assets/scripts/mainScene/preChallengeUIMgr.js"],"names":["cc","Class","extends","Component","properties","headerDis","footerDis","sectionDis","contentSpace","mailSectionElementDis","titleLabelNode","Node","challengeButtonNoe","contentSectionNode","mailSectionNode","closeButtonNode","mailSectionElementPrefab","Prefab","challengeButtonCostPhySprite","SpriteFrame","level","levelStatus","costResult","delegate","onLoad","bg","node","getChildByName","width","winSize","height","on","self","preChanllengeUIOpend","log","destroy","start","setupUI","getSectionAndIndexOfLevel","mainSceneMgr","director","getScene","getComponent","section","selectedSection","sectionConfig","require","levels","index","indexOf","_setupUIContent","_setupUIPosition","result","Label","string","toString","levelConfig","config","desText","desLabelNode","_forceUpdateRenderData","seperateLineUpNode","seperateLineDownNode","contentHeight","y","_getMailSectionInfo","mailSectionHeight","oneConfig","instantiate","desLabel","textStr","type","tag","minStep","completeIcon","status","active","length","addChild","_getCostInfoOfChallenge","Sprite","spriteFrame","num","totalHeight","uibg","mailSysConfig","conditions","currentConditionIndex","playerData","mailConditionIndex","oneConditionConfig","conditionType","conditionPara","oneResult","levelId","tagName","minStepNum","push","heartForRetryCost","flag","physicalPowerCostedFlag","physicalPowerCost","onClick","valueNum","heart","physicalPower","notificaitionSys","notiStr","showNoti","networkMgr","messageObj","makeMessageObj","message","playerId","id","commitBody","successCallBack","enterLevelScene","Button","interactable","sendMessageByMsgObj"],"mappings":"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","file":"preChallengeUIMgr.js","sourceRoot":"../../../../../assets/scripts/mainScene","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        headerDis: 83,\n        footerDis: 124,\n        sectionDis: 66,\n        contentSpace: 99,\n        mailSectionElementDis: 30,\n\n        titleLabelNode: cc.Node,\n        challengeButtonNoe: cc.Node,\n        contentSectionNode: cc.Node,\n        mailSectionNode: cc.Node,\n        closeButtonNode: cc.Node,\n        mailSectionElementPrefab: cc.Prefab,\n        challengeButtonCostPhySprite: cc.SpriteFrame,\n\n        level: null,\n        levelStatus: null,\n        costResult: null,\n        delegate: null\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var bg = this.node.getChildByName(\"bg\")\n        bg.width = cc.winSize.width\n        bg.height = cc.winSize.height\n        bg.on(\"touchstart\",function(){},this)\n\n        var self = this\n        this.closeButtonNode.on(\"click\",function(){\n            if (self.delegate != null) {\n                self.delegate.preChanllengeUIOpend = false\n            }\n            else {\n                cc.log(\"delegate is null\")\n            }\n            self.node.destroy()     \n        },this)\n    },\n\n    start () {\n        this.setupUI()\n    },\n\n    getSectionAndIndexOfLevel() {\n        var mainSceneMgr = cc.director.getScene().getChildByName(\"Canvas\").getComponent(\"mainSceneMgr\")\n        var section = mainSceneMgr.selectedSection\n        var sectionConfig = require(\"sectionConfig\")\n        var levels = sectionConfig[section].levels\n        var index = levels.indexOf(this.level) + 1\n        return [section, index]\n    },\n\n    setupUI() {\n        this._setupUIContent()\n        this._setupUIPosition()\n    },\n\n    _setupUIContent() {\n        //title label\n        var result = this.getSectionAndIndexOfLevel()\n        this.titleLabelNode.getComponent(cc.Label).string = result[0].toString() + \" - \" + result[1]\n        \n        //content section\n        var levelConfig = require(\"levelConfig\")\n        var config = levelConfig[this.level]\n        var desText = config.desText\n        var desLabelNode = this.contentSectionNode.getChildByName(\"desLabel\")\n        desLabelNode.getComponent(cc.Label).string = desText\n        desLabelNode.getComponent(cc.Label)._forceUpdateRenderData()\n\n        var seperateLineUpNode = this.contentSectionNode.getChildByName(\"seperateLineUp\")\n        var seperateLineDownNode = this.contentSectionNode.getChildByName(\"seperateLineDown\")\n        var contentHeight = desLabelNode.height + 2 * this.contentSpace + seperateLineUpNode.height + seperateLineDownNode.height\n        this.contentSectionNode.height = contentHeight\n\n        seperateLineUpNode.y = 0\n        desLabelNode.y = seperateLineUpNode.y - seperateLineUpNode.height - this.contentSpace\n        seperateLineDownNode.y = -contentHeight + seperateLineDownNode.height\n\n        //mailSection\n        var result = this._getMailSectionInfo()\n        var mailSectionHeight = 0\n        for (var index in result) {\n            var oneConfig = result[index]\n            var node = cc.instantiate(this.mailSectionElementPrefab)\n            var desLabel = node.getChildByName(\"desLabel\")\n            \n            var textStr = \"\"\n            if (oneConfig.type == 1) {\n                textStr = \"通关后会收到 \" + oneConfig.tag + \" 分支的新邮件\"\n            }\n            else if (oneConfig.type == 2) {\n                textStr = \"用不多于 \" + oneConfig.minStep + \" 步通关，会收到 \" + oneConfig.tag + \" 分支的新邮件\"\n            }\n            desLabel.getComponent(cc.Label).string = textStr\n            desLabel.getComponent(cc.Label)._forceUpdateRenderData()\n            \n            var completeIcon = node.getChildByName(\"completeIcon\")\n            if (oneConfig.status == true) {\n                completeIcon.active = true\n            }\n\n            if (desLabel.height > completeIcon.height) {\n                node.height = desLabel.height\n            }\n            else {\n                node.height = completeIcon.height\n            }\n\n            node.y = mailSectionHeight\n            mailSectionHeight += node.height\n            if (index != result.length - 1) {\n                mailSectionHeight += this.mailSectionElementDis\n            }\n            this.mailSectionNode.addChild(node)\n        }\n        this.mailSectionNode.height = mailSectionHeight\n\n        //challengeButton\n        var costResult = this._getCostInfoOfChallenge()\n        if (costResult.type == \"physicalPower\") {\n            this.challengeButtonNoe.getChildByName(\"costIcon\").getComponent(cc.Sprite).spriteFrame = this.challengeButtonCostPhySprite\n        }\n        \n        this.challengeButtonNoe.getChildByName(\"costLabel\").getComponent(cc.Label).string = costResult.num.toString()\n        this.costResult = costResult\n    },\n    _setupUIPosition() {\n        var totalHeight = this.footerDis + this.titleLabelNode.height + this.sectionDis + this.contentSectionNode.height + this.sectionDis + this.mailSectionNode.height + this.sectionDis + this.challengeButtonNoe.height + this.footerDis\n        var uibg = this.node.getChildByName(\"others\").getChildByName(\"uiBg\")\n        uibg.height = totalHeight\n\n        this.titleLabelNode.y = uibg.height / 2 - this.headerDis\n        this.contentSectionNode.y = this.titleLabelNode.y - this.titleLabelNode.height - this.sectionDis\n        this.mailSectionNode.y = this.contentSectionNode.y - this.contentSectionNode.height - this.sectionDis\n        this.challengeButtonNoe.y = this.mailSectionNode.y - this.mailSectionNode.height - this.sectionDis - this.challengeButtonNoe.height / 2\n    },\n\n    _getMailSectionInfo() {\n        var mailSysConfig = require(\"mailSysConfig\")\n        var result = []\n        for (var tag in mailSysConfig) {\n            var oneConfig = mailSysConfig[tag]\n            var conditions = oneConfig.conditions\n            var currentConditionIndex = require(\"dataMgr\").playerData.mailConditionIndex[tag]\n            for (var index in conditions) {\n                var oneConditionConfig = conditions[index]\n                var conditionType = oneConditionConfig.conditionType\n                var conditionPara = oneConditionConfig.conditionPara\n                \n                // if (conditionPara == this.level) {\n                //     var oneResult = {\n                //         tag: oneConfig.tagName,\n                //         status: null\n                //     }\n                    \n                // }\n                var oneResult = null\n                if ((conditionType == 1 && conditionPara == this.level) || (conditionType == 2 && conditionPara.levelId == this.level)) {\n                    oneResult = {\n                        tag: oneConfig.tagName,\n                        type: conditionType,\n                        status: null,\n                        minStep: null\n                    }\n                }\n                if (oneResult == null) {\n                    continue\n                }\n\n                if (index < currentConditionIndex) {\n                    oneResult.status = true\n                }\n                else {\n                    oneResult.status = false\n                }\n\n                if (conditionType == 2) {\n                    oneResult.minStep = conditionPara.minStepNum\n                }\n                result.push(oneResult)\n                break\n            }\n        }\n\n        return result\n    },\n\n    _getCostInfoOfChallenge() {\n        var result = {\n            type: \"physicalPower\",\n            num: 0\n        }\n        var levelConfig = require(\"levelConfig\")\n        if (this.levelStatus == 1) {\n            result.type = \"heart\"\n            result.num = levelConfig[this.level].heartForRetryCost\n        }\n        else if (this.levelStatus == 2) {\n            var flag = require(\"dataMgr\").playerData.physicalPowerCostedFlag\n            if (flag == 0) {\n                result.type = \"physicalPower\"\n                result.num = levelConfig[this.level].physicalPowerCost\n            }\n            else if (flag == 1) {\n                result.type = \"heart\"\n                result.num = levelConfig[this.level].heartForRetryCost\n            }\n        }\n\n        return result\n    },\n\n    onClick() {\n        if (this.costResult == null || this.costResult.num == 0) {\n            return\n        }\n        var valueNum = null\n        if (this.costResult.type == \"heart\") {\n            valueNum = require(\"dataMgr\").playerData.heart - this.costResult.num\n        }\n        else if (this.costResult.type == \"physicalPower\") {\n            valueNum = require(\"dataMgr\").playerData.physicalPower - this.costResult.num\n        }\n\n        if (valueNum == null || valueNum < 0) {\n            var notificaitionSys = require(\"notificationMgr\")\n            var notiStr = \"\"\n            if (this.costResult.type == \"heart\") {\n                notiStr = \"金币不足\"\n            }\n            else if (this.costResult.type == \"physicalPower\") {\n                notiStr = \"体力不足\"\n            }\n            notificaitionSys.showNoti(notiStr)\n            return\n        }\n        \n        \n        var networkMgr = require(\"networkMgr\")\n        var messageObj = networkMgr.makeMessageObj(\"dataModule\",\"commitMessageTyp\")\n        messageObj.message.playerId = require(\"dataMgr\").playerData.id\n        var commitBody = null\n        if (this.costResult.type == \"heart\") {\n            commitBody = {\n                \"heart\": require(\"dataMgr\").playerData.heart - this.costResult.num\n            }\n        }\n\n        else if (this.costResult.type == \"physicalPower\") {\n            commitBody = {\n                \"physicalPower\": require(\"dataMgr\").playerData.physicalPower - this.costResult.num\n            }\n        }\n\n        messageObj.message.commitBody = commitBody\n        var self = this\n        messageObj.successCallBack = function(){\n            if (self.costResult.type == \"heart\") {\n                require(\"dataMgr\").playerData.heart = commitBody.heart\n            }\n            else if (self.costResult.type == \"physicalPower\") {\n                require(\"dataMgr\").playerData.physicalPower = commitBody.physicalPower\n            }\n            \n            // self.challengeButtonNoe.getComponent(cc.Button).interactable = true\n            require(\"gameMgr\").enterLevelScene(self.level)\n        }\n\n        this.challengeButtonNoe.getComponent(cc.Button).interactable = false\n        networkMgr.sendMessageByMsgObj(messageObj)\n    }\n    // update (dt) {},\n});\n"]}