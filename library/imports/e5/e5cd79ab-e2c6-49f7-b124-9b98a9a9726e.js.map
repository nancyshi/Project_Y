{"version":3,"sources":["../../../../../assets/scripts/mainScene/assets/scripts/mainScene/preChallengeUIMgr.js"],"names":["cc","Class","extends","Component","properties","headerDis","footerDis","sectionDis","contentSpace","mailSectionElementDis","titleLabelNode","Node","challengeButtonNoe","contentSectionNode","mailSectionNode","closeButtonNode","mailSectionElementPrefab","Prefab","challengeButtonCostPhySprite","SpriteFrame","level","levelStatus","costResult","delegate","onLoad","textConfig","require","bg","node","getChildByName","width","winSize","height","on","self","preChanllengeUIOpend","log","destroy","getComponent","Label","string","getTextByIdAndLanguageType","start","setupUI","getSectionAndIndexOfLevel","mainSceneMgr","director","getScene","section","selectedSection","sectionConfig","levels","index","indexOf","_setupUIContent","_setupUIPosition","result","toString","levelConfig","config","desLabelNode","desTextId","_forceUpdateRenderData","seperateLineUpNode","seperateLineDownNode","contentHeight","y","_getMailSectionInfo","mailSectionHeight","oneConfig","instantiate","desLabel","textStr","type","getFormatedString","tag","minStep","completeIcon","status","active","length","addChild","_getCostInfoOfChallenge","Sprite","spriteFrame","num","totalHeight","uibg","mailSysConfig","conditions","currentConditionIndex","playerData","mailConditionIndex","oneConditionConfig","conditionType","conditionPara","oneResult","levelId","tagNameTextId","minStepNum","push","heartForRetryCost","flag","physicalPowerCostedFlag","physicalPowerCost","onClick","valueNum","heart","physicalPower","notificaitionSys","notiStr","showNoti","networkMgr","messageObj","makeMessageObj","message","playerId","id","commitBody","successCallBack","enterLevelScene","Button","interactable","sendMessageByMsgObj"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,mBAAW,EAhBH;AAiBRC,mBAAW,GAjBH;AAkBRC,oBAAY,EAlBJ;AAmBRC,sBAAc,EAnBN;AAoBRC,+BAAuB,EApBf;;AAsBRC,wBAAgBV,GAAGW,IAtBX;AAuBRC,4BAAoBZ,GAAGW,IAvBf;AAwBRE,4BAAoBb,GAAGW,IAxBf;AAyBRG,yBAAiBd,GAAGW,IAzBZ;AA0BRI,yBAAiBf,GAAGW,IA1BZ;AA2BRK,kCAA0BhB,GAAGiB,MA3BrB;AA4BRC,sCAA8BlB,GAAGmB,WA5BzB;;AA8BRC,eAAO,IA9BC;AA+BRC,qBAAa,IA/BL;AAgCRC,oBAAY,IAhCJ;AAiCRC,kBAAU;AAjCF,KAHP;;AAuCL;;AAEAC,UAzCK,oBAyCK;AACN,YAAIC,aAAaC,QAAQ,YAAR,CAAjB;AACA,YAAIC,KAAK,KAAKC,IAAL,CAAUC,cAAV,CAAyB,IAAzB,CAAT;AACAF,WAAGG,KAAH,GAAW9B,GAAG+B,OAAH,CAAWD,KAAtB;AACAH,WAAGK,MAAH,GAAYhC,GAAG+B,OAAH,CAAWC,MAAvB;AACAL,WAAGM,EAAH,CAAM,YAAN,EAAmB,YAAU,CAAE,CAA/B,EAAgC,IAAhC;;AAEA,YAAIC,OAAO,IAAX;AACA,aAAKnB,eAAL,CAAqBkB,EAArB,CAAwB,OAAxB,EAAgC,YAAU;AACtC,gBAAIC,KAAKX,QAAL,IAAiB,IAArB,EAA2B;AACvBW,qBAAKX,QAAL,CAAcY,oBAAd,GAAqC,KAArC;AACH,aAFD,MAGK;AACDnC,mBAAGoC,GAAH,CAAO,kBAAP;AACH;AACDF,iBAAKN,IAAL,CAAUS,OAAV;AACH,SARD,EAQE,IARF;;AAUA,aAAKzB,kBAAL,CAAwBiB,cAAxB,CAAuC,WAAvC,EAAoDS,YAApD,CAAiEtC,GAAGuC,KAApE,EAA2EC,MAA3E,GAAoFf,WAAWgB,0BAAX,CAAsC,GAAtC,CAApF;AACH,KA5DI;AA8DLC,SA9DK,mBA8DI;AACL,aAAKC,OAAL;AACH,KAhEI;AAkELC,6BAlEK,uCAkEuB;AACxB,YAAIC,eAAe7C,GAAG8C,QAAH,CAAYC,QAAZ,GAAuBlB,cAAvB,CAAsC,QAAtC,EAAgDS,YAAhD,CAA6D,cAA7D,CAAnB;AACA,YAAIU,UAAUH,aAAaI,eAA3B;AACA,YAAIC,gBAAgBxB,QAAQ,eAAR,CAApB;AACA,YAAIyB,SAASD,cAAcF,OAAd,EAAuBG,MAApC;AACA,YAAIC,QAAQD,OAAOE,OAAP,CAAe,KAAKjC,KAApB,IAA6B,CAAzC;AACA,eAAO,CAAC4B,OAAD,EAAUI,KAAV,CAAP;AACH,KAzEI;AA2ELT,WA3EK,qBA2EK;AACN,aAAKW,eAAL;AACA,aAAKC,gBAAL;AACH,KA9EI;AAgFLD,mBAhFK,6BAgFa;AACd;AACA,YAAIE,SAAS,KAAKZ,yBAAL,EAAb;AACA,aAAKlC,cAAL,CAAoB4B,YAApB,CAAiCtC,GAAGuC,KAApC,EAA2CC,MAA3C,GAAoDgB,OAAO,CAAP,EAAUC,QAAV,KAAuB,KAAvB,GAA+BD,OAAO,CAAP,CAAnF;;AAEA;AACA,YAAIE,cAAchC,QAAQ,aAAR,CAAlB;AACA,YAAIiC,SAASD,YAAY,KAAKtC,KAAjB,CAAb;AACA,YAAIwC,eAAe,KAAK/C,kBAAL,CAAwBgB,cAAxB,CAAuC,UAAvC,CAAnB;AACA+B,qBAAatB,YAAb,CAA0BtC,GAAGuC,KAA7B,EAAoCC,MAApC,GAA6Cd,QAAQ,YAAR,EAAsBe,0BAAtB,CAAiDkB,OAAOE,SAAxD,CAA7C;AACAD,qBAAatB,YAAb,CAA0BtC,GAAGuC,KAA7B,EAAoCuB,sBAApC;;AAEA,YAAIC,qBAAqB,KAAKlD,kBAAL,CAAwBgB,cAAxB,CAAuC,gBAAvC,CAAzB;AACA,YAAImC,uBAAuB,KAAKnD,kBAAL,CAAwBgB,cAAxB,CAAuC,kBAAvC,CAA3B;AACA,YAAIoC,gBAAgBL,aAAa5B,MAAb,GAAsB,IAAI,KAAKxB,YAA/B,GAA8CuD,mBAAmB/B,MAAjE,GAA0EgC,qBAAqBhC,MAAnH;AACA,aAAKnB,kBAAL,CAAwBmB,MAAxB,GAAiCiC,aAAjC;;AAEAF,2BAAmBG,CAAnB,GAAuB,CAAvB;AACAN,qBAAaM,CAAb,GAAiBH,mBAAmBG,CAAnB,GAAuBH,mBAAmB/B,MAA1C,GAAmD,KAAKxB,YAAzE;AACAwD,6BAAqBE,CAArB,GAAyB,CAACD,aAAD,GAAiBD,qBAAqBhC,MAA/D;;AAEA;AACA,YAAIP,aAAaC,QAAQ,YAAR,CAAjB;AACA,YAAI8B,SAAS,KAAKW,mBAAL,EAAb;AACA,YAAIC,oBAAoB,CAAxB;AACA,aAAK,IAAIhB,KAAT,IAAkBI,MAAlB,EAA0B;AACtB,gBAAIa,YAAYb,OAAOJ,KAAP,CAAhB;AACA,gBAAIxB,OAAO5B,GAAGsE,WAAH,CAAe,KAAKtD,wBAApB,CAAX;AACA,gBAAIuD,WAAW3C,KAAKC,cAAL,CAAoB,UAApB,CAAf;;AAEA,gBAAI2C,UAAU,EAAd;AACA,gBAAIH,UAAUI,IAAV,IAAkB,CAAtB,EAAyB;AACrB;AACAD,0BAAU/C,WAAWiD,iBAAX,CAA6B,GAA7B,EAAiC,CAACL,UAAUM,GAAX,CAAjC,CAAV;AACH,aAHD,MAIK,IAAIN,UAAUI,IAAV,IAAkB,CAAtB,EAAyB;AAC1B;AACAD,0BAAU/C,WAAWiD,iBAAX,CAA6B,GAA7B,EAAiC,CAACL,UAAUO,OAAX,EAAmBP,UAAUM,GAA7B,CAAjC,CAAV;AACH;AACDJ,qBAASjC,YAAT,CAAsBtC,GAAGuC,KAAzB,EAAgCC,MAAhC,GAAyCgC,OAAzC;AACAD,qBAASjC,YAAT,CAAsBtC,GAAGuC,KAAzB,EAAgCuB,sBAAhC;;AAEA,gBAAIe,eAAejD,KAAKC,cAAL,CAAoB,cAApB,CAAnB;AACA,gBAAIwC,UAAUS,MAAV,IAAoB,IAAxB,EAA8B;AAC1BD,6BAAaE,MAAb,GAAsB,IAAtB;AACH;;AAED,gBAAIR,SAASvC,MAAT,GAAkB6C,aAAa7C,MAAnC,EAA2C;AACvCJ,qBAAKI,MAAL,GAAcuC,SAASvC,MAAvB;AACH,aAFD,MAGK;AACDJ,qBAAKI,MAAL,GAAc6C,aAAa7C,MAA3B;AACH;;AAEDJ,iBAAKsC,CAAL,GAASE,iBAAT;AACAA,iCAAqBxC,KAAKI,MAA1B;AACA,gBAAIoB,SAASI,OAAOwB,MAAP,GAAgB,CAA7B,EAAgC;AAC5BZ,qCAAqB,KAAK3D,qBAA1B;AACH;AACD,iBAAKK,eAAL,CAAqBmE,QAArB,CAA8BrD,IAA9B;AACH;AACD,aAAKd,eAAL,CAAqBkB,MAArB,GAA8BoC,iBAA9B;;AAEA;AACA,YAAI9C,aAAa,KAAK4D,uBAAL,EAAjB;AACA,YAAI5D,WAAWmD,IAAX,IAAmB,eAAvB,EAAwC;AACpC,iBAAK7D,kBAAL,CAAwBiB,cAAxB,CAAuC,UAAvC,EAAmDS,YAAnD,CAAgEtC,GAAGmF,MAAnE,EAA2EC,WAA3E,GAAyF,KAAKlE,4BAA9F;AACH;;AAED,aAAKN,kBAAL,CAAwBiB,cAAxB,CAAuC,WAAvC,EAAoDS,YAApD,CAAiEtC,GAAGuC,KAApE,EAA2EC,MAA3E,GAAoFlB,WAAW+D,GAAX,CAAe5B,QAAf,EAApF;AACA,aAAKnC,UAAL,GAAkBA,UAAlB;AACH,KAvJI;AAwJLiC,oBAxJK,8BAwJc;AACf,YAAI+B,cAAc,KAAKhF,SAAL,GAAiB,KAAKI,cAAL,CAAoBsB,MAArC,GAA8C,KAAKzB,UAAnD,GAAgE,KAAKM,kBAAL,CAAwBmB,MAAxF,GAAiG,KAAKzB,UAAtG,GAAmH,KAAKO,eAAL,CAAqBkB,MAAxI,GAAiJ,KAAKzB,UAAtJ,GAAmK,KAAKK,kBAAL,CAAwBoB,MAA3L,GAAoM,KAAK1B,SAA3N;AACA,YAAIiF,OAAO,KAAK3D,IAAL,CAAUC,cAAV,CAAyB,QAAzB,EAAmCA,cAAnC,CAAkD,MAAlD,CAAX;AACA0D,aAAKvD,MAAL,GAAcsD,WAAd;;AAEA,aAAK5E,cAAL,CAAoBwD,CAApB,GAAwBqB,KAAKvD,MAAL,GAAc,CAAd,GAAkB,KAAK3B,SAA/C;AACA,aAAKQ,kBAAL,CAAwBqD,CAAxB,GAA4B,KAAKxD,cAAL,CAAoBwD,CAApB,GAAwB,KAAKxD,cAAL,CAAoBsB,MAA5C,GAAqD,KAAKzB,UAAtF;AACA,aAAKO,eAAL,CAAqBoD,CAArB,GAAyB,KAAKrD,kBAAL,CAAwBqD,CAAxB,GAA4B,KAAKrD,kBAAL,CAAwBmB,MAApD,GAA6D,KAAKzB,UAA3F;AACA,aAAKK,kBAAL,CAAwBsD,CAAxB,GAA4B,KAAKpD,eAAL,CAAqBoD,CAArB,GAAyB,KAAKpD,eAAL,CAAqBkB,MAA9C,GAAuD,KAAKzB,UAA5D,GAAyE,KAAKK,kBAAL,CAAwBoB,MAAxB,GAAiC,CAAtI;AACH,KAjKI;AAmKLmC,uBAnKK,iCAmKiB;AAClB,YAAIqB,gBAAgB9D,QAAQ,eAAR,CAApB;AACA,YAAI8B,SAAS,EAAb;AACA,YAAI/B,aAAaC,QAAQ,YAAR,CAAjB;AACA,aAAK,IAAIiD,GAAT,IAAgBa,aAAhB,EAA+B;AAC3B,gBAAInB,YAAYmB,cAAcb,GAAd,CAAhB;AACA,gBAAIc,aAAapB,UAAUoB,UAA3B;AACA,gBAAIC,wBAAwBhE,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BC,kBAA9B,CAAiDjB,GAAjD,CAA5B;AACA,iBAAK,IAAIvB,KAAT,IAAkBqC,UAAlB,EAA8B;AAC1B,oBAAII,qBAAqBJ,WAAWrC,KAAX,CAAzB;AACA,oBAAI0C,gBAAgBD,mBAAmBC,aAAvC;AACA,oBAAIC,gBAAgBF,mBAAmBE,aAAvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAIC,YAAY,IAAhB;AACA,oBAAKF,iBAAiB,CAAjB,IAAsBC,iBAAiB,KAAK3E,KAA7C,IAAwD0E,iBAAiB,CAAjB,IAAsBC,cAAcE,OAAd,IAAyB,KAAK7E,KAAhH,EAAwH;AACpH4E,gCAAY;AACR;AACArB,6BAAKlD,WAAWgB,0BAAX,CAAsC4B,UAAU6B,aAAhD,CAFG;AAGRzB,8BAAMqB,aAHE;AAIRhB,gCAAQ,IAJA;AAKRF,iCAAS;AALD,qBAAZ;AAOH;AACD,oBAAIoB,aAAa,IAAjB,EAAuB;AACnB;AACH;;AAED,oBAAI5C,QAAQsC,qBAAZ,EAAmC;AAC/BM,8BAAUlB,MAAV,GAAmB,IAAnB;AACH,iBAFD,MAGK;AACDkB,8BAAUlB,MAAV,GAAmB,KAAnB;AACH;;AAED,oBAAIgB,iBAAiB,CAArB,EAAwB;AACpBE,8BAAUpB,OAAV,GAAoBmB,cAAcI,UAAlC;AACH;AACD3C,uBAAO4C,IAAP,CAAYJ,SAAZ;AACA;AACH;AACJ;;AAED,eAAOxC,MAAP;AACH,KArNI;AAuNL0B,2BAvNK,qCAuNqB;AACtB,YAAI1B,SAAS;AACTiB,kBAAM,eADG;AAETY,iBAAK;AAFI,SAAb;AAIA,YAAI3B,cAAchC,QAAQ,aAAR,CAAlB;AACA,YAAI,KAAKL,WAAL,IAAoB,CAAxB,EAA2B;AACvBmC,mBAAOiB,IAAP,GAAc,OAAd;AACAjB,mBAAO6B,GAAP,GAAa3B,YAAY,KAAKtC,KAAjB,EAAwBiF,iBAArC;AACH,SAHD,MAIK,IAAI,KAAKhF,WAAL,IAAoB,CAAxB,EAA2B;AAC5B,gBAAIiF,OAAO5E,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BY,uBAAzC;AACA,gBAAID,QAAQ,CAAZ,EAAe;AACX9C,uBAAOiB,IAAP,GAAc,eAAd;AACAjB,uBAAO6B,GAAP,GAAa3B,YAAY,KAAKtC,KAAjB,EAAwBoF,iBAArC;AACH,aAHD,MAIK,IAAIF,QAAQ,CAAZ,EAAe;AAChB9C,uBAAOiB,IAAP,GAAc,OAAd;AACAjB,uBAAO6B,GAAP,GAAa3B,YAAY,KAAKtC,KAAjB,EAAwBiF,iBAArC;AACH;AACJ;;AAED,eAAO7C,MAAP;AACH,KA9OI;AAgPLiD,WAhPK,qBAgPK;AACN,YAAI,KAAKnF,UAAL,IAAmB,IAAnB,IAA2B,KAAKA,UAAL,CAAgB+D,GAAhB,IAAuB,CAAtD,EAAyD;AACrD;AACH;AACD,YAAIqB,WAAW,IAAf;AACA,YAAI,KAAKpF,UAAL,CAAgBmD,IAAhB,IAAwB,OAA5B,EAAqC;AACjCiC,uBAAWhF,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BgB,KAA9B,GAAsC,KAAKrF,UAAL,CAAgB+D,GAAjE;AACH,SAFD,MAGK,IAAI,KAAK/D,UAAL,CAAgBmD,IAAhB,IAAwB,eAA5B,EAA6C;AAC9CiC,uBAAWhF,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BiB,aAA9B,GAA8C,KAAKtF,UAAL,CAAgB+D,GAAzE;AACH;;AAED,YAAIqB,YAAY,IAAZ,IAAoBA,WAAW,CAAnC,EAAsC;AAClC,gBAAIG,mBAAmBnF,QAAQ,iBAAR,CAAvB;AACA,gBAAIoF,UAAU,EAAd;AACA,gBAAI,KAAKxF,UAAL,CAAgBmD,IAAhB,IAAwB,OAA5B,EAAqC;AACjCqC,0BAAU,MAAV;AACH,aAFD,MAGK,IAAI,KAAKxF,UAAL,CAAgBmD,IAAhB,IAAwB,eAA5B,EAA6C;AAC9CqC,0BAAU,MAAV;AACH;AACDD,6BAAiBE,QAAjB,CAA0BD,OAA1B;AACA;AACH;;AAGD,YAAIE,aAAatF,QAAQ,YAAR,CAAjB;AACA,YAAIuF,aAAaD,WAAWE,cAAX,CAA0B,YAA1B,EAAuC,kBAAvC,CAAjB;AACAD,mBAAWE,OAAX,CAAmBC,QAAnB,GAA8B1F,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8B0B,EAA5D;AACA,YAAIC,aAAa,IAAjB;AACA,YAAI,KAAKhG,UAAL,CAAgBmD,IAAhB,IAAwB,OAA5B,EAAqC;AACjC6C,yBAAa;AACT,yBAAS5F,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BgB,KAA9B,GAAsC,KAAKrF,UAAL,CAAgB+D;AADtD,aAAb;AAGH,SAJD,MAMK,IAAI,KAAK/D,UAAL,CAAgBmD,IAAhB,IAAwB,eAA5B,EAA6C;AAC9C6C,yBAAa;AACT,iCAAiB5F,QAAQ,SAAR,EAAmBiE,UAAnB,CAA8BiB,aAA9B,GAA8C,KAAKtF,UAAL,CAAgB+D;AADtE,aAAb;AAGH;;AAED4B,mBAAWE,OAAX,CAAmBG,UAAnB,GAAgCA,UAAhC;AACA,YAAIpF,OAAO,IAAX;AACA+E,mBAAWM,eAAX,GAA6B,YAAU;AACnC,gBAAIrF,KAAKZ,UAAL,CAAgBmD,IAAhB,IAAwB,OAA5B,EAAqC;AACjC/C,wBAAQ,SAAR,EAAmBiE,UAAnB,CAA8BgB,KAA9B,GAAsCW,WAAWX,KAAjD;AACH,aAFD,MAGK,IAAIzE,KAAKZ,UAAL,CAAgBmD,IAAhB,IAAwB,eAA5B,EAA6C;AAC9C/C,wBAAQ,SAAR,EAAmBiE,UAAnB,CAA8BiB,aAA9B,GAA8CU,WAAWV,aAAzD;AACH;;AAED;AACAlF,oBAAQ,SAAR,EAAmB8F,eAAnB,CAAmCtF,KAAKd,KAAxC;AACH,SAVD;;AAYA,aAAKR,kBAAL,CAAwB0B,YAAxB,CAAqCtC,GAAGyH,MAAxC,EAAgDC,YAAhD,GAA+D,KAA/D;AACAV,mBAAWW,mBAAX,CAA+BV,UAA/B;AACH;AACD;;AA3SK,CAAT","file":"preChallengeUIMgr.js","sourceRoot":"../../../../../assets/scripts/mainScene","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        headerDis: 83,\n        footerDis: 124,\n        sectionDis: 66,\n        contentSpace: 99,\n        mailSectionElementDis: 30,\n\n        titleLabelNode: cc.Node,\n        challengeButtonNoe: cc.Node,\n        contentSectionNode: cc.Node,\n        mailSectionNode: cc.Node,\n        closeButtonNode: cc.Node,\n        mailSectionElementPrefab: cc.Prefab,\n        challengeButtonCostPhySprite: cc.SpriteFrame,\n\n        level: null,\n        levelStatus: null,\n        costResult: null,\n        delegate: null\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var textConfig = require(\"textConfig\")\n        var bg = this.node.getChildByName(\"bg\")\n        bg.width = cc.winSize.width\n        bg.height = cc.winSize.height\n        bg.on(\"touchstart\",function(){},this)\n\n        var self = this\n        this.closeButtonNode.on(\"click\",function(){\n            if (self.delegate != null) {\n                self.delegate.preChanllengeUIOpend = false\n            }\n            else {\n                cc.log(\"delegate is null\")\n            }\n            self.node.destroy()     \n        },this)\n\n        this.challengeButtonNoe.getChildByName(\"New Label\").getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(151)\n    },\n\n    start () {\n        this.setupUI()\n    },\n\n    getSectionAndIndexOfLevel() {\n        var mainSceneMgr = cc.director.getScene().getChildByName(\"Canvas\").getComponent(\"mainSceneMgr\")\n        var section = mainSceneMgr.selectedSection\n        var sectionConfig = require(\"sectionConfig\")\n        var levels = sectionConfig[section].levels\n        var index = levels.indexOf(this.level) + 1\n        return [section, index]\n    },\n\n    setupUI() {\n        this._setupUIContent()\n        this._setupUIPosition()\n    },\n\n    _setupUIContent() {\n        //title label\n        var result = this.getSectionAndIndexOfLevel()\n        this.titleLabelNode.getComponent(cc.Label).string = result[0].toString() + \" - \" + result[1]\n        \n        //content section\n        var levelConfig = require(\"levelConfig\")\n        var config = levelConfig[this.level]\n        var desLabelNode = this.contentSectionNode.getChildByName(\"desLabel\")\n        desLabelNode.getComponent(cc.Label).string = require(\"textConfig\").getTextByIdAndLanguageType(config.desTextId)\n        desLabelNode.getComponent(cc.Label)._forceUpdateRenderData()\n\n        var seperateLineUpNode = this.contentSectionNode.getChildByName(\"seperateLineUp\")\n        var seperateLineDownNode = this.contentSectionNode.getChildByName(\"seperateLineDown\")\n        var contentHeight = desLabelNode.height + 2 * this.contentSpace + seperateLineUpNode.height + seperateLineDownNode.height\n        this.contentSectionNode.height = contentHeight\n\n        seperateLineUpNode.y = 0\n        desLabelNode.y = seperateLineUpNode.y - seperateLineUpNode.height - this.contentSpace\n        seperateLineDownNode.y = -contentHeight + seperateLineDownNode.height\n\n        //mailSection\n        var textConfig = require(\"textConfig\")\n        var result = this._getMailSectionInfo()\n        var mailSectionHeight = 0\n        for (var index in result) {\n            var oneConfig = result[index]\n            var node = cc.instantiate(this.mailSectionElementPrefab)\n            var desLabel = node.getChildByName(\"desLabel\")\n            \n            var textStr = \"\"\n            if (oneConfig.type == 1) {\n                // textStr = \"通关后会收到 \" + oneConfig.tag + \" 分支的新邮件\"\n                textStr = textConfig.getFormatedString(149,[oneConfig.tag])\n            }\n            else if (oneConfig.type == 2) {\n                // textStr = \"用不多于 \" + oneConfig.minStep + \" 步通关，会收到 \" + oneConfig.tag + \" 分支的新邮件\"\n                textStr = textConfig.getFormatedString(150,[oneConfig.minStep,oneConfig.tag])\n            }\n            desLabel.getComponent(cc.Label).string = textStr\n            desLabel.getComponent(cc.Label)._forceUpdateRenderData()\n            \n            var completeIcon = node.getChildByName(\"completeIcon\")\n            if (oneConfig.status == true) {\n                completeIcon.active = true\n            }\n\n            if (desLabel.height > completeIcon.height) {\n                node.height = desLabel.height\n            }\n            else {\n                node.height = completeIcon.height\n            }\n\n            node.y = mailSectionHeight\n            mailSectionHeight += node.height\n            if (index != result.length - 1) {\n                mailSectionHeight += this.mailSectionElementDis\n            }\n            this.mailSectionNode.addChild(node)\n        }\n        this.mailSectionNode.height = mailSectionHeight\n\n        //challengeButton\n        var costResult = this._getCostInfoOfChallenge()\n        if (costResult.type == \"physicalPower\") {\n            this.challengeButtonNoe.getChildByName(\"costIcon\").getComponent(cc.Sprite).spriteFrame = this.challengeButtonCostPhySprite\n        }\n        \n        this.challengeButtonNoe.getChildByName(\"costLabel\").getComponent(cc.Label).string = costResult.num.toString()\n        this.costResult = costResult\n    },\n    _setupUIPosition() {\n        var totalHeight = this.footerDis + this.titleLabelNode.height + this.sectionDis + this.contentSectionNode.height + this.sectionDis + this.mailSectionNode.height + this.sectionDis + this.challengeButtonNoe.height + this.footerDis\n        var uibg = this.node.getChildByName(\"others\").getChildByName(\"uiBg\")\n        uibg.height = totalHeight\n\n        this.titleLabelNode.y = uibg.height / 2 - this.headerDis\n        this.contentSectionNode.y = this.titleLabelNode.y - this.titleLabelNode.height - this.sectionDis\n        this.mailSectionNode.y = this.contentSectionNode.y - this.contentSectionNode.height - this.sectionDis\n        this.challengeButtonNoe.y = this.mailSectionNode.y - this.mailSectionNode.height - this.sectionDis - this.challengeButtonNoe.height / 2\n    },\n\n    _getMailSectionInfo() {\n        var mailSysConfig = require(\"mailSysConfig\")\n        var result = []\n        var textConfig = require(\"textConfig\")\n        for (var tag in mailSysConfig) {\n            var oneConfig = mailSysConfig[tag]\n            var conditions = oneConfig.conditions\n            var currentConditionIndex = require(\"dataMgr\").playerData.mailConditionIndex[tag]\n            for (var index in conditions) {\n                var oneConditionConfig = conditions[index]\n                var conditionType = oneConditionConfig.conditionType\n                var conditionPara = oneConditionConfig.conditionPara\n                \n                // if (conditionPara == this.level) {\n                //     var oneResult = {\n                //         tag: oneConfig.tagName,\n                //         status: null\n                //     }\n                    \n                // }\n                var oneResult = null\n                if ((conditionType == 1 && conditionPara == this.level) || (conditionType == 2 && conditionPara.levelId == this.level)) {\n                    oneResult = {\n                        // tag: oneConfig.tagNameTextId,\n                        tag: textConfig.getTextByIdAndLanguageType(oneConfig.tagNameTextId),\n                        type: conditionType,\n                        status: null,\n                        minStep: null\n                    }\n                }\n                if (oneResult == null) {\n                    continue\n                }\n\n                if (index < currentConditionIndex) {\n                    oneResult.status = true\n                }\n                else {\n                    oneResult.status = false\n                }\n\n                if (conditionType == 2) {\n                    oneResult.minStep = conditionPara.minStepNum\n                }\n                result.push(oneResult)\n                break\n            }\n        }\n\n        return result\n    },\n\n    _getCostInfoOfChallenge() {\n        var result = {\n            type: \"physicalPower\",\n            num: 0\n        }\n        var levelConfig = require(\"levelConfig\")\n        if (this.levelStatus == 1) {\n            result.type = \"heart\"\n            result.num = levelConfig[this.level].heartForRetryCost\n        }\n        else if (this.levelStatus == 2) {\n            var flag = require(\"dataMgr\").playerData.physicalPowerCostedFlag\n            if (flag == 0) {\n                result.type = \"physicalPower\"\n                result.num = levelConfig[this.level].physicalPowerCost\n            }\n            else if (flag == 1) {\n                result.type = \"heart\"\n                result.num = levelConfig[this.level].heartForRetryCost\n            }\n        }\n\n        return result\n    },\n\n    onClick() {\n        if (this.costResult == null || this.costResult.num == 0) {\n            return\n        }\n        var valueNum = null\n        if (this.costResult.type == \"heart\") {\n            valueNum = require(\"dataMgr\").playerData.heart - this.costResult.num\n        }\n        else if (this.costResult.type == \"physicalPower\") {\n            valueNum = require(\"dataMgr\").playerData.physicalPower - this.costResult.num\n        }\n\n        if (valueNum == null || valueNum < 0) {\n            var notificaitionSys = require(\"notificationMgr\")\n            var notiStr = \"\"\n            if (this.costResult.type == \"heart\") {\n                notiStr = \"金币不足\"\n            }\n            else if (this.costResult.type == \"physicalPower\") {\n                notiStr = \"体力不足\"\n            }\n            notificaitionSys.showNoti(notiStr)\n            return\n        }\n        \n        \n        var networkMgr = require(\"networkMgr\")\n        var messageObj = networkMgr.makeMessageObj(\"dataModule\",\"commitMessageTyp\")\n        messageObj.message.playerId = require(\"dataMgr\").playerData.id\n        var commitBody = null\n        if (this.costResult.type == \"heart\") {\n            commitBody = {\n                \"heart\": require(\"dataMgr\").playerData.heart - this.costResult.num\n            }\n        }\n\n        else if (this.costResult.type == \"physicalPower\") {\n            commitBody = {\n                \"physicalPower\": require(\"dataMgr\").playerData.physicalPower - this.costResult.num\n            }\n        }\n\n        messageObj.message.commitBody = commitBody\n        var self = this\n        messageObj.successCallBack = function(){\n            if (self.costResult.type == \"heart\") {\n                require(\"dataMgr\").playerData.heart = commitBody.heart\n            }\n            else if (self.costResult.type == \"physicalPower\") {\n                require(\"dataMgr\").playerData.physicalPower = commitBody.physicalPower\n            }\n            \n            // self.challengeButtonNoe.getComponent(cc.Button).interactable = true\n            require(\"gameMgr\").enterLevelScene(self.level)\n        }\n\n        this.challengeButtonNoe.getComponent(cc.Button).interactable = false\n        networkMgr.sendMessageByMsgObj(messageObj)\n    }\n    // update (dt) {},\n});\n"]}