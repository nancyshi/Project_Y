{"version":3,"sources":["assets/scripts/systems/systemsMgr.js"],"names":["SystemsMgr","cc","Class","Component","properties","welfarySys","get","_welfarySys","setupSysProperty","systems","signInSys","_signInSys","addPropertyNumSys","_addPropertyNumSys","mailSys","_mailSys","selectSectionSys","_selectSectionSys","storySys","_storySys","_systems","givenPrefabName","givenName","givenMgrName","givenSysProperty","uiPrefab","require","reses","opendNode","name","mgrName","showSystem","givenSysName","para","type","givenSys","getSysBySysName","log","ui","instantiate","mgr","getComponent","onWillOpend","director","getScene","getChildByName","addChild","others","bg","width","winSize","height","on","scale","tween","to","start","closeSystem","call","destroy","coverNode","opacity","delay","systemsGloableDataMonitored","key","value","mailSysGloableMonitored","textConfig","onReachCondition","givenTag","givenMailId","networkMgr","messageObj","makeMessageObj","message","playerId","playerData","id","tag","mailId","successCallBack","xhr","response","responseText","JSON","parse","isEnd","mailConditionIndex","newMail","mail","mails","notificaitionMgr","notiStr","getTextByIdAndLanguageType","pushNoti","sendMessageByMsgObj","mailSysConfig","tags","Object","keys","index","oneTag","conditionIndex","element","conditions","conditionType","conditionPara","indexOf","levelId","slice","parseInt","minStepNum","mailSysGloableSendOneMail","complete","systemsMgr","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\n\n//a typical system will have an ui , which will be created by a prefab\n//other system will not be contained by here, such as notificaition system\nvar SystemsMgr = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        welfarySys: {\n            get() {\n                if (this._welfarySys == null) {\n                    this._welfarySys = this.setupSysProperty(\"welfarySysPrefab\",\"welfarySys\",\"welfarySysMgr\")\n                    this.systems[\"welfarySys\"] = this._welfarySys\n                }\n                return this._welfarySys\n            }\n        },\n        signInSys: {\n            get() {\n                if (this._signInSys == null) {\n                    this._signInSys = this.setupSysProperty(\"signInSysPrefab\", \"signInSys\",\"signInSysMgr\")\n                    this.systems[\"signInSys\"] = this._signInSys\n                }\n                return this._signInSys\n            }\n        },\n\n        addPropertyNumSys: {\n            get() {\n                if (this._addPropertyNumSys == null) {\n                    this._addPropertyNumSys = this.setupSysProperty(\"addPropertyNumSysPrefab\",\"addPropertyNumSys\",\"addPropertyNumSysMgr\")\n                    this.systems[\"addPropertyNumSys\"] = this._addPropertyNumSys\n                }\n                return this._addPropertyNumSys\n            }\n        },\n\n        mailSys: {\n            get() {\n                if (this._mailSys == null) {\n                    this._mailSys = this.setupSysProperty(\"mailSysPrefab\",\"mailSys\",\"mailSysMgr\")\n                    this.systems[\"mailSys\"] = this._mailSys\n                }\n                return this._mailSys\n            }\n        },\n        \n        selectSectionSys: {\n            get() {\n                if (this._selectSectionSys == null) {\n                    this._selectSectionSys = this.setupSysProperty(\"selectSectionSysPrefab\",\"selectSectionSys\",\"selectSectionUIMgr\")\n                    this.systems[\"selectSectionSys\"] = this._selectSectionSys\n                }\n                return this._selectSectionSys\n            }\n        },\n        storySys: {\n            get() {\n                if (this._storySys == null) {\n                    this._storySys = this.setupSysProperty(\"storySysPrefab\",\"storySys\",\"storySysMgr\")\n                    this.systems[\"storySys\"] = this._storySys\n                }\n                return this._storySys\n            }\n        },\n\n        systems: {\n            get() {\n                if (this._systems == null) {\n                    this._systems = {}\n                }\n                return this._systems\n            }\n        }\n    },\n\n    setupSysProperty(givenPrefabName, givenName, givenMgrName) {\n        var givenSysProperty = {}\n        givenSysProperty.uiPrefab = require(\"resMgr\").reses[givenPrefabName]\n        givenSysProperty.opendNode = null\n        givenSysProperty.name = givenName\n        givenSysProperty.mgrName = givenMgrName\n        return givenSysProperty\n    },\n\n    showSystem(givenSysName, para = null, type = 1) {\n        //type 1 = animated open , 2 = direct open\n        var givenSys = this.getSysBySysName(givenSysName)\n        if (givenSys.opendNode != null) {\n            cc.log(\"this sys has been opend , can't reopen: \" + givenSys.name)\n            return\n        }\n        var ui = cc.instantiate(givenSys.uiPrefab)\n        var mgrName = this.systems[givenSys.name].mgrName\n        var mgr = ui.getComponent(mgrName)\n        if (mgr != null && typeof mgr.onWillOpend === \"function\") {\n            mgr.onWillOpend(para)\n        }\n        if (type == 2) {\n            cc.director.getScene().getChildByName(\"Canvas\").addChild(ui)\n            givenSys.opendNode = ui\n            return\n        }\n        var others = ui.getChildByName(\"others\")\n        var bg = ui.getChildByName(\"bg\")\n        if (bg != null) {\n            bg.width = cc.winSize.width\n            bg.height = cc.winSize.height\n            bg.on(\"touchstart\",function(){})\n        }\n        cc.director.getScene().getChildByName(\"Canvas\").addChild(ui)\n        givenSys.opendNode = ui\n        if (others != null) {\n            others.scale = 0\n            cc.tween(others)\n                .to(0.3,{scale: 1})\n                .start()\n        }\n        else {\n            ui.scale = 0\n            cc.tween(ui)\n                .to(0.3,{scale: 1})\n                .start()\n        }\n    },\n\n    closeSystem(givenSysName, type = 1) {\n        //1 = animated close , 2 = direct close, 3 = fade out\n        var givenSys = this.getSysBySysName(givenSysName)\n        var opendNode = givenSys.opendNode\n        if (opendNode == null) {\n            cc.log(givenSys.name + \"has not been opend, no need to colse\")\n            return\n        }\n        if (type == 1) {\n            var others = opendNode.getChildByName(\"others\")\n            if (others != null) {\n                cc.tween(others)\n                    .to(0.3, {scale: 0})\n                    .call(function(){\n                        opendNode.destroy()\n                        givenSys.opendNode = null\n                    })\n                    .start()\n            }\n            else {\n                cc.tween(opendNode)\n                    .to(0.3, {scale: 0})\n                    .call(function(){\n                        opendNode.destroy()\n                        givenSys.opendNode = null\n                    })\n            }\n        }\n\n        else if (type == 2) {\n            opendNode.destroy()\n            givenSys.opendNode = null\n        }\n\n        else if (type == 3) {\n            var coverNode = require(\"resMgr\").reses[\"coverNodePrefab\"]\n            coverNode = cc.instantiate(coverNode)\n            coverNode.width = opendNode.width\n            coverNode.height = opendNode.height\n            coverNode.opacity = 0\n            coverNode.on(\"touchstart\",function(){})\n\n            opendNode.addChild(coverNode)\n            cc.tween(coverNode)\n                .to(0.5,{opacity: 255})\n                .delay(0.5)\n                .call(function(){\n                    opendNode.destroy()\n                    givenSys.opendNode = null\n                })\n                .start()\n        }\n        \n    },\n\n    getSysBySysName(givenSysName) {\n        switch(givenSysName){\n            case \"welfarySys\" :\n                return this.welfarySys\n            case \"signInSys\":\n                return this.signInSys\n            case \"addPropertyNumSys\":\n                return this.addPropertyNumSys\n            case \"mailSys\":\n                return this.mailSys\n            case \"selectSectionSys\":\n                return this.selectSectionSys\n            case \"storySys\":\n                return this.storySys\n            default:\n                cc.log(\"no such sys\")\n                return false\n        }\n    },\n\n    systemsGloableDataMonitored(key,value) {\n        //mailSys\n            //monitored whether reach mail condition\n        this.mailSysGloableMonitored(key,value)\n    },\n\n\n    mailSysGloableMonitored(key,value) {\n        var textConfig = require(\"textConfig\")\n        var onReachCondition = function(givenTag,givenMailId) {\n            var networkMgr = require(\"networkMgr\")\n            var messageObj = networkMgr.makeMessageObj(\"mailModule\",\"reachConditionMessageType\")\n            messageObj.message.playerId = require(\"dataMgr\").playerData.id\n            messageObj.message.tag = givenTag\n            messageObj.message.mailId = givenMailId\n            messageObj.successCallBack = function(xhr) {\n                var response = xhr.responseText\n                response = JSON.parse(response)\n                if (response.type == \"success\") {\n                    var isEnd = response.isEnd\n                    if (isEnd == 0) {\n                        require(\"dataMgr\").playerData.mailConditionIndex[givenTag] += 1\n                    }\n                    else {\n                        require(\"dataMgr\").playerData.mailConditionIndex[givenTag] = -1\n                    }\n                    var newMail = response.mail\n                    require(\"dataMgr\").playerData.mails[givenMailId] = newMail\n                    var notificaitionMgr = require(\"notificationMgr\")\n                    var notiStr = textConfig.getTextByIdAndLanguageType(148)\n                    notificaitionMgr.pushNoti(notiStr)\n                }\n            }\n            networkMgr.sendMessageByMsgObj(messageObj)\n        }\n        var mailSysConfig = require(\"mailSysConfig\")\n        var tags = Object.keys(mailSysConfig)\n        for (var index in tags) {\n            var oneTag = tags[index]\n            var conditionIndex = require(\"dataMgr\").playerData.mailConditionIndex[oneTag]\n            if (conditionIndex == -1) {\n                continue\n            }\n            var element = mailSysConfig[oneTag].conditions[conditionIndex]\n            var conditionType = element.conditionType\n            var conditionPara = element.conditionPara\n\n            if (conditionType == 1) {\n                //reach given level id\n                if (key != \"preLevel\") {\n                    continue\n                }\n                \n                if (value == conditionPara) {\n                    var mailId = element.mailId\n                    onReachCondition(oneTag,mailId)\n                }\n                \n            }\n            else if (conditionType == 2) {\n                //min step num of given level less than a value\n                if (key.indexOf(\"minStep_level_\") == -1) {\n                    continue\n                }\n\n                var levelId = key.slice(14)\n                if (parseInt(levelId) == conditionPara.levelId){\n                    if (value <= conditionPara.minStepNum) {\n                        var mailId = element.mailId\n                        onReachCondition(oneTag,mailId)\n                    }\n                }\n            }\n        }\n    },\n\n    mailSysGloableSendOneMail(givenMailId,givenTag,complete = function(){},delay = 0) {\n        var networkMgr = require(\"networkMgr\")\n        var messageObj = networkMgr.makeMessageObj(\"mailModule\",\"sendMailMessageType\")\n        messageObj.message.playerId = require(\"dataMgr\").playerData.id\n        messageObj.message.mailId = givenMailId\n        messageObj.message.tag = givenTag\n        messageObj.message.delay = delay\n        messageObj.successCallBack = function(xhr) {\n            var response = xhr.responseText\n            response = JSON.parse(response)\n            if (response.type == \"success\") {\n                complete()\n            }\n        }\n        networkMgr.sendMessageByMsgObj(messageObj)\n    },\n\n    // getSectionLevelInfoByLevelId(givenLevelId) {\n    //     var result = null\n    //     var sectionConfig = require(\"sectionConfig\")\n    //     for (var key in sectionConfig) {\n    //         var oneConfig = sectionConfig[key]\n    //         var levels = oneConfig.levels\n    //         for (var index in levels) {\n    //             if (givenLevelId == levels[index]) {\n    //                 var currentLevel = givenLevelId\n                    \n    //             }\n    //         }\n    //     }\n    //     return result\n    // }\n    // update (dt) {},\n});\n\nvar systemsMgr = new SystemsMgr()\nmodule.exports = systemsMgr"]}