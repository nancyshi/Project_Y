{"version":3,"sources":["assets/scripts/systems/mailSys/mailSysMailMgr.js"],"names":["cc","Class","Component","properties","mailId","relatedMailSectionNode","Node","relatedMailSysMgr","mailOptionNodePrefab","Prefab","disOfContentAndOptionSection","disOfOptionNodes","headerHeight","footerHeight","onLoad","bg","node","getChildByName","width","winSize","height","on","setupContentSection","setupOptionSection","setupUiBg","start","close","destroy","textConfig","require","mailConfig","mail","content","titleLabel","contentLabel","getComponent","Label","string","getTextByIdAndLanguageType","titleTextId","contentTextId","y","optionSection","options","playerData","mails","status","length","okOptionNode","instantiate","okLabelNode","okBgNode","self","onMailReaded","setOneMailReaded","addChild","index","oneOption","optionNode","labelNode","showTextId","bgNode","operationType","operationPara","bindFunction","givenNode","givenOperationType","givenOperationPara","indexOfOptions","mailSysGloableSendOneMail","tag","delay","selectedOptionIndex","selectedOption","color","active","Button","interactable","uibg","contentSection"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        mailId: null,\n        relatedMailSectionNode: cc.Node,\n        relatedMailSysMgr: null,\n        mailOptionNodePrefab: cc.Prefab,\n        disOfContentAndOptionSection: 200,\n        disOfOptionNodes: 25,\n        headerHeight: 82,\n        footerHeight: 80\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var bg = this.node.getChildByName(\"bg\")\n        bg.width = cc.winSize.width\n        bg.height = cc.winSize.height\n        bg.on(\"touchstart\",function(){})\n\n        this.setupContentSection()\n        this.setupOptionSection()\n        this.setupUiBg()\n    },\n\n    start () {\n\n    },\n\n    close() {\n        this.node.destroy()\n    },\n\n    setupContentSection() {\n        var textConfig = require(\"textConfig\")\n        var mailConfig = require(\"mailConfig\")\n        var mail = mailConfig[this.mailId]\n        var content = this.node.getChildByName(\"others\").getChildByName(\"contentSection\").getChildByName(\"view\").getChildByName(\"content\")\n        var titleLabel = content.getChildByName(\"titleLabel\")\n        var contentLabel = content.getChildByName(\"contentLabel\")\n\n        // titleLabel.getComponent(cc.Label).string = mail.title\n        // contentLabel.getComponent(cc.Label).string = mail.content\n        titleLabel.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(mail.titleTextId)\n        contentLabel.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(mail.contentTextId)\n        content.height = -contentLabel.y + contentLabel.height\n    },\n\n    setupOptionSection() {\n        var textConfig = require(\"textConfig\")\n        var optionSection = this.node.getChildByName(\"others\").getChildByName(\"optionSection\")\n        var mailConfig = require(\"mailConfig\")\n        var mail = mailConfig[this.mailId]\n        var options = mail.options\n        mail = require(\"dataMgr\").playerData.mails[this.mailId]\n        if (mail.status == 0) {\n            //unreaded mail\n            if (options.length == 0) {\n                var okOptionNode = cc.instantiate(this.mailOptionNodePrefab)\n                var okLabelNode = okOptionNode.getChildByName(\"label\")\n                okLabelNode.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(147)\n                var okBgNode = okOptionNode.getChildByName(\"bg\")\n                okOptionNode.width = okBgNode.width\n                okOptionNode.height = okBgNode.height\n                optionSection.height += okOptionNode.height\n                var self = this\n                okOptionNode.on(\"click\",function(){\n                    var onMailReaded = function() {\n                        self.close()\n                    }\n                    self.relatedMailSysMgr.setOneMailReaded(self.mailId, -1, onMailReaded,self.relatedMailSectionNode)\n                })\n                okOptionNode.y = -(optionSection.height - okOptionNode.height)\n                optionSection.addChild(okOptionNode)\n                return\n            }\n\n            for (var index in options) {\n                var oneOption = options[index]\n                var optionNode = cc.instantiate(this.mailOptionNodePrefab)\n                var labelNode = optionNode.getChildByName(\"label\")\n                // labelNode.getComponent(cc.Label).string = oneOption.showText\n                labelNode.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(oneOption.showTextId)\n                \n                var bgNode = optionNode.getChildByName(\"bg\")\n                bgNode.height = labelNode.height\n\n                optionNode.width = bgNode.width\n                optionNode.height = bgNode.height\n\n                if (index == 0) {\n                    optionSection.height += optionNode.height\n                }\n                else {\n                    optionSection.height += optionNode.height + this.disOfOptionNodes\n                }\n\n                optionNode.y = -(optionSection.height - optionNode.height)\n                var operationType = oneOption.operationType\n                var operationPara = oneOption.operationPara\n                var self = this\n                var bindFunction = function(givenNode,givenOperationType,givenOperationPara,indexOfOptions) {\n                    givenNode.on(\"click\",function(){\n                        //no matter what option be selected, this mail will be readed\n                        var onMailReaded = function() {\n                            if (givenOperationType == 1) {\n                                self.close()\n                            }\n                            else if (givenOperationType == 2) {\n                                // mailSys.sendOneMail(givenOperationPara.mailId, mail.tag, givenOperationPara.delay)\n                                require(\"systemsMgr\").mailSysGloableSendOneMail(givenOperationPara.mailId,mail.tag, function(){},givenOperationPara.delay)\n                                self.close()\n                            }\n                        }\n                        self.relatedMailSysMgr.setOneMailReaded(self.mailId,indexOfOptions,onMailReaded,self.relatedMailSectionNode)\n                    })\n                }\n                bindFunction(optionNode, operationType, operationPara, index)\n                optionSection.addChild(optionNode)\n            }\n        }\n\n        else if (mail.status == 1) {\n            //readed mail\n            if (mail.selectedOptionIndex != -1) {\n                var selectedOptionIndex = mail.selectedOptionIndex\n                var selectedOption = options[selectedOptionIndex]\n\n                var optionNode = cc.instantiate(this.mailOptionNodePrefab)\n                var labelNode = optionNode.getChildByName(\"label\")\n                // labelNode.getComponent(cc.Label).string = selectedOption.showText\n                labelNode.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(selectedOption.showTextId)\n                \n                labelNode.color = cc.color(255,255,255)\n                var bgNode = optionNode.getChildByName(\"bg_readed\")\n                bgNode.active = true\n                bgNode.height = labelNode.height\n\n                optionNode.width = bgNode.width\n                optionNode.height = bgNode.height\n                optionSection.height += optionNode.height\n                optionNode.getComponent(cc.Button).interactable = false\n                optionNode.y = -(optionSection.height - optionNode.height)\n                optionSection.addChild(optionNode)\n\n                var okOptionNode = cc.instantiate(this.mailOptionNodePrefab)\n                var okLabelNode = okOptionNode.getChildByName(\"label\")\n                okLabelNode.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(147)\n                var okBgNode = okOptionNode.getChildByName(\"bg\")\n                okOptionNode.width = okBgNode.width\n                okOptionNode.height = okBgNode.height\n                optionSection.height += okOptionNode.height + this.disOfOptionNodes\n                var self = this\n                okOptionNode.on(\"click\",function(){\n                    self.close()\n                })\n                okOptionNode.y = -(optionSection.height - okOptionNode.height)\n                optionSection.addChild(okOptionNode)\n            }\n\n            else {\n                var okOptionNode = cc.instantiate(this.mailOptionNodePrefab)\n                var okLabelNode = okOptionNode.getChildByName(\"label\")\n                okLabelNode.getComponent(cc.Label).string = textConfig.getTextByIdAndLanguageType(147)\n                var okBgNode = okOptionNode.getChildByName(\"bg\")\n                okOptionNode.width = okBgNode.width\n                okOptionNode.height = okBgNode.height\n                optionSection.height += okOptionNode.height\n                var self = this\n                okOptionNode.on(\"click\",function(){\n                    self.close()\n                })\n                okOptionNode.y = -(optionSection.height - okOptionNode.height)\n                optionSection.addChild(okOptionNode)\n            }\n        }\n        \n    },\n\n    setupUiBg() {\n        var uibg = this.node.getChildByName(\"others\").getChildByName(\"uibg\")\n        var contentSection = this.node.getChildByName(\"others\").getChildByName(\"contentSection\")\n        var optionSection = this.node.getChildByName(\"others\").getChildByName(\"optionSection\")\n\n        uibg.height = this.headerHeight + contentSection.height + this.disOfContentAndOptionSection + optionSection.height + this.footerHeight\n        contentSection.y = uibg.height/2 - this.headerHeight\n        optionSection.y = contentSection.y - contentSection.height - this.disOfContentAndOptionSection\n    }\n    // update (dt) {},\n});\n"]}