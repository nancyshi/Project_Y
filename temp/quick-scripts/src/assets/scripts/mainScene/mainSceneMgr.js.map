{"version":3,"sources":["assets/scripts/mainScene/mainSceneMgr.js"],"names":["cc","Class","Component","properties","sectionNameLabelNode","Node","levelNodes","connectLineNodes","levelNodePrefab","Prefab","levelNodesConnectLinePrefab","selectedSection","physicalLabelNode","heartLabelNode","mailSysButtonNode","signInSysButtonNode","welfarySysButtonNode","addHeartButtonNode","addPhysicalPowerButtonNode","selectSectionButtonNode","backToCurrentButtonNode","levelNodeStartPosition","v2","levelNodesHorDis","levelNodesVerDis","levelNodesNumPerLine","rotaedCopiedRadius","isShowingNoti","canShowNoti","onLoad","setupData","start","setupUI","storyId","require","playerData","storySysId","showSystem","playBgm","self","path","bgmPath","loader","loadRes","err","res","audioEngine","stopAll","play","getComponent","Widget","updateAlignment","Label","string","heart","toString","physicalPower","systemsMgr","on","redPointShowCondition","mails","unReadNum","key","oneMail","status","signInStatus","flag","initAdWatchedFlag","active","tween","repeatForever","to","angle","delay","opacity","getTextByIdAndLanguageType","currentSection","setupSectionPerformance","y","height","log","textConfig","destroyAllChildren","removeAllChildren","sectionConfig","config","sectionTitle","sectionTitleTextId","sectionDes","sectionDescripTextId","showText","_forceUpdateRenderData","x","width","levels","index","oneLevel","oneLevelNode","instantiate","mgr","level","levelNumLabelNode","parseInt","_checkLevelStatus","delegate","_setupLevelNodePosition","addChild","children","oneNode","preNode","connectLine","v","mag","degree","signAngle","Math","PI","result","_getMidPointOfTwoPoints","position","givenNode","givenIndex","levelNodePositions","length","nodesNum","baseVector","rotate","point1","point2","_checkSectionStatus","givenSection","givneLevel","sectionKey","_getSectionKeyByLevel","sectionStatus","currentLevel","levelsArry","indexOf","givenLevel","levelId","oneConfig","levelsConfig","dataMonitored","value","oneMgr","update","dt","notificationMgr","notiArry","noties","temp","oneStr","showNoti","splice","node","call"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        sectionNameLabelNode: cc.Node,\n        levelNodes: cc.Node,\n        connectLineNodes: cc.Node,\n        levelNodePrefab: cc.Prefab,\n        levelNodesConnectLinePrefab: cc.Prefab,\n        selectedSection: null,\n        physicalLabelNode: cc.Node,\n        heartLabelNode: cc.Node,\n        mailSysButtonNode: cc.Node,\n        signInSysButtonNode: cc.Node,\n        welfarySysButtonNode: cc.Node,\n        addHeartButtonNode: cc.Node,\n        addPhysicalPowerButtonNode: cc.Node,\n        selectSectionButtonNode: cc.Node,\n        backToCurrentButtonNode: cc.Node,\n        levelNodeStartPosition: cc.v2(0,0),\n        levelNodesHorDis: 10,\n        levelNodesVerDis: 20,\n        levelNodesNumPerLine: 4,\n\n        rotaedCopiedRadius: 300,\n        isShowingNoti: false,\n        canShowNoti: true\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.setupData()\n        //this.setupUI()\n        //require(\"gameMgr\")._generateLevelSceneConfig()\n    },\n\n    start () {\n        this.setupUI()\n        //require(\"systemsMgr\").showSystem(\"storySys\",9001,2)\n        var storyId = require(\"dataMgr\").playerData.storySysId\n        if (storyId != -1) {\n            require(\"systemsMgr\").showSystem(\"storySys\",storyId,2)\n        }\n        this.playBgm()\n        //test\n        //require(\"advertisMgr\").showActivityNode()\n    },\n    playBgm(){\n        var self = this\n        var path = require(\"sectionConfig\")[this.selectedSection].bgmPath\n        cc.loader.loadRes(path,function(err,res){\n            cc.audioEngine.stopAll()\n            cc.audioEngine.play(res,true,1)\n        })\n    },\n    setupUI() {\n        this.sectionNameLabelNode.getComponent(cc.Widget).updateAlignment()\n        this.heartLabelNode.getComponent(cc.Label).string = require(\"dataMgr\").playerData.heart.toString()\n        this.physicalLabelNode.getComponent(cc.Label).string = require(\"dataMgr\").playerData.physicalPower.toString()\n        var systemsMgr = require(\"systemsMgr\")\n        this.mailSysButtonNode.on(\"click\",function(){\n            systemsMgr.showSystem(\"mailSys\",null,1,2)\n        })\n        this.mailSysButtonNode.getComponent(\"redPointMgr\").redPointShowCondition = function() {\n            var mails = require(\"dataMgr\").playerData.mails\n            var unReadNum = 0\n            for (var key in mails) {\n                var oneMail = mails[key]\n                if (oneMail.status == 0) {\n                    unReadNum += 1\n                }\n            }\n            if (unReadNum > 0) {\n                return true\n            }\n            else {\n                return false\n            }\n        }\n\n\n        this.signInSysButtonNode.on(\"click\",function(){\n            systemsMgr.showSystem(\"signInSys\")\n        })\n        this.signInSysButtonNode.getComponent(\"redPointMgr\").redPointShowCondition = function() {\n            var signInStatus = require(\"dataMgr\").playerData.signInStatus\n            switch(signInStatus) {\n                case 1:\n                    return true\n                case 2:\n                    return true\n                default:\n                    return false\n            }\n        }\n\n        this.addPhysicalPowerButtonNode.on(\"click\",function(){\n            systemsMgr.showSystem(\"addPropertyNumSys\",1)\n        })\n        this.addHeartButtonNode.on(\"click\",function(){\n            systemsMgr.showSystem(\"addPropertyNumSys\",2)\n        })\n\n        var flag = require(\"dataMgr\").playerData.initAdWatchedFlag\n        if (flag == 1) {\n            this.welfarySysButtonNode.active = false\n        }\n        else {\n            cc.tween(this.welfarySysButtonNode)\n                .repeatForever(cc.tween()\n                    .to(0.3,{angle: -45})\n                    .to(0.3,{angle: 0})\n                    .to(0.3,{angle: 45})\n                    .to(0.3,{angle: 0})\n                    .delay(1)\n                )\n                .start()\n            \n            this.welfarySysButtonNode.on(\"click\",function(){\n                systemsMgr.showSystem(\"welfarySys\")\n            })\n        }\n\n        this.selectSectionButtonNode.on(\"click\",function(){\n            systemsMgr.showSystem(\"selectSectionSys\")\n        })\n\n        cc.tween(this.backToCurrentButtonNode)\n            .repeatForever(cc.tween()\n                    .to(1, {opacity: 0})\n                    .to(1, {opacity: 255})\n            )\n            .start()\n        this.backToCurrentButtonNode.getComponent(cc.Label).string = require(\"textConfig\").getTextByIdAndLanguageType(167)\n        var self = this\n        this.backToCurrentButtonNode.on(\"click\",function(){\n            self.selectedSection = require(\"dataMgr\").playerData.currentSection\n            self.setupSectionPerformance()\n            self.playBgm()\n        })\n        this.backToCurrentButtonNode.y = this.sectionNameLabelNode.y - this.sectionNameLabelNode.height / 2 - 100\n        this.setupSectionPerformance()\n    },\n\n    setupData() {\n        this.selectedSection = require(\"dataMgr\").playerData.currentSection\n    },\n\n    setupSectionPerformance() {\n        if (this.selectedSection == null) {\n            cc.log(\"not selected one section, can not setup section of mainScene mgr\")\n            return\n        }\n        if (this.selectedSection == require(\"dataMgr\").playerData.currentSection) {\n            this.backToCurrentButtonNode.active = false\n        }\n        else {\n            this.backToCurrentButtonNode.active = true\n        }\n        var textConfig = require(\"textConfig\")\n        this.levelNodes.destroyAllChildren()\n        this.levelNodes.removeAllChildren()\n        this.connectLineNodes.destroyAllChildren()\n        this.connectLineNodes.removeAllChildren()\n        var sectionConfig = require(\"sectionConfig\")\n        var config = sectionConfig[this.selectedSection]\n        var sectionTitle = textConfig.getTextByIdAndLanguageType(config.sectionTitleTextId)\n        var sectionDes = textConfig.getTextByIdAndLanguageType(config.sectionDescripTextId)\n        var showText = sectionTitle + \" \" + sectionDes\n        this.sectionNameLabelNode.getComponent(cc.Label).string = showText\n        this.sectionNameLabelNode.getComponent(cc.Label)._forceUpdateRenderData()\n        this.selectSectionButtonNode.y = this.sectionNameLabelNode.y\n        this.selectSectionButtonNode.x = this.sectionNameLabelNode.x - this.sectionNameLabelNode.width / 2 - 100\n        var levels = config.levels\n        for (var index in levels) {\n            var oneLevel = levels[index]\n            var oneLevelNode = cc.instantiate(this.levelNodePrefab)\n            var mgr = oneLevelNode.getComponent(\"levelNodeMgr\")\n            mgr.level = oneLevel\n            mgr.levelNumLabelNode.getComponent(cc.Label).string = (parseInt(index) + 1).toString()\n            mgr.status = this._checkLevelStatus(oneLevel)\n            mgr.delegate = this\n            this._setupLevelNodePosition(oneLevelNode,index)\n            this.levelNodes.addChild(oneLevelNode)\n        }\n\n        for (var index in this.levelNodes.children){\n            if (index == 0) {\n                continue\n            }\n            var oneNode = this.levelNodes.children[index]\n            var preNode = this.levelNodes.children[(index - 1)]\n            var connectLine = cc.instantiate(this.levelNodesConnectLinePrefab)\n            var v = cc.v2(preNode.x - oneNode.x, preNode.y - oneNode.y)\n            connectLine.width = v.mag()\n            var degree= v.signAngle(cc.v2(1,0)) / Math.PI * 180\n            connectLine.angle = -degree\n            var result = this._getMidPointOfTwoPoints(oneNode.position, preNode.position)\n            connectLine.x = result.x\n            connectLine.y = result.y\n            this.connectLineNodes.addChild(connectLine)\n        }\n    },\n    _setupLevelNodePosition(givenNode, givenIndex) {\n        var sectionConfig = require(\"sectionConfig\")[this.selectedSection]\n        var levelNodePositions = sectionConfig.levelNodePositions\n        if (levelNodePositions == null || levelNodePositions.length == 0) {\n            //lined\n\n            // var rowIndex = givenIndex % this.levelNodesNumPerLine\n            // var colIndex = Math.floor(givenIndex / this.levelNodesNumPerLine)\n\n            // var maxX = this.levelNodeStartPosition.x + this.levelNodesHorDis * (this.levelNodesNumPerLine - 1)\n            // if (colIndex % 2 == 0) {\n            //     givenNode.x = this.levelNodeStartPosition.x + rowIndex * this.levelNodesHorDis\n            // }\n            // else {\n            //     givenNode.x = maxX - rowIndex * this.levelNodesHorDis\n            // }\n            // givenNode.y = this.levelNodeStartPosition.y + colIndex * this.levelNodesVerDis\n            \n            // var levelNodeStart = this.node.getChildByName(\"sectionNameLabel\").getChildByName(\"levelNodeStart\")\n            // givenNode.x = levelNodeStart.x\n            \n            // givenNode.y = levelNodeStart.y + givenIndex * this.levelNodesVerDis\n\n            //rotated copied\n            var nodesNum = sectionConfig.levels.length\n            var angle = 2 * Math.PI / nodesNum\n            var baseVector = cc.v2(this.rotaedCopiedRadius,0)\n            var v = baseVector.rotate(-givenIndex * angle)\n            givenNode.x = v.x\n            givenNode.y = v.y\n        }\n        else {\n            givenNode.x = levelNodePositions[givenIndex].x\n            givenNode.y = levelNodePositions[givenIndex].y\n        }\n    },\n\n    _getMidPointOfTwoPoints(point1,point2) {\n        var v = cc.v2(point2.x - point1.x, point2.y - point1.y)\n        var x = point1.x + v.x / 2\n        var y = point1.y + v.y / 2\n        return cc.v2(x,y)\n    },\n\n\n    _checkSectionStatus(givenSection) {\n        var currentSection = require(\"dataMgr\").playerData.currentSection\n        if (typeof givenSection !== \"number\") {\n            givenSection = parseInt(givenSection)\n        }\n        if (givenSection > currentSection) {\n            return 0 //locked\n        }\n        else if (givenSection < currentSection) {\n            return 1 //unlocked\n        }\n        else if (givenSection == currentSection) {\n            return 2 //current\n        }\n    },\n\n    _checkLevelStatus(givneLevel) {\n        var sectionKey = this._getSectionKeyByLevel(givneLevel)\n        if (sectionKey == false) {\n            return false //no such level\n        }\n       \n        var sectionStatus = this._checkSectionStatus(sectionKey)\n        switch(sectionStatus) {\n            case 0:\n                return 0 //locked\n            case 1:\n                return 1 //unlocked\n            case 2:\n                var currentLevel = require(\"dataMgr\").playerData.currentLevel\n                if (currentLevel == givneLevel) {\n                    return 2 //current\n                }\n\n                var sectionConfig = require(\"sectionConfig\")[sectionKey]\n                var levelsArry = sectionConfig.levels\n                if (levelsArry.indexOf(givneLevel) > levelsArry.indexOf(currentLevel)) {\n                    return 0 //locked\n                }\n                return 1 //unlocked\n        }\n    },\n    _getSectionKeyByLevel(givenLevel) {\n        var levelId = parseInt(givenLevel)\n        var sectionConfig = require(\"sectionConfig\")\n        for (var key in sectionConfig) {\n            var oneConfig = sectionConfig[key]\n            var levelsConfig = oneConfig.levels\n            if (levelsConfig.indexOf(levelId) != -1) {\n                return key\n            }\n        }\n\n        return false\n    },\n\n\n    dataMonitored(key,value) {\n        if (key == \"physicalPower\") {\n            this.physicalLabelNode.getComponent(cc.Label).string = value.toString()\n        }\n        else if (key == \"heart\") {\n            this.heartLabelNode.getComponent(cc.Label).string = value.toString()\n        }\n        for(var index in this.levelNodes.children) {\n            var oneMgr = this.levelNodes.children[index].getComponent(\"levelNodeMgr\")\n            oneMgr.dataMonitored(key,value)\n        }\n    },\n\n    update (dt) {\n        var notificationMgr = require(\"notificationMgr\")\n        var notiArry = notificationMgr.noties\n        if (notiArry.length > 0 && this.isShowingNoti == false && this.canShowNoti == true) {\n            this.isShowingNoti = true\n            var self = this\n            var temp = function() {\n                if (notiArry.length == 0) {\n                    self.isShowingNoti = false\n                    return\n                }\n\n                var oneStr = notiArry[0]\n                notificationMgr.showNoti(oneStr)\n                notiArry.splice(0,1)\n                cc.tween(self.node)\n                    .delay(0.3)\n                    .call(function(){\n                        temp()\n                    })\n                    .start()\n            }\n\n            temp()\n        }\n    },\n});\n"]}