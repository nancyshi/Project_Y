{"version":3,"sources":["assets/scripts/libs/timerSystemsMgr.js"],"names":["TimerSystemsMgr","cc","Class","Component","properties","signInSysTimer","get","_signInSysTimer","set","value","onTimerReach","timers","start","initSetup","push","require","playerData","signInRefreshDelta","lunch","schedule","timerUpdate","index","oneTimer","stop","unschedule","givenName","self","networkMgr","msgObj","makeMessageObj","message","playerId","id","successCallBack","xhr","response","responseText","JSON","parse","type","signInStatus","signInSys","opendNode","signInSysMgr","getComponent","setupUI","sendMessageByMsgObj","sharedTimerSystemsMgr","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nvar TimerSystemsMgr = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        signInSysTimer: {\n            get() {\n                return this._signInSysTimer\n            },\n            set(value) {\n                this._signInSysTimer = value\n                if (value <= 0) {\n                    this.onTimerReach(\"signInSys\")\n                }\n            }\n        },\n\n        timers: []\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n\n    },\n    initSetup(){\n        this.timers.push(this.signInSysTimer)\n        this.signInSysTimer = require(\"dataMgr\").playerData.signInRefreshDelta\n    },\n    lunch(){\n        this.schedule(this.timerUpdate, 1)\n    },\n\n    timerUpdate() {\n        for (var index in this.timers) {\n            var oneTimer = this.timers[index]\n            if (oneTimer > 0) {\n                oneTimer -= 1\n            }\n        }\n    },\n\n    stop(){\n        this.unschedule(this.timerUpdate,this)\n    },\n\n\n    onTimerReach(givenName) {\n        switch(givenName){\n            case \"signInSys\":\n                var self = this\n                var networkMgr = require(\"networkMgr\")\n                var msgObj = networkMgr.makeMessageObj(\"signInModule\",\"refreshMessageType\")\n                msgObj.message.playerId = require(\"dataMgr\").playerData.id\n                msgObj.successCallBack = function(xhr) {\n                    var response = xhr.responseText\n                    response = JSON.parse(response)\n                    if (response.type == \"success\") {\n                        var signInRefreshDelta = response.signInRefreshDelta\n                        require(\"dataMgr\").playerData.signInRefreshDelta = signInRefreshDelta\n                        self.signInSysTimer = signInRefreshDelta\n                        require(\"dataMgr\").playerData.signInStatus = 1\n                        if (require(\"systemsMgr\").signInSys.opendNode != null) {\n                            var signInSysMgr = require(\"systemsMgr\").signInSys.opendNode.getComponent(\"signInSysMgr\")\n                            signInSysMgr.setupUI()\n                        }\n                    }\n                }\n\n                networkMgr.sendMessageByMsgObj(msgObj)\n                break\n        }\n    }\n    \n});\n\nvar sharedTimerSystemsMgr = new TimerSystemsMgr()\nmodule.exports = sharedTimerSystemsMgr"]}