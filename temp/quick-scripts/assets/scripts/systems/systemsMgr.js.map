{"version":3,"sources":["systemsMgr.js"],"names":["SystemsMgr","cc","Class","extends","Component","properties","welfarySys","get","_welfarySys","setupSysProperty","systems","signInSys","_signInSys","addPropertyNumSys","_addPropertyNumSys","mailSys","_mailSys","selectSectionSys","_selectSectionSys","storySys","_storySys","_systems","givenPrefabName","givenName","givenMgrName","givenSysProperty","uiPrefab","require","reses","opendNode","name","mgrName","showSystem","givenSysName","para","type","givenSys","getSysBySysName","log","ui","instantiate","mgr","getComponent","onWillOpend","director","getScene","getChildByName","addChild","others","bg","width","winSize","height","on","scale","tween","to","start","closeSystem","call","destroy","coverNode","opacity","delay","systemsGloableDataMonitored","key","value","mailSysGloableMonitored","textConfig","onReachCondition","givenTag","givenMailId","networkMgr","messageObj","makeMessageObj","message","playerId","playerData","id","tag","mailId","successCallBack","xhr","response","responseText","JSON","parse","isEnd","mailConditionIndex","newMail","mail","mails","notificaitionMgr","notiStr","getTextByIdAndLanguageType","pushNoti","sendMessageByMsgObj","mailSysConfig","tags","Object","keys","index","oneTag","conditionIndex","element","conditions","conditionType","conditionPara","indexOf","levelId","slice","parseInt","minStepNum","mailSysGloableSendOneMail","complete","systemsMgr","module","exports"],"mappings":"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","file":"systemsMgr.js","sourceRoot":"../../../../../assets/scripts/systems","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\n\n//a typical system will have an ui , which will be created by a prefab\n//other system will not be contained by here, such as notificaition system\nvar SystemsMgr = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        welfarySys: {\n            get() {\n                if (this._welfarySys == null) {\n                    this._welfarySys = this.setupSysProperty(\"welfarySysPrefab\",\"welfarySys\",\"welfarySysMgr\")\n                    this.systems[\"welfarySys\"] = this._welfarySys\n                }\n                return this._welfarySys\n            }\n        },\n        signInSys: {\n            get() {\n                if (this._signInSys == null) {\n                    this._signInSys = this.setupSysProperty(\"signInSysPrefab\", \"signInSys\",\"signInSysMgr\")\n                    this.systems[\"signInSys\"] = this._signInSys\n                }\n                return this._signInSys\n            }\n        },\n\n        addPropertyNumSys: {\n            get() {\n                if (this._addPropertyNumSys == null) {\n                    this._addPropertyNumSys = this.setupSysProperty(\"addPropertyNumSysPrefab\",\"addPropertyNumSys\",\"addPropertyNumSysMgr\")\n                    this.systems[\"addPropertyNumSys\"] = this._addPropertyNumSys\n                }\n                return this._addPropertyNumSys\n            }\n        },\n\n        mailSys: {\n            get() {\n                if (this._mailSys == null) {\n                    this._mailSys = this.setupSysProperty(\"mailSysPrefab\",\"mailSys\",\"mailSysMgr\")\n                    this.systems[\"mailSys\"] = this._mailSys\n                }\n                return this._mailSys\n            }\n        },\n        \n        selectSectionSys: {\n            get() {\n                if (this._selectSectionSys == null) {\n                    this._selectSectionSys = this.setupSysProperty(\"selectSectionSysPrefab\",\"selectSectionSys\",\"selectSectionUIMgr\")\n                    this.systems[\"selectSectionSys\"] = this._selectSectionSys\n                }\n                return this._selectSectionSys\n            }\n        },\n        storySys: {\n            get() {\n                if (this._storySys == null) {\n                    this._storySys = this.setupSysProperty(\"storySysPrefab\",\"storySys\",\"storySysMgr\")\n                    this.systems[\"storySys\"] = this._storySys\n                }\n                return this._storySys\n            }\n        },\n\n        systems: {\n            get() {\n                if (this._systems == null) {\n                    this._systems = {}\n                }\n                return this._systems\n            }\n        }\n    },\n\n    setupSysProperty(givenPrefabName, givenName, givenMgrName) {\n        var givenSysProperty = {}\n        givenSysProperty.uiPrefab = require(\"resMgr\").reses[givenPrefabName]\n        givenSysProperty.opendNode = null\n        givenSysProperty.name = givenName\n        givenSysProperty.mgrName = givenMgrName\n        return givenSysProperty\n    },\n\n    showSystem(givenSysName, para = null, type = 1) {\n        //type 1 = animated open , 2 = direct open\n        var givenSys = this.getSysBySysName(givenSysName)\n        if (givenSys.opendNode != null) {\n            cc.log(\"this sys has been opend , can't reopen: \" + givenSys.name)\n            return\n        }\n        var ui = cc.instantiate(givenSys.uiPrefab)\n        var mgrName = this.systems[givenSys.name].mgrName\n        var mgr = ui.getComponent(mgrName)\n        if (mgr != null && typeof mgr.onWillOpend === \"function\") {\n            mgr.onWillOpend(para)\n        }\n        if (type == 2) {\n            cc.director.getScene().getChildByName(\"Canvas\").addChild(ui)\n            givenSys.opendNode = ui\n            return\n        }\n        var others = ui.getChildByName(\"others\")\n        var bg = ui.getChildByName(\"bg\")\n        if (bg != null) {\n            bg.width = cc.winSize.width\n            bg.height = cc.winSize.height\n            bg.on(\"touchstart\",function(){})\n        }\n        cc.director.getScene().getChildByName(\"Canvas\").addChild(ui)\n        givenSys.opendNode = ui\n        if (others != null) {\n            others.scale = 0\n            cc.tween(others)\n                .to(0.3,{scale: 1})\n                .start()\n        }\n        else {\n            ui.scale = 0\n            cc.tween(ui)\n                .to(0.3,{scale: 1})\n                .start()\n        }\n    },\n\n    closeSystem(givenSysName, type = 1) {\n        //1 = animated close , 2 = direct close, 3 = fade out\n        var givenSys = this.getSysBySysName(givenSysName)\n        var opendNode = givenSys.opendNode\n        if (opendNode == null) {\n            cc.log(givenSys.name + \"has not been opend, no need to colse\")\n            return\n        }\n        if (type == 1) {\n            var others = opendNode.getChildByName(\"others\")\n            if (others != null) {\n                cc.tween(others)\n                    .to(0.3, {scale: 0})\n                    .call(function(){\n                        opendNode.destroy()\n                        givenSys.opendNode = null\n                    })\n                    .start()\n            }\n            else {\n                cc.tween(opendNode)\n                    .to(0.3, {scale: 0})\n                    .call(function(){\n                        opendNode.destroy()\n                        givenSys.opendNode = null\n                    })\n            }\n        }\n\n        else if (type == 2) {\n            opendNode.destroy()\n            givenSys.opendNode = null\n        }\n\n        else if (type == 3) {\n            var coverNode = require(\"resMgr\").reses[\"coverNodePrefab\"]\n            coverNode = cc.instantiate(coverNode)\n            coverNode.width = opendNode.width\n            coverNode.height = opendNode.height\n            coverNode.opacity = 0\n            coverNode.on(\"touchstart\",function(){})\n\n            opendNode.addChild(coverNode)\n            cc.tween(coverNode)\n                .to(0.5,{opacity: 255})\n                .delay(0.5)\n                .call(function(){\n                    opendNode.destroy()\n                    givenSys.opendNode = null\n                })\n                .start()\n        }\n        \n    },\n\n    getSysBySysName(givenSysName) {\n        switch(givenSysName){\n            case \"welfarySys\" :\n                return this.welfarySys\n            case \"signInSys\":\n                return this.signInSys\n            case \"addPropertyNumSys\":\n                return this.addPropertyNumSys\n            case \"mailSys\":\n                return this.mailSys\n            case \"selectSectionSys\":\n                return this.selectSectionSys\n            case \"storySys\":\n                return this.storySys\n            default:\n                cc.log(\"no such sys\")\n                return false\n        }\n    },\n\n    systemsGloableDataMonitored(key,value) {\n        //mailSys\n            //monitored whether reach mail condition\n        this.mailSysGloableMonitored(key,value)\n    },\n\n\n    mailSysGloableMonitored(key,value) {\n        var textConfig = require(\"textConfig\")\n        var onReachCondition = function(givenTag,givenMailId) {\n            var networkMgr = require(\"networkMgr\")\n            var messageObj = networkMgr.makeMessageObj(\"mailModule\",\"reachConditionMessageType\")\n            messageObj.message.playerId = require(\"dataMgr\").playerData.id\n            messageObj.message.tag = givenTag\n            messageObj.message.mailId = givenMailId\n            messageObj.successCallBack = function(xhr) {\n                var response = xhr.responseText\n                response = JSON.parse(response)\n                if (response.type == \"success\") {\n                    var isEnd = response.isEnd\n                    if (isEnd == 0) {\n                        require(\"dataMgr\").playerData.mailConditionIndex[givenTag] += 1\n                    }\n                    else {\n                        require(\"dataMgr\").playerData.mailConditionIndex[givenTag] = -1\n                    }\n                    var newMail = response.mail\n                    require(\"dataMgr\").playerData.mails[givenMailId] = newMail\n                    var notificaitionMgr = require(\"notificationMgr\")\n                    var notiStr = textConfig.getTextByIdAndLanguageType(148)\n                    notificaitionMgr.pushNoti(notiStr)\n                }\n            }\n            networkMgr.sendMessageByMsgObj(messageObj)\n        }\n        var mailSysConfig = require(\"mailSysConfig\")\n        var tags = Object.keys(mailSysConfig)\n        for (var index in tags) {\n            var oneTag = tags[index]\n            var conditionIndex = require(\"dataMgr\").playerData.mailConditionIndex[oneTag]\n            if (conditionIndex == -1) {\n                continue\n            }\n            var element = mailSysConfig[oneTag].conditions[conditionIndex]\n            var conditionType = element.conditionType\n            var conditionPara = element.conditionPara\n\n            if (conditionType == 1) {\n                //reach given level id\n                if (key != \"preLevel\") {\n                    continue\n                }\n                \n                if (value == conditionPara) {\n                    var mailId = element.mailId\n                    onReachCondition(oneTag,mailId)\n                }\n                \n            }\n            else if (conditionType == 2) {\n                //min step num of given level less than a value\n                if (key.indexOf(\"minStep_level_\") == -1) {\n                    continue\n                }\n\n                var levelId = key.slice(14)\n                if (parseInt(levelId) == conditionPara.levelId){\n                    if (value <= conditionPara.minStepNum) {\n                        var mailId = element.mailId\n                        onReachCondition(oneTag,mailId)\n                    }\n                }\n            }\n        }\n    },\n\n    mailSysGloableSendOneMail(givenMailId,givenTag,complete = function(){},delay = 0) {\n        var networkMgr = require(\"networkMgr\")\n        var messageObj = networkMgr.makeMessageObj(\"mailModule\",\"sendMailMessageType\")\n        messageObj.message.playerId = require(\"dataMgr\").playerData.id\n        messageObj.message.mailId = givenMailId\n        messageObj.message.tag = givenTag\n        messageObj.message.delay = delay\n        messageObj.successCallBack = function(xhr) {\n            var response = xhr.responseText\n            response = JSON.parse(response)\n            if (response.type == \"success\") {\n                complete()\n            }\n        }\n        networkMgr.sendMessageByMsgObj(messageObj)\n    },\n\n    // getSectionLevelInfoByLevelId(givenLevelId) {\n    //     var result = null\n    //     var sectionConfig = require(\"sectionConfig\")\n    //     for (var key in sectionConfig) {\n    //         var oneConfig = sectionConfig[key]\n    //         var levels = oneConfig.levels\n    //         for (var index in levels) {\n    //             if (givenLevelId == levels[index]) {\n    //                 var currentLevel = givenLevelId\n                    \n    //             }\n    //         }\n    //     }\n    //     return result\n    // }\n    // update (dt) {},\n});\n\nvar systemsMgr = new SystemsMgr()\nmodule.exports = systemsMgr"]}