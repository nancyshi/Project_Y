{"version":3,"sources":["addPropertyNumSysMgr.js"],"names":["cc","Class","extends","Component","properties","ensureButtonNode","Node","cancelButtonNode","desLabelNode","addTypeId","addConfig","sysName","start","setupData","setupUI","config","require","desStr","isFirstKey","key","toString","getComponent","Label","string","onWillOpend","givenAddTypeId","onClickEnsureButton","advertisMgr","delegate","showVideoAd","onClickCancelButton","closeSystem","onVideoAdEnd","commitBody","oneAddedPropertyNum","playerData","Object","keys","length","successCallBack","k","commitPlayerDataToServer"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,0BAAkBL,GAAGM,IAhBb;AAiBRC,0BAAkBP,GAAGM,IAjBb;AAkBRE,sBAAcR,GAAGM,IAlBT;AAmBRG,mBAAW,CAnBH;AAoBRC,mBAAW,IApBH;AAqBRC,iBAAS;AArBD,KAHP;;AA2BL;;AAEA;;AAEAC,SA/BK,mBA+BI;AACL,aAAKC,SAAL;AACA,aAAKC,OAAL;AACH,KAlCI;AAoCLD,aApCK,uBAoCO;AACR,YAAIE,SAASC,QAAQ,sBAAR,CAAb;AACAD,iBAASA,OAAO,KAAKN,SAAZ,CAAT;AACA,aAAKC,SAAL,GAAiBK,MAAjB;AACH,KAxCI;AA0CLD,WA1CK,qBA0CK;AACN,YAAIG,SAAS,cAAb;AACA,YAAIC,aAAa,IAAjB;AACA,aAAK,IAAIC,GAAT,IAAgB,KAAKT,SAArB,EAAgC;AAC5B,gBAAIQ,cAAc,KAAlB,EAAyB;AACrBD,0BAAU,GAAV;AACH;AACD,oBAAQE,GAAR;AACI,qBAAK,eAAL;AACIF,8BAAU,WAAW,KAAKP,SAAL,CAAeS,GAAf,EAAoBC,QAApB,EAArB;AACA;AACJ,qBAAK,OAAL;AACIH,8BAAU,WAAW,KAAKP,SAAL,CAAeS,GAAf,EAAoBC,QAApB,EAArB;AACA;AANR;AAQAF,yBAAa,KAAb;AACH;AACDD,kBAAU,QAAV;AACA,aAAKT,YAAL,CAAkBa,YAAlB,CAA+BrB,GAAGsB,KAAlC,EAAyCC,MAAzC,GAAkDN,MAAlD;AACH,KA7DI;AA+DLO,eA/DK,uBA+DOC,cA/DP,EA+DuB;AACxB,aAAKhB,SAAL,GAAiBgB,cAAjB;AACH,KAjEI;AAmELC,uBAnEK,iCAmEgB;AACjB,YAAIC,cAAcX,QAAQ,aAAR,CAAlB;AACAW,oBAAYC,QAAZ,GAAuB,IAAvB;AACAD,oBAAYE,WAAZ;AACH,KAvEI;AAyELC,uBAzEK,iCAyEiB;AAClBd,gBAAQ,YAAR,EAAsBe,WAAtB,CAAkC,KAAKpB,OAAvC;AACH,KA3EI;;;AA8EL;AACAqB,gBA/EK,0BA+EU;AACX,YAAIC,aAAa,EAAjB;AACA,aAAK,IAAId,GAAT,IAAgB,KAAKJ,MAArB,EAA6B;AACzB,gBAAImB,sBAAsBlB,QAAQ,SAAR,EAAmBmB,UAAnB,CAA8BhB,GAA9B,IAAqC,KAAKJ,MAAL,CAAYI,GAAZ,CAA/D;AACAc,uBAAWd,GAAX,IAAkBe,mBAAlB;AACH;;AAED,YAAIE,OAAOC,IAAP,CAAYJ,UAAZ,EAAwBK,MAAxB,GAAiC,CAArC,EAAwC;AACpC,gBAAIC,kBAAkB,SAAlBA,eAAkB,GAAW;AAC7B,qBAAK,IAAIC,CAAT,IAAcP,UAAd,EAA0B;AACtBjB,4BAAQ,SAAR,EAAmBmB,UAAnB,CAA8BK,CAA9B,IAAmCP,WAAWO,CAAX,CAAnC;AACH;AACJ,aAJD;;AAMAxB,oBAAQ,SAAR,EAAmByB,wBAAnB,CAA4CR,UAA5C,EAAuDM,eAAvD;AACH;AACJ;AACD;;AAhGK,CAAT","file":"addPropertyNumSysMgr.js","sourceRoot":"../../../../../../assets/scripts/systems/addPropertyNumSys","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n        ensureButtonNode: cc.Node,\n        cancelButtonNode: cc.Node,\n        desLabelNode: cc.Node,\n        addTypeId: 1 ,\n        addConfig: null,\n        sysName: \"addPropertyNumSys\"\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        this.setupData()\n        this.setupUI()\n    },\n\n    setupData() {\n        var config = require(\"addPropertySysConfig\")\n        config = config[this.addTypeId]\n        this.addConfig = config\n    },\n\n    setupUI() {\n        var desStr = \"您可以观看视频广告，获得\"\n        var isFirstKey = true\n        for (var key in this.addConfig) {\n            if (isFirstKey == false) {\n                desStr += \"，\"\n            }\n            switch (key) {\n                case \"physicalPower\":\n                    desStr += \" 体力 * \" + this.addConfig[key].toString()\n                    break\n                case \"heart\":\n                    desStr += \" 金币 * \" + this.addConfig[key].toString()\n                    break\n            }\n            isFirstKey = false\n        }\n        desStr += \"，是否观看？\"\n        this.desLabelNode.getComponent(cc.Label).string = desStr\n    },\n\n    onWillOpend(givenAddTypeId) {\n        this.addTypeId = givenAddTypeId\n    },\n\n    onClickEnsureButton(){\n        var advertisMgr = require(\"advertisMgr\")\n        advertisMgr.delegate = this\n        advertisMgr.showVideoAd()\n    },\n\n    onClickCancelButton() {\n        require(\"systemsMgr\").closeSystem(this.sysName)\n    },\n\n\n    //advertis delegate\n    onVideoAdEnd() {\n        var commitBody = {}\n        for (var key in this.config) {\n            var oneAddedPropertyNum = require(\"dataMgr\").playerData[key] + this.config[key]\n            commitBody[key] = oneAddedPropertyNum\n        }\n\n        if (Object.keys(commitBody).length > 0) {\n            var successCallBack = function() {\n                for (var k in commitBody) {\n                    require(\"dataMgr\").playerData[k] = commitBody[k]\n                }\n            }\n\n            require(\"dataMgr\").commitPlayerDataToServer(commitBody,successCallBack)\n        }\n    }\n    // update (dt) {},\n});\n"]}